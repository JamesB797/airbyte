../../../../connectors/source-zendesk-support/acceptance-test-config.yml
/Users/ella/airbytehq/airbyte/airbyte-integrations/connectors/source-zendesk-support
============================= test session starts ==============================
platform linux -- Python 3.9.11, pytest-6.2.5, py-1.11.0, pluggy-1.0.0
rootdir: /test_input
plugins: timeout-1.4.2, hypothesis-6.54.6, requests-mock-1.9.3, cov-3.0.0, sugar-0.9.6, mock-3.6.1
collected 47 items / 45 deselected / 2 selected

../../test_input/test_core.py F                                          [ 50%]
../../test_input/test_incremental.py .                                   [100%]


=================================== FAILURES ===================================
_______________________ TestBasicRead.test_read[inputs0] _______________________

self = <connector_acceptance_test.tests.test_core.TestBasicRead object at 0xffffb5738250>
connector_config = SecretDict(******)
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='group_memberships', json_schema={...h'>, cursor_field=['updated_at'], destination_sync_mode=<DestinationSyncMode.append: 'append'>, primary_key=[['id']])])
expect_records_config = ExpectedRecordsConfig(bypass_reason=None, path=PosixPath('integration_tests/expected_records.jsonl'), extra_fields=False, exact_order=False, extra_records=True)
should_validate_schema = True, should_validate_data_points = False
should_fail_on_extra_columns = True, empty_streams = set(), ignored_fields = {}
expected_records_by_stream = defaultdict(<class 'list'>, {'group_memberships': [{'url': 'https://d3v-airbyte.zendesk.com/api/v2/group_memberships/3..._skills': False, 'manage_slas': False, 'manage_triggers': False, 'ticket_redaction': False}, 'team_member_count': 1}]})
docker_runner = <connector_acceptance_test.utils.connector_runner.ConnectorRunner object at 0xffffb4f18a30>
detailed_logger = <Logger detailed_logger /test_input/acceptance_tests_logs/test_core.py__TestBasicRead__test_read[inputs0].txt (DEBUG)>

    def test_read(
        self,
        connector_config,
        configured_catalog,
        expect_records_config: ExpectedRecordsConfig,
        should_validate_schema: Boolean,
        should_validate_data_points: Boolean,
        should_fail_on_extra_columns: Boolean,
        empty_streams: Set[EmptyStreamConfiguration],
        ignored_fields: Optional[Mapping[str, List[IgnoredFieldsConfiguration]]],
        expected_records_by_stream: MutableMapping[str, List[MutableMapping]],
        docker_runner: ConnectorRunner,
        detailed_logger,
    ):
        output = docker_runner.call_read(connector_config, configured_catalog)
        records = [message.record for message in filter_output(output, Type.RECORD)]
    
        assert records, "At least one record should be read using provided catalog"
    
        if should_validate_schema:  # TODO Conditional logic
>           self._validate_schema(
                records=records, configured_catalog=configured_catalog, fail_on_extra_columns=should_fail_on_extra_columns
            )

connector_acceptance_test/tests/test_core.py:823: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

records = [AirbyteRecordMessage(namespace=None, stream='group_memberships', data={'url': 'https://d3v-airbyte.zendesk.com/api/v2...t': False, 'created_at': '2022-06-29T12:29:26Z', 'updated_at': '2022-06-29T12:29:26Z'}, emitted_at=1679429269048), ...]
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='group_memberships', json_schema={...h'>, cursor_field=['updated_at'], destination_sync_mode=<DestinationSyncMode.append: 'append'>, primary_key=[['id']])])
fail_on_extra_columns = True

    @staticmethod
    def _validate_schema(records: List[AirbyteRecordMessage], configured_catalog: ConfiguredAirbyteCatalog, fail_on_extra_columns: Boolean):
        """
        Check if data type and structure in records matches the one in json_schema of the stream in catalog
        """
        TestBasicRead._validate_records_structure(records, configured_catalog)
        bar = "-" * 80
        streams_errors = verify_records_schema(records, configured_catalog, fail_on_extra_columns)
        for stream_name, errors in streams_errors.items():
            errors = map(str, errors.values())
            str_errors = f"\n{bar}\n".join(errors)
            logging.error(f"\nThe {stream_name} stream has the following schema errors:\n{str_errors}")
    
        if streams_errors:
>           pytest.fail(f"Please check your json_schema in selected streams {tuple(streams_errors.keys())}.")
E           Failed: Please check your json_schema in selected streams ('groups', 'macros', 'ticket_comments', 'ticket_fields', 'tickets', 'users', 'ticket_forms').

connector_acceptance_test/tests/test_core.py:665: Failed
----------------------------- Captured stdout call -----------------------------
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe groups stream has the following schema errors:\nAdditional properties are not allowed ('default', 'description', 'is_public' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'deleted': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'name': {'type': ['null', 'string']},\n                    'updated_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'url': {'type': ['null', 'string']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'created_at': '2020-12-11T18:34:05Z',\n     'default': False,\n     'deleted': False,\n     'description': '',\n     'id': 360003074836,\n     'is_public': True,\n     'name': 'Support',\n     'updated_at': '2021-07-28T17:22:42Z',\n     'url': 'https://d3v-airbyte.zendesk.com/api/v2/groups/360003074836.json'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe macros stream has the following schema errors:\nAdditional properties are not allowed ('default', 'raw_title' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'actions': {'items': {'properties': {'field': {'type': ['null',\n                                                                            'string']},\n                                                         'value': {'type': ['null',\n                                                                            'string']}},\n                                          'type': ['null', 'object']},\n                                'type': ['null', 'array']},\n                    'active': {'type': ['null', 'boolean']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'description': {'type': ['null', 'string']},\n                    'id': {'type': ['null', 'integer']},\n                    'position': {'type': ['null', 'integer']},\n                    'restriction': {'properties': {'id': {'type': ['null',\n                                                                   'integer']},\n                                                   'ids': {'items': {'type': ['null',\n                                                                              'integer']},\n                                                           'type': ['null',\n                                                                    'array']},\n                                                   'type': {'type': ['null',\n                                                                     'string']}},\n                                    'type': ['null', 'object']},\n                    'title': {'type': ['null', 'string']},\n                    'updated_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'url': {'type': ['null', 'string']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'actions': [{'field': 'priority', 'value': 'low'},\n                 {'field': 'comment_value',\n                  'value': \"We're currently experiencing unusually high \"\n                           \"traffic. We'll get back to you as soon as \"\n                           'possible.'}],\n     'active': True,\n     'created_at': '2020-12-11T18:34:06Z',\n     'default': False,\n     'description': None,\n     'id': 360011363536,\n     'position': 9999,\n     'raw_title': 'Downgrade and inform',\n     'restriction': None,\n     'title': 'Downgrade and inform',\n     'updated_at': '2020-12-11T18:34:06Z',\n     'url': 'https://d3v-airbyte.zendesk.com/api/v2/macros/360011363536.json'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe ticket_comments stream has the following schema errors:\nAdditional properties are not allowed ('event_type' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'attachments': {'items': {'properties': {'content_type': {'type': ['null',\n                                                                                       'string']},\n                                                             'content_url': {'type': ['null',\n                                                                                      'string']},\n                                                             'file_name': {'type': ['null',\n                                                                                    'string']},\n                                                             'height': {'type': ['null',\n                                                                                 'integer']},\n                                                             'id': {'type': ['null',\n                                                                             'integer']},\n                                                             'inline': {'type': ['null',\n                                                                                 'boolean']},\n                                                             'mapped_content_url': {'type': ['null',\n                                                                                             'string']},\n                                                             'size': {'type': ['null',\n                                                                               'integer']},\n                                                             'thumbnails': {'items': {'properties': {'content_type': {'type': ['null',\n                                                                                                                               'string']},\n                                                                                                     'content_url': {'type': ['null',\n                                                                                                                              'string']},\n                                                                                                     'file_name': {'type': ['null',\n                                                                                                                            'string']},\n                                                                                                     'height': {'type': ['null',\n                                                                                                                         'integer']},\n                                                                                                     'id': {'type': ['null',\n                                                                                                                     'integer']},\n                                                                                                     'inline': {'type': ['null',\n                                                                                                                         'boolean']},\n                                                                                                     'mapped_content_url': {'type': ['null',\n                                                                                                                                     'string']},\n                                                                                                     'size': {'type': ['null',\n                                                                                                                       'integer']},\n                                                                                                     'url': {'type': ['null',\n                                                                                                                      'string']},\n                                                                                                     'width': {'type': ['null',\n                                                                                                                        'integer']}},\n                                                                                      'type': ['null',\n                                                                                               'object']},\n                                                                            'type': ['null',\n                                                                                     'array']},\n                                                             'url': {'type': ['null',\n                                                                              'string']},\n                                                             'width': {'type': ['null',\n                                                                                'integer']}},\n                                              'type': ['null', 'object']},\n                                    'type': ['null', 'array']},\n                    'audit_id': {'type': ['null', 'integer']},\n                    'author_id': {'type': ['null', 'integer']},\n                    'body': {'type': ['null', 'string']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'html_body': {'type': ['null', 'string']},\n                    'id': {'type': ['null', 'integer']},\n                    'metadata': {'properties': {'custom': {'additionalProperties': True,\n                                                           'properties': {},\n                                                           'type': ['null',\n                                                                    'object']},\n                                                'flags': {'items': {'type': ['null',\n                                                                             'integer']},\n                                                          'type': ['null',\n                                                                   'array']},\n                                                'flags_options': {'properties': {'11': {'properties': {'message': {'properties': {'user': {'type': ['null',\n                                                                                                                                                    'string']}},\n                                                                                                                   'type': ['null',\n                                                                                                                            'object']},\n                                                                                                       'trusted': {'type': ['null',\n                                                                                                                            'boolean']}},\n                                                                                        'type': ['null',\n                                                                                                 'object']},\n                                                                                 '2': {'properties': {'trusted': {'type': ['null',\n                                                                                                                           'boolean']}},\n                                                                                       'type': ['null',\n                                                                                                'object']}},\n                                                                  'type': ['null',\n                                                                           'object']},\n                                                'notifications_suppressed_for': {'items': {'type': ['null',\n                                                                                                    'integer']},\n                                                                                 'type': ['null',\n                                                                                          'array']},\n                                                'system': {'properties': {'client': {'type': ['null',\n                                                                                              'string']},\n                                                                          'ip_address': {'type': ['null',\n                                                                                                  'string']},\n                                                                          'json_email_identifier': {'type': ['null',\n                                                                                                             'string']},\n                                                                          'latitude': {'type': ['null',\n                                                                                                'number']},\n                                                                          'location': {'type': ['null',\n                                                                                                'string']},\n                                                                          'longitude': {'type': ['null',\n                                                                                                 'number']},\n                                                                          'message_id': {'type': ['null',\n                                                                                                  'string']},\n                                                                          'raw_email_identifier': {'type': ['null',\n                                                                                                            'string']}},\n                                                           'type': ['null',\n                                                                    'object']},\n                                                'trusted': {'type': ['null',\n                                                                     'boolean']}},\n                                 'type': ['null', 'object']},\n                    'plain_body': {'type': ['null', 'string']},\n                    'public': {'type': ['null', 'boolean']},\n                    'ticket_id': {'type': ['null', 'integer']},\n                    'timestamp': {'type': ['null', 'integer']},\n                    'type': {'type': ['null', 'string']},\n                    'via': {'properties': {'channel': {'type': ['null',\n                                                                'string']},\n                                           'source': {'properties': {'from': {'properties': {'address': {'type': ['null',\n                                                                                                                  'string']},\n                                                                                             'deleted': {'type': ['null',\n                                                                                                                  'boolean']},\n                                                                                             'id': {'type': ['null',\n                                                                                                             'integer']},\n                                                                                             'name': {'type': ['null',\n                                                                                                               'string']},\n                                                                                             'original_recipients': {'items': {'type': ['null',\n                                                                                                                                        'string']},\n                                                                                                                     'type': ['null',\n                                                                                                                              'array']},\n                                                                                             'subject': {'type': ['null',\n                                                                                                                  'string']},\n                                                                                             'ticket_id': {'type': ['null',\n                                                                                                                    'integer']},\n                                                                                             'ticket_ids': {'items': {'type': ['null',\n                                                                                                                               'integer']},\n                                                                                                            'type': ['null',\n                                                                                                                     'array']},\n                                                                                             'title': {'type': ['null',\n                                                                                                                'string']}},\n                                                                              'type': ['null',\n                                                                                       'object']},\n                                                                     'rel': {'type': ['null',\n                                                                                      'string']},\n                                                                     'to': {'properties': {'address': {'type': ['null',\n                                                                                                                'string']},\n                                                                                           'name': {'type': ['null',\n                                                                                                             'string']}},\n                                                                            'type': ['null',\n                                                                                     'object']}},\n                                                      'type': ['null',\n                                                               'object']}},\n                            'type': ['null', 'object']},\n                    'via_reference_id': {'type': ['null', 'integer']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'attachments': [],\n     'audit_id': 5168539817231,\n     'author_id': 360786799676,\n     'body': 'test to',\n     'created_at': '2022-07-19T09:41:20Z',\n     'event_type': 'Comment',\n     'html_body': '<div class=\"zd-comment\" dir=\"auto\">test to<br></div>',\n     'id': 5168539817359,\n     'plain_body': 'test to',\n     'public': True,\n     'ticket_id': 141,\n     'timestamp': 1658223680,\n     'type': 'Comment',\n     'via': {'channel': 'api',\n             'source': {'from': {},\n                        'rel': None,\n                        'to': {'address': 'integration-test@airbyte.io',\n                               'name': 'Team Airbyte'}}},\n     'via_reference_id': None}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe ticket_fields stream has the following schema errors:\nAdditional properties are not allowed ('key', 'custom_statuses' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'active': {'type': ['null', 'boolean']},\n                    'agent_description': {'type': ['null', 'string']},\n                    'collapsed_for_agents': {'type': ['null', 'boolean']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'custom_field_options': {'items': {'properties': {'default': {'type': ['null',\n                                                                                           'boolean']},\n                                                                      'id': {'type': ['null',\n                                                                                      'integer']},\n                                                                      'name': {'type': ['null',\n                                                                                        'string']},\n                                                                      'raw_name': {'type': ['null',\n                                                                                            'string']},\n                                                                      'value': {'type': ['null',\n                                                                                         'string']}},\n                                                       'type': ['null',\n                                                                'object']},\n                                             'type': ['null', 'array']},\n                    'description': {'type': ['null', 'string']},\n                    'editable_in_portal': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'position': {'type': ['null', 'integer']},\n                    'raw_description': {'type': ['null', 'string']},\n                    'raw_title': {'type': ['null', 'string']},\n                    'raw_title_in_portal': {'type': ['null', 'string']},\n                    'regexp_for_validation': {'type': ['null', 'string']},\n                    'removable': {'type': ['null', 'boolean']},\n                    'required': {'type': ['null', 'boolean']},\n                    'required_in_portal': {'type': ['null', 'boolean']},\n                    'sub_type_id': {'type': ['null', 'integer']},\n                    'system_field_options': {'type': ['null', 'array']},\n                    'tag': {'type': ['null', 'string']},\n                    'title': {'type': ['null', 'string']},\n                    'title_in_portal': {'type': ['null', 'string']},\n                    'type': {'type': ['null', 'string']},\n                    'updated_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'url': {'type': ['null', 'string']},\n                    'visible_in_portal': {'type': ['null', 'boolean']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'active': True,\n     'agent_description': None,\n     'collapsed_for_agents': False,\n     'created_at': '2022-10-05T05:41:30Z',\n     'custom_statuses': [{'active': True,\n                          'agent_label': 'New',\n                          'created_at': '2021-10-14T19:56:30Z',\n                          'default': True,\n                          'description': 'Ticket is awaiting assignment to '\n                                         'an agent',\n                          'end_user_description': 'We are working on a '\n                                                  'response for you',\n                          'end_user_label': 'Open',\n                          'id': 4044356,\n                          'status_category': 'new',\n                          'updated_at': '2021-10-14T19:56:30Z',\n                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044356.json'},\n                         {'active': True,\n                          'agent_label': 'Open',\n                          'created_at': '2021-10-14T19:56:30Z',\n                          'default': True,\n                          'description': 'Staff is working on the ticket',\n                          'end_user_description': 'We are working on a '\n                                                  'response for you',\n                          'end_user_label': 'Open',\n                          'id': 4044376,\n                          'status_category': 'open',\n                          'updated_at': '2021-10-14T19:56:30Z',\n                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044376.json'},\n                         {'active': True,\n                          'agent_label': 'Pending',\n                          'created_at': '2021-10-14T19:56:30Z',\n                          'default': True,\n                          'description': 'Staff is waiting for the '\n                                         'requester to reply',\n                          'end_user_description': 'We are waiting for you '\n                                                  'to respond',\n                          'end_user_label': 'Awaiting your reply',\n                          'id': 4044396,\n                          'status_category': 'pending',\n                          'updated_at': '2021-10-14T19:56:30Z',\n                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044396.json'},\n                         {'active': False,\n                          'agent_label': 'On-hold',\n                          'created_at': '2021-10-14T19:56:30Z',\n                          'default': True,\n                          'description': 'Staff is waiting for a third '\n                                         'party',\n                          'end_user_description': 'We are working on a '\n                                                  'response for you',\n                          'end_user_label': 'Open',\n                          'id': 4044416,\n                          'status_category': 'hold',\n                          'updated_at': '2022-11-21T03:53:49Z',\n                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044416.json'},\n                         {'active': True,\n                          'agent_label': 'Solved',\n                          'created_at': '2021-10-14T19:56:30Z',\n                          'default': True,\n                          'description': 'The ticket has been solved',\n                          'end_user_description': 'This request has been '\n                                                  'solved',\n                          'end_user_label': 'Solved',\n                          'id': 4044436,\n                          'status_category': 'solved',\n                          'updated_at': '2021-10-14T19:56:30Z',\n                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044436.json'}],\n     'description': 'Request ticket status',\n     'editable_in_portal': False,\n     'id': 5616655556879,\n     'key': None,\n     'position': 9999,\n     'raw_description': 'Request ticket status',\n     'raw_title': 'Ticket status',\n     'raw_title_in_portal': 'Ticket status',\n     'regexp_for_validation': None,\n     'removable': False,\n     'required': False,\n     'required_in_portal': False,\n     'tag': None,\n     'title': 'Ticket status',\n     'title_in_portal': 'Ticket status',\n     'type': 'custom_status',\n     'updated_at': '2022-10-05T05:41:30Z',\n     'url': 'https://d3v-airbyte.zendesk.com/api/v2/ticket_fields/5616655556879.json',\n     'visible_in_portal': False}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe tickets stream has the following schema errors:\nAdditional properties are not allowed ('fields', 'from_messaging_channel' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'allow_attachments': {'type': ['null', 'boolean']},\n                    'allow_channelback': {'type': ['null', 'boolean']},\n                    'assignee_id': {'type': ['null', 'integer']},\n                    'brand_id': {'type': ['null', 'integer']},\n                    'collaborator_ids': {'items': {'type': ['null',\n                                                            'integer']},\n                                         'type': ['null', 'array']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'custom_fields': {'items': {'properties': {'id': {'type': ['null',\n                                                                               'integer']},\n                                                               'value': {'type': ['null',\n                                                                                  'string']}},\n                                                'type': ['null', 'object']},\n                                      'type': ['null', 'array']},\n                    'description': {'type': ['null', 'string']},\n                    'due_at': {'format': 'date-time',\n                               'type': ['null', 'string']},\n                    'email_cc_ids': {'items': {'type': ['null', 'integer']},\n                                     'type': ['null', 'array']},\n                    'external_id': {'type': ['null', 'string']},\n                    'follower_ids': {'items': {'type': ['null', 'integer']},\n                                     'type': ['null', 'array']},\n                    'followup_ids': {'items': {'type': ['null', 'integer']},\n                                     'type': ['null', 'array']},\n                    'forum_topic_id': {'type': ['null', 'integer']},\n                    'generated_timestamp': {'type': ['null', 'integer']},\n                    'group_id': {'type': ['null', 'integer']},\n                    'has_incidents': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'is_public': {'type': ['null', 'boolean']},\n                    'organization_id': {'type': ['null', 'integer']},\n                    'priority': {'type': ['null', 'string']},\n                    'problem_id': {'type': ['null', 'integer']},\n                    'raw_subject': {'type': ['null', 'string']},\n                    'recipient': {'type': ['null', 'string']},\n                    'requester_id': {'type': ['null', 'integer']},\n                    'satisfaction_rating': {'properties': {'assignee_id': {'type': ['null',\n                                                                                    'integer']},\n                                                           'comment': {'type': ['null',\n                                                                                'string']},\n                                                           'created_at': {'format': 'date-time',\n                                                                          'type': ['null',\n                                                                                   'string']},\n                                                           'group_id': {'type': ['null',\n                                                                                 'integer']},\n                                                           'id': {'type': ['null',\n                                                                           'integer']},\n                                                           'reason': {'type': ['null',\n                                                                               'string']},\n                                                           'reason_id': {'type': ['null',\n                                                                                  'integer']},\n                                                           'requester_id': {'type': ['null',\n                                                                                     'integer']},\n                                                           'score': {'type': ['null',\n                                                                              'string']},\n                                                           'ticket_id': {'type': ['null',\n                                                                                  'integer']},\n                                                           'updated_at': {'format': 'date-time',\n                                                                          'type': ['null',\n                                                                                   'string']},\n                                                           'url': {'type': ['null',\n                                                                            'string']}},\n                                            'type': ['null',\n                                                     'object',\n                                                     'string']},\n                    'sharing_agreement_ids': {'items': {'type': ['null',\n                                                                 'integer']},\n                                              'type': ['null', 'array']},\n                    'status': {'type': ['null', 'string']},\n                    'subject': {'type': ['null', 'string']},\n                    'submitter_id': {'type': ['null', 'integer']},\n                    'tags': {'items': {'type': ['null', 'string']},\n                             'type': ['null', 'array']},\n                    'ticket_form_id': {'type': ['null', 'integer']},\n                    'type': {'type': ['null', 'string']},\n                    'updated_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'url': {'type': ['null', 'string']},\n                    'via': {'properties': {'channel': {'type': ['null',\n                                                                'string']},\n                                           'source': {'properties': {'from': {'properties': {'address': {'type': ['null',\n                                                                                                                  'string']},\n                                                                                             'deleted': {'type': ['null',\n                                                                                                                  'boolean']},\n                                                                                             'facebook_id': {'type': ['null',\n                                                                                                                      'string']},\n                                                                                             'formatted_phone': {'type': ['null',\n                                                                                                                          'string']},\n                                                                                             'id': {'type': ['null',\n                                                                                                             'integer']},\n                                                                                             'name': {'type': ['null',\n                                                                                                               'string']},\n                                                                                             'original_recipients': {'items': {'type': ['null',\n                                                                                                                                        'string']},\n                                                                                                                     'type': ['null',\n                                                                                                                              'array']},\n                                                                                             'phone': {'type': ['null',\n                                                                                                                'string']},\n                                                                                             'profile_url': {'type': ['null',\n                                                                                                                      'string']},\n                                                                                             'revision_id': {'type': ['null',\n                                                                                                                      'integer']},\n                                                                                             'subject': {'type': ['null',\n                                                                                                                  'string']},\n                                                                                             'ticket_id': {'type': ['null',\n                                                                                                                    'integer']},\n                                                                                             'title': {'type': ['null',\n                                                                                                                'string']},\n                                                                                             'topic_id': {'type': ['null',\n                                                                                                                   'integer']},\n                                                                                             'topic_name': {'type': ['null',\n                                                                                                                     'string']},\n                                                                                             'username': {'type': ['null',\n                                                                                                                   'string']}},\n                                                                              'type': ['null',\n                                                                                       'object']},\n                                                                     'rel': {'type': ['null',\n                                                                                      'string']},\n                                                                     'to': {'properties': {'address': {'type': ['null',\n                                                                                                                'string']},\n                                                                                           'email_ccs': {'type': ['null',\n                                                                                                                  'string']},\n                                                                                           'facebook_id': {'type': ['null',\n                                                                                                                    'string']},\n                                                                                           'formatted_phone': {'type': ['null',\n                                                                                                                        'string']},\n                                                                                           'name': {'type': ['null',\n                                                                                                             'string']},\n                                                                                           'phone': {'type': ['null',\n                                                                                                              'string']},\n                                                                                           'profile_url': {'type': ['null',\n                                                                                                                    'string']},\n                                                                                           'username': {'type': ['null',\n                                                                                                                 'string']}},\n                                                                            'type': ['null',\n                                                                                     'object']}},\n                                                      'type': ['null',\n                                                               'object']}},\n                            'type': ['null', 'object']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'allow_attachments': True,\n     'allow_channelback': False,\n     'assignee_id': None,\n     'brand_id': 360000358316,\n     'collaborator_ids': [],\n     'created_at': '2022-07-19T09:41:20Z',\n     'custom_fields': [],\n     'description': 'test to',\n     'due_at': None,\n     'email_cc_ids': [],\n     'external_id': None,\n     'fields': [],\n     'follower_ids': [],\n     'followup_ids': [],\n     'forum_topic_id': None,\n     'from_messaging_channel': False,\n     'generated_timestamp': 1669136524,\n     'group_id': None,\n     'has_incidents': False,\n     'id': 141,\n     'is_public': True,\n     'organization_id': 360033549136,\n     'priority': 'high',\n     'problem_id': None,\n     'raw_subject': 'test to',\n     'recipient': None,\n     'requester_id': 360786799676,\n     'satisfaction_rating': {'score': 'offered'},\n     'sharing_agreement_ids': [],\n     'status': 'new',\n     'subject': 'test to',\n     'submitter_id': 360786799676,\n     'tags': ['tag1', 'tag2'],\n     'ticket_form_id': 360000084116,\n     'type': 'question',\n     'updated_at': '2022-11-22T17:02:04Z',\n     'url': 'https://d3v-airbyte.zendesk.com/api/v2/tickets/141.json',\n     'via': {'channel': 'api',\n             'source': {'from': {}, 'rel': None, 'to': {}}}}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe users stream has the following schema errors:\nAdditional properties are not allowed ('iana_time_zone' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'active': {'type': ['null', 'boolean']},\n                    'alias': {'type': ['null', 'string']},\n                    'chat_only': {'type': ['null', 'boolean']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'custom_role_id': {'type': ['null', 'integer']},\n                    'default_group_id': {'type': ['null', 'integer']},\n                    'details': {'type': ['null', 'string']},\n                    'email': {'type': ['null', 'string']},\n                    'external_id': {'type': ['null', 'string']},\n                    'id': {'type': ['null', 'integer']},\n                    'last_login_at': {'format': 'date-time',\n                                      'type': ['null', 'string']},\n                    'locale': {'type': ['null', 'string']},\n                    'locale_id': {'type': ['null', 'integer']},\n                    'moderator': {'type': ['null', 'boolean']},\n                    'name': {'type': ['null', 'string']},\n                    'notes': {'type': ['null', 'string']},\n                    'only_private_comments': {'type': ['null', 'boolean']},\n                    'organization_id': {'type': ['null', 'integer']},\n                    'permanently_deleted': {'type': ['null', 'boolean']},\n                    'phone': {'type': ['null', 'string']},\n                    'photo': {'properties': {'content_type': {'type': ['null',\n                                                                       'string']},\n                                             'content_url': {'type': ['null',\n                                                                      'string']},\n                                             'file_name': {'type': ['null',\n                                                                    'string']},\n                                             'height': {'type': ['null',\n                                                                 'integer']},\n                                             'id': {'type': ['null',\n                                                             'integer']},\n                                             'inline': {'type': ['null',\n                                                                 'boolean']},\n                                             'mapped_content_url': {'type': ['null',\n                                                                             'string']},\n                                             'size': {'type': ['null',\n                                                               'integer']},\n                                             'thumbnails': {'items': {'properties': {'content_type': {'type': ['null',\n                                                                                                               'string']},\n                                                                                     'content_url': {'type': ['null',\n                                                                                                              'string']},\n                                                                                     'file_name': {'type': ['null',\n                                                                                                            'string']},\n                                                                                     'height': {'type': ['null',\n                                                                                                         'integer']},\n                                                                                     'id': {'type': ['null',\n                                                                                                     'integer']},\n                                                                                     'inline': {'type': ['null',\n                                                                                                         'boolean']},\n                                                                                     'mapped_content_url': {'type': ['null',\n                                                                                                                     'string']},\n                                                                                     'size': {'type': ['null',\n                                                                                                       'integer']},\n                                                                                     'url': {'type': ['null',\n                                                                                                      'string']},\n                                                                                     'width': {'type': ['null',\n                                                                                                        'integer']}},\n                                                                      'type': ['null',\n                                                                               'object']},\n                                                            'type': ['null',\n                                                                     'array']},\n                                             'url': {'type': ['null',\n                                                              'string']},\n                                             'width': {'type': ['null',\n                                                                'integer']}},\n                              'type': ['null', 'object']},\n                    'report_csv': {'type': ['null', 'boolean']},\n                    'restricted_agent': {'type': ['null', 'boolean']},\n                    'role': {'type': ['null', 'string']},\n                    'role_type': {'type': ['null', 'integer']},\n                    'shared': {'type': ['null', 'boolean']},\n                    'shared_agent': {'type': ['null', 'boolean']},\n                    'shared_phone_number': {'type': ['null', 'boolean']},\n                    'signature': {'type': ['null', 'string']},\n                    'suspended': {'type': ['null', 'boolean']},\n                    'tags': {'items': {'type': ['null', 'string']},\n                             'type': ['null', 'array']},\n                    'ticket_restriction': {'type': ['null', 'string']},\n                    'time_zone': {'type': ['null', 'string']},\n                    'two_factor_auth_enabled': {'type': ['null',\n                                                         'boolean']},\n                    'updated_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'url': {'type': ['null', 'string']},\n                    'user_fields': {'additionalProperties': True,\n                                    'properties': {},\n                                    'type': ['null', 'object']},\n                    'verified': {'type': ['null', 'boolean']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'active': True,\n     'alias': None,\n     'created_at': '2022-12-29T04:22:54Z',\n     'custom_role_id': None,\n     'default_group_id': None,\n     'details': None,\n     'email': 'integration-test+jason_bowen@airbyte.io',\n     'external_id': None,\n     'iana_time_zone': 'Pacific/Noumea',\n     'id': 6126921294607,\n     'last_login_at': None,\n     'locale': 'en-US',\n     'locale_id': 1,\n     'moderator': False,\n     'name': 'Jason_Bowen',\n     'notes': None,\n     'only_private_comments': False,\n     'organization_id': None,\n     'phone': None,\n     'photo': None,\n     'report_csv': False,\n     'restricted_agent': True,\n     'role': 'end-user',\n     'role_type': None,\n     'shared': False,\n     'shared_agent': False,\n     'shared_phone_number': None,\n     'signature': None,\n     'suspended': False,\n     'tags': [],\n     'ticket_restriction': 'requested',\n     'time_zone': 'Pacific/Noumea',\n     'two_factor_auth_enabled': False,\n     'updated_at': '2022-12-29T04:22:54Z',\n     'url': 'https://d3v-airbyte.zendesk.com/api/v2/users/6126921294607.json',\n     'user_fields': {},\n     'verified': False}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe ticket_forms stream has the following schema errors:\nAdditional properties are not allowed ('agent_conditions', 'end_user_conditions' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'active': {'type': ['null', 'boolean']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'default': {'type': ['null', 'boolean']},\n                    'display_name': {'type': ['null', 'string']},\n                    'end_user_visible': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'in_all_brands': {'type': ['null', 'boolean']},\n                    'name': {'type': ['null', 'string']},\n                    'position': {'type': ['null', 'integer']},\n                    'raw_display_name': {'type': ['null', 'string']},\n                    'raw_name': {'type': ['null', 'string']},\n                    'restricted_brand_ids': {'items': {'type': ['null',\n                                                                'integer']},\n                                             'type': ['null', 'array']},\n                    'ticket_field_ids': {'items': {'type': ['null',\n                                                            'integer']},\n                                         'type': ['null', 'array']},\n                    'updated_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'url': {'type': ['null', 'string']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'active': True,\n     'agent_conditions': [],\n     'created_at': '2020-12-11T18:34:37Z',\n     'default': True,\n     'display_name': 'Default Ticket Form',\n     'end_user_conditions': [],\n     'end_user_visible': True,\n     'id': 360000084116,\n     'in_all_brands': True,\n     'name': 'Default Ticket Form',\n     'position': 1,\n     'raw_display_name': 'Default Ticket Form',\n     'raw_name': 'Default Ticket Form',\n     'restricted_brand_ids': [],\n     'ticket_field_ids': [360002833076,\n                          360002833096,\n                          360002833116,\n                          360002833136,\n                          360002833156,\n                          360002833176,\n                          360002833196],\n     'updated_at': '2020-12-11T18:34:37Z',\n     'url': 'https://d3v-airbyte.zendesk.com/api/v2/ticket_forms/360000084116.json'}"}}
------------------------------ Captured log call -------------------------------
ERROR    root:test_core.py:662 
The groups stream has the following schema errors:
Additional properties are not allowed ('default', 'description', 'is_public' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'deleted': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'name': {'type': ['null', 'string']},
                    'updated_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'url': {'type': ['null', 'string']}},
     'type': ['null', 'object']}

On instance:
    {'created_at': '2020-12-11T18:34:05Z',
     'default': False,
     'deleted': False,
     'description': '',
     'id': 360003074836,
     'is_public': True,
     'name': 'Support',
     'updated_at': '2021-07-28T17:22:42Z',
     'url': 'https://d3v-airbyte.zendesk.com/api/v2/groups/360003074836.json'}
ERROR    root:test_core.py:662 
The macros stream has the following schema errors:
Additional properties are not allowed ('default', 'raw_title' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'actions': {'items': {'properties': {'field': {'type': ['null',
                                                                            'string']},
                                                         'value': {'type': ['null',
                                                                            'string']}},
                                          'type': ['null', 'object']},
                                'type': ['null', 'array']},
                    'active': {'type': ['null', 'boolean']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'description': {'type': ['null', 'string']},
                    'id': {'type': ['null', 'integer']},
                    'position': {'type': ['null', 'integer']},
                    'restriction': {'properties': {'id': {'type': ['null',
                                                                   'integer']},
                                                   'ids': {'items': {'type': ['null',
                                                                              'integer']},
                                                           'type': ['null',
                                                                    'array']},
                                                   'type': {'type': ['null',
                                                                     'string']}},
                                    'type': ['null', 'object']},
                    'title': {'type': ['null', 'string']},
                    'updated_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'url': {'type': ['null', 'string']}},
     'type': ['null', 'object']}

On instance:
    {'actions': [{'field': 'priority', 'value': 'low'},
                 {'field': 'comment_value',
                  'value': "We're currently experiencing unusually high "
                           "traffic. We'll get back to you as soon as "
                           'possible.'}],
     'active': True,
     'created_at': '2020-12-11T18:34:06Z',
     'default': False,
     'description': None,
     'id': 360011363536,
     'position': 9999,
     'raw_title': 'Downgrade and inform',
     'restriction': None,
     'title': 'Downgrade and inform',
     'updated_at': '2020-12-11T18:34:06Z',
     'url': 'https://d3v-airbyte.zendesk.com/api/v2/macros/360011363536.json'}
ERROR    root:test_core.py:662 
The ticket_comments stream has the following schema errors:
Additional properties are not allowed ('event_type' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'attachments': {'items': {'properties': {'content_type': {'type': ['null',
                                                                                       'string']},
                                                             'content_url': {'type': ['null',
                                                                                      'string']},
                                                             'file_name': {'type': ['null',
                                                                                    'string']},
                                                             'height': {'type': ['null',
                                                                                 'integer']},
                                                             'id': {'type': ['null',
                                                                             'integer']},
                                                             'inline': {'type': ['null',
                                                                                 'boolean']},
                                                             'mapped_content_url': {'type': ['null',
                                                                                             'string']},
                                                             'size': {'type': ['null',
                                                                               'integer']},
                                                             'thumbnails': {'items': {'properties': {'content_type': {'type': ['null',
                                                                                                                               'string']},
                                                                                                     'content_url': {'type': ['null',
                                                                                                                              'string']},
                                                                                                     'file_name': {'type': ['null',
                                                                                                                            'string']},
                                                                                                     'height': {'type': ['null',
                                                                                                                         'integer']},
                                                                                                     'id': {'type': ['null',
                                                                                                                     'integer']},
                                                                                                     'inline': {'type': ['null',
                                                                                                                         'boolean']},
                                                                                                     'mapped_content_url': {'type': ['null',
                                                                                                                                     'string']},
                                                                                                     'size': {'type': ['null',
                                                                                                                       'integer']},
                                                                                                     'url': {'type': ['null',
                                                                                                                      'string']},
                                                                                                     'width': {'type': ['null',
                                                                                                                        'integer']}},
                                                                                      'type': ['null',
                                                                                               'object']},
                                                                            'type': ['null',
                                                                                     'array']},
                                                             'url': {'type': ['null',
                                                                              'string']},
                                                             'width': {'type': ['null',
                                                                                'integer']}},
                                              'type': ['null', 'object']},
                                    'type': ['null', 'array']},
                    'audit_id': {'type': ['null', 'integer']},
                    'author_id': {'type': ['null', 'integer']},
                    'body': {'type': ['null', 'string']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'html_body': {'type': ['null', 'string']},
                    'id': {'type': ['null', 'integer']},
                    'metadata': {'properties': {'custom': {'additionalProperties': True,
                                                           'properties': {},
                                                           'type': ['null',
                                                                    'object']},
                                                'flags': {'items': {'type': ['null',
                                                                             'integer']},
                                                          'type': ['null',
                                                                   'array']},
                                                'flags_options': {'properties': {'11': {'properties': {'message': {'properties': {'user': {'type': ['null',
                                                                                                                                                    'string']}},
                                                                                                                   'type': ['null',
                                                                                                                            'object']},
                                                                                                       'trusted': {'type': ['null',
                                                                                                                            'boolean']}},
                                                                                        'type': ['null',
                                                                                                 'object']},
                                                                                 '2': {'properties': {'trusted': {'type': ['null',
                                                                                                                           'boolean']}},
                                                                                       'type': ['null',
                                                                                                'object']}},
                                                                  'type': ['null',
                                                                           'object']},
                                                'notifications_suppressed_for': {'items': {'type': ['null',
                                                                                                    'integer']},
                                                                                 'type': ['null',
                                                                                          'array']},
                                                'system': {'properties': {'client': {'type': ['null',
                                                                                              'string']},
                                                                          'ip_address': {'type': ['null',
                                                                                                  'string']},
                                                                          'json_email_identifier': {'type': ['null',
                                                                                                             'string']},
                                                                          'latitude': {'type': ['null',
                                                                                                'number']},
                                                                          'location': {'type': ['null',
                                                                                                'string']},
                                                                          'longitude': {'type': ['null',
                                                                                                 'number']},
                                                                          'message_id': {'type': ['null',
                                                                                                  'string']},
                                                                          'raw_email_identifier': {'type': ['null',
                                                                                                            'string']}},
                                                           'type': ['null',
                                                                    'object']},
                                                'trusted': {'type': ['null',
                                                                     'boolean']}},
                                 'type': ['null', 'object']},
                    'plain_body': {'type': ['null', 'string']},
                    'public': {'type': ['null', 'boolean']},
                    'ticket_id': {'type': ['null', 'integer']},
                    'timestamp': {'type': ['null', 'integer']},
                    'type': {'type': ['null', 'string']},
                    'via': {'properties': {'channel': {'type': ['null',
                                                                'string']},
                                           'source': {'properties': {'from': {'properties': {'address': {'type': ['null',
                                                                                                                  'string']},
                                                                                             'deleted': {'type': ['null',
                                                                                                                  'boolean']},
                                                                                             'id': {'type': ['null',
                                                                                                             'integer']},
                                                                                             'name': {'type': ['null',
                                                                                                               'string']},
                                                                                             'original_recipients': {'items': {'type': ['null',
                                                                                                                                        'string']},
                                                                                                                     'type': ['null',
                                                                                                                              'array']},
                                                                                             'subject': {'type': ['null',
                                                                                                                  'string']},
                                                                                             'ticket_id': {'type': ['null',
                                                                                                                    'integer']},
                                                                                             'ticket_ids': {'items': {'type': ['null',
                                                                                                                               'integer']},
                                                                                                            'type': ['null',
                                                                                                                     'array']},
                                                                                             'title': {'type': ['null',
                                                                                                                'string']}},
                                                                              'type': ['null',
                                                                                       'object']},
                                                                     'rel': {'type': ['null',
                                                                                      'string']},
                                                                     'to': {'properties': {'address': {'type': ['null',
                                                                                                                'string']},
                                                                                           'name': {'type': ['null',
                                                                                                             'string']}},
                                                                            'type': ['null',
                                                                                     'object']}},
                                                      'type': ['null',
                                                               'object']}},
                            'type': ['null', 'object']},
                    'via_reference_id': {'type': ['null', 'integer']}},
     'type': ['null', 'object']}

On instance:
    {'attachments': [],
     'audit_id': 5168539817231,
     'author_id': 360786799676,
     'body': 'test to',
     'created_at': '2022-07-19T09:41:20Z',
     'event_type': 'Comment',
     'html_body': '<div class="zd-comment" dir="auto">test to<br></div>',
     'id': 5168539817359,
     'plain_body': 'test to',
     'public': True,
     'ticket_id': 141,
     'timestamp': 1658223680,
     'type': 'Comment',
     'via': {'channel': 'api',
             'source': {'from': {},
                        'rel': None,
                        'to': {'address': 'integration-test@airbyte.io',
                               'name': 'Team Airbyte'}}},
     'via_reference_id': None}
ERROR    root:test_core.py:662 
The ticket_fields stream has the following schema errors:
Additional properties are not allowed ('key', 'custom_statuses' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'active': {'type': ['null', 'boolean']},
                    'agent_description': {'type': ['null', 'string']},
                    'collapsed_for_agents': {'type': ['null', 'boolean']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'custom_field_options': {'items': {'properties': {'default': {'type': ['null',
                                                                                           'boolean']},
                                                                      'id': {'type': ['null',
                                                                                      'integer']},
                                                                      'name': {'type': ['null',
                                                                                        'string']},
                                                                      'raw_name': {'type': ['null',
                                                                                            'string']},
                                                                      'value': {'type': ['null',
                                                                                         'string']}},
                                                       'type': ['null',
                                                                'object']},
                                             'type': ['null', 'array']},
                    'description': {'type': ['null', 'string']},
                    'editable_in_portal': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'position': {'type': ['null', 'integer']},
                    'raw_description': {'type': ['null', 'string']},
                    'raw_title': {'type': ['null', 'string']},
                    'raw_title_in_portal': {'type': ['null', 'string']},
                    'regexp_for_validation': {'type': ['null', 'string']},
                    'removable': {'type': ['null', 'boolean']},
                    'required': {'type': ['null', 'boolean']},
                    'required_in_portal': {'type': ['null', 'boolean']},
                    'sub_type_id': {'type': ['null', 'integer']},
                    'system_field_options': {'type': ['null', 'array']},
                    'tag': {'type': ['null', 'string']},
                    'title': {'type': ['null', 'string']},
                    'title_in_portal': {'type': ['null', 'string']},
                    'type': {'type': ['null', 'string']},
                    'updated_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'url': {'type': ['null', 'string']},
                    'visible_in_portal': {'type': ['null', 'boolean']}},
     'type': ['null', 'object']}

On instance:
    {'active': True,
     'agent_description': None,
     'collapsed_for_agents': False,
     'created_at': '2022-10-05T05:41:30Z',
     'custom_statuses': [{'active': True,
                          'agent_label': 'New',
                          'created_at': '2021-10-14T19:56:30Z',
                          'default': True,
                          'description': 'Ticket is awaiting assignment to '
                                         'an agent',
                          'end_user_description': 'We are working on a '
                                                  'response for you',
                          'end_user_label': 'Open',
                          'id': 4044356,
                          'status_category': 'new',
                          'updated_at': '2021-10-14T19:56:30Z',
                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044356.json'},
                         {'active': True,
                          'agent_label': 'Open',
                          'created_at': '2021-10-14T19:56:30Z',
                          'default': True,
                          'description': 'Staff is working on the ticket',
                          'end_user_description': 'We are working on a '
                                                  'response for you',
                          'end_user_label': 'Open',
                          'id': 4044376,
                          'status_category': 'open',
                          'updated_at': '2021-10-14T19:56:30Z',
                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044376.json'},
                         {'active': True,
                          'agent_label': 'Pending',
                          'created_at': '2021-10-14T19:56:30Z',
                          'default': True,
                          'description': 'Staff is waiting for the '
                                         'requester to reply',
                          'end_user_description': 'We are waiting for you '
                                                  'to respond',
                          'end_user_label': 'Awaiting your reply',
                          'id': 4044396,
                          'status_category': 'pending',
                          'updated_at': '2021-10-14T19:56:30Z',
                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044396.json'},
                         {'active': False,
                          'agent_label': 'On-hold',
                          'created_at': '2021-10-14T19:56:30Z',
                          'default': True,
                          'description': 'Staff is waiting for a third '
                                         'party',
                          'end_user_description': 'We are working on a '
                                                  'response for you',
                          'end_user_label': 'Open',
                          'id': 4044416,
                          'status_category': 'hold',
                          'updated_at': '2022-11-21T03:53:49Z',
                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044416.json'},
                         {'active': True,
                          'agent_label': 'Solved',
                          'created_at': '2021-10-14T19:56:30Z',
                          'default': True,
                          'description': 'The ticket has been solved',
                          'end_user_description': 'This request has been '
                                                  'solved',
                          'end_user_label': 'Solved',
                          'id': 4044436,
                          'status_category': 'solved',
                          'updated_at': '2021-10-14T19:56:30Z',
                          'url': 'https://d3v-airbyte.zendesk.com/api/v2/custom_statuses/4044436.json'}],
     'description': 'Request ticket status',
     'editable_in_portal': False,
     'id': 5616655556879,
     'key': None,
     'position': 9999,
     'raw_description': 'Request ticket status',
     'raw_title': 'Ticket status',
     'raw_title_in_portal': 'Ticket status',
     'regexp_for_validation': None,
     'removable': False,
     'required': False,
     'required_in_portal': False,
     'tag': None,
     'title': 'Ticket status',
     'title_in_portal': 'Ticket status',
     'type': 'custom_status',
     'updated_at': '2022-10-05T05:41:30Z',
     'url': 'https://d3v-airbyte.zendesk.com/api/v2/ticket_fields/5616655556879.json',
     'visible_in_portal': False}
ERROR    root:test_core.py:662 
The tickets stream has the following schema errors:
Additional properties are not allowed ('fields', 'from_messaging_channel' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'allow_attachments': {'type': ['null', 'boolean']},
                    'allow_channelback': {'type': ['null', 'boolean']},
                    'assignee_id': {'type': ['null', 'integer']},
                    'brand_id': {'type': ['null', 'integer']},
                    'collaborator_ids': {'items': {'type': ['null',
                                                            'integer']},
                                         'type': ['null', 'array']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'custom_fields': {'items': {'properties': {'id': {'type': ['null',
                                                                               'integer']},
                                                               'value': {'type': ['null',
                                                                                  'string']}},
                                                'type': ['null', 'object']},
                                      'type': ['null', 'array']},
                    'description': {'type': ['null', 'string']},
                    'due_at': {'format': 'date-time',
                               'type': ['null', 'string']},
                    'email_cc_ids': {'items': {'type': ['null', 'integer']},
                                     'type': ['null', 'array']},
                    'external_id': {'type': ['null', 'string']},
                    'follower_ids': {'items': {'type': ['null', 'integer']},
                                     'type': ['null', 'array']},
                    'followup_ids': {'items': {'type': ['null', 'integer']},
                                     'type': ['null', 'array']},
                    'forum_topic_id': {'type': ['null', 'integer']},
                    'generated_timestamp': {'type': ['null', 'integer']},
                    'group_id': {'type': ['null', 'integer']},
                    'has_incidents': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'is_public': {'type': ['null', 'boolean']},
                    'organization_id': {'type': ['null', 'integer']},
                    'priority': {'type': ['null', 'string']},
                    'problem_id': {'type': ['null', 'integer']},
                    'raw_subject': {'type': ['null', 'string']},
                    'recipient': {'type': ['null', 'string']},
                    'requester_id': {'type': ['null', 'integer']},
                    'satisfaction_rating': {'properties': {'assignee_id': {'type': ['null',
                                                                                    'integer']},
                                                           'comment': {'type': ['null',
                                                                                'string']},
                                                           'created_at': {'format': 'date-time',
                                                                          'type': ['null',
                                                                                   'string']},
                                                           'group_id': {'type': ['null',
                                                                                 'integer']},
                                                           'id': {'type': ['null',
                                                                           'integer']},
                                                           'reason': {'type': ['null',
                                                                               'string']},
                                                           'reason_id': {'type': ['null',
                                                                                  'integer']},
                                                           'requester_id': {'type': ['null',
                                                                                     'integer']},
                                                           'score': {'type': ['null',
                                                                              'string']},
                                                           'ticket_id': {'type': ['null',
                                                                                  'integer']},
                                                           'updated_at': {'format': 'date-time',
                                                                          'type': ['null',
                                                                                   'string']},
                                                           'url': {'type': ['null',
                                                                            'string']}},
                                            'type': ['null',
                                                     'object',
                                                     'string']},
                    'sharing_agreement_ids': {'items': {'type': ['null',
                                                                 'integer']},
                                              'type': ['null', 'array']},
                    'status': {'type': ['null', 'string']},
                    'subject': {'type': ['null', 'string']},
                    'submitter_id': {'type': ['null', 'integer']},
                    'tags': {'items': {'type': ['null', 'string']},
                             'type': ['null', 'array']},
                    'ticket_form_id': {'type': ['null', 'integer']},
                    'type': {'type': ['null', 'string']},
                    'updated_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'url': {'type': ['null', 'string']},
                    'via': {'properties': {'channel': {'type': ['null',
                                                                'string']},
                                           'source': {'properties': {'from': {'properties': {'address': {'type': ['null',
                                                                                                                  'string']},
                                                                                             'deleted': {'type': ['null',
                                                                                                                  'boolean']},
                                                                                             'facebook_id': {'type': ['null',
                                                                                                                      'string']},
                                                                                             'formatted_phone': {'type': ['null',
                                                                                                                          'string']},
                                                                                             'id': {'type': ['null',
                                                                                                             'integer']},
                                                                                             'name': {'type': ['null',
                                                                                                               'string']},
                                                                                             'original_recipients': {'items': {'type': ['null',
                                                                                                                                        'string']},
                                                                                                                     'type': ['null',
                                                                                                                              'array']},
                                                                                             'phone': {'type': ['null',
                                                                                                                'string']},
                                                                                             'profile_url': {'type': ['null',
                                                                                                                      'string']},
                                                                                             'revision_id': {'type': ['null',
                                                                                                                      'integer']},
                                                                                             'subject': {'type': ['null',
                                                                                                                  'string']},
                                                                                             'ticket_id': {'type': ['null',
                                                                                                                    'integer']},
                                                                                             'title': {'type': ['null',
                                                                                                                'string']},
                                                                                             'topic_id': {'type': ['null',
                                                                                                                   'integer']},
                                                                                             'topic_name': {'type': ['null',
                                                                                                                     'string']},
                                                                                             'username': {'type': ['null',
                                                                                                                   'string']}},
                                                                              'type': ['null',
                                                                                       'object']},
                                                                     'rel': {'type': ['null',
                                                                                      'string']},
                                                                     'to': {'properties': {'address': {'type': ['null',
                                                                                                                'string']},
                                                                                           'email_ccs': {'type': ['null',
                                                                                                                  'string']},
                                                                                           'facebook_id': {'type': ['null',
                                                                                                                    'string']},
                                                                                           'formatted_phone': {'type': ['null',
                                                                                                                        'string']},
                                                                                           'name': {'type': ['null',
                                                                                                             'string']},
                                                                                           'phone': {'type': ['null',
                                                                                                              'string']},
                                                                                           'profile_url': {'type': ['null',
                                                                                                                    'string']},
                                                                                           'username': {'type': ['null',
                                                                                                                 'string']}},
                                                                            'type': ['null',
                                                                                     'object']}},
                                                      'type': ['null',
                                                               'object']}},
                            'type': ['null', 'object']}},
     'type': ['null', 'object']}

On instance:
    {'allow_attachments': True,
     'allow_channelback': False,
     'assignee_id': None,
     'brand_id': 360000358316,
     'collaborator_ids': [],
     'created_at': '2022-07-19T09:41:20Z',
     'custom_fields': [],
     'description': 'test to',
     'due_at': None,
     'email_cc_ids': [],
     'external_id': None,
     'fields': [],
     'follower_ids': [],
     'followup_ids': [],
     'forum_topic_id': None,
     'from_messaging_channel': False,
     'generated_timestamp': 1669136524,
     'group_id': None,
     'has_incidents': False,
     'id': 141,
     'is_public': True,
     'organization_id': 360033549136,
     'priority': 'high',
     'problem_id': None,
     'raw_subject': 'test to',
     'recipient': None,
     'requester_id': 360786799676,
     'satisfaction_rating': {'score': 'offered'},
     'sharing_agreement_ids': [],
     'status': 'new',
     'subject': 'test to',
     'submitter_id': 360786799676,
     'tags': ['tag1', 'tag2'],
     'ticket_form_id': 360000084116,
     'type': 'question',
     'updated_at': '2022-11-22T17:02:04Z',
     'url': 'https://d3v-airbyte.zendesk.com/api/v2/tickets/141.json',
     'via': {'channel': 'api',
             'source': {'from': {}, 'rel': None, 'to': {}}}}
ERROR    root:test_core.py:662 
The users stream has the following schema errors:
Additional properties are not allowed ('iana_time_zone' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'active': {'type': ['null', 'boolean']},
                    'alias': {'type': ['null', 'string']},
                    'chat_only': {'type': ['null', 'boolean']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'custom_role_id': {'type': ['null', 'integer']},
                    'default_group_id': {'type': ['null', 'integer']},
                    'details': {'type': ['null', 'string']},
                    'email': {'type': ['null', 'string']},
                    'external_id': {'type': ['null', 'string']},
                    'id': {'type': ['null', 'integer']},
                    'last_login_at': {'format': 'date-time',
                                      'type': ['null', 'string']},
                    'locale': {'type': ['null', 'string']},
                    'locale_id': {'type': ['null', 'integer']},
                    'moderator': {'type': ['null', 'boolean']},
                    'name': {'type': ['null', 'string']},
                    'notes': {'type': ['null', 'string']},
                    'only_private_comments': {'type': ['null', 'boolean']},
                    'organization_id': {'type': ['null', 'integer']},
                    'permanently_deleted': {'type': ['null', 'boolean']},
                    'phone': {'type': ['null', 'string']},
                    'photo': {'properties': {'content_type': {'type': ['null',
                                                                       'string']},
                                             'content_url': {'type': ['null',
                                                                      'string']},
                                             'file_name': {'type': ['null',
                                                                    'string']},
                                             'height': {'type': ['null',
                                                                 'integer']},
                                             'id': {'type': ['null',
                                                             'integer']},
                                             'inline': {'type': ['null',
                                                                 'boolean']},
                                             'mapped_content_url': {'type': ['null',
                                                                             'string']},
                                             'size': {'type': ['null',
                                                               'integer']},
                                             'thumbnails': {'items': {'properties': {'content_type': {'type': ['null',
                                                                                                               'string']},
                                                                                     'content_url': {'type': ['null',
                                                                                                              'string']},
                                                                                     'file_name': {'type': ['null',
                                                                                                            'string']},
                                                                                     'height': {'type': ['null',
                                                                                                         'integer']},
                                                                                     'id': {'type': ['null',
                                                                                                     'integer']},
                                                                                     'inline': {'type': ['null',
                                                                                                         'boolean']},
                                                                                     'mapped_content_url': {'type': ['null',
                                                                                                                     'string']},
                                                                                     'size': {'type': ['null',
                                                                                                       'integer']},
                                                                                     'url': {'type': ['null',
                                                                                                      'string']},
                                                                                     'width': {'type': ['null',
                                                                                                        'integer']}},
                                                                      'type': ['null',
                                                                               'object']},
                                                            'type': ['null',
                                                                     'array']},
                                             'url': {'type': ['null',
                                                              'string']},
                                             'width': {'type': ['null',
                                                                'integer']}},
                              'type': ['null', 'object']},
                    'report_csv': {'type': ['null', 'boolean']},
                    'restricted_agent': {'type': ['null', 'boolean']},
                    'role': {'type': ['null', 'string']},
                    'role_type': {'type': ['null', 'integer']},
                    'shared': {'type': ['null', 'boolean']},
                    'shared_agent': {'type': ['null', 'boolean']},
                    'shared_phone_number': {'type': ['null', 'boolean']},
                    'signature': {'type': ['null', 'string']},
                    'suspended': {'type': ['null', 'boolean']},
                    'tags': {'items': {'type': ['null', 'string']},
                             'type': ['null', 'array']},
                    'ticket_restriction': {'type': ['null', 'string']},
                    'time_zone': {'type': ['null', 'string']},
                    'two_factor_auth_enabled': {'type': ['null',
                                                         'boolean']},
                    'updated_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'url': {'type': ['null', 'string']},
                    'user_fields': {'additionalProperties': True,
                                    'properties': {},
                                    'type': ['null', 'object']},
                    'verified': {'type': ['null', 'boolean']}},
     'type': ['null', 'object']}

On instance:
    {'active': True,
     'alias': None,
     'created_at': '2022-12-29T04:22:54Z',
     'custom_role_id': None,
     'default_group_id': None,
     'details': None,
     'email': 'integration-test+jason_bowen@airbyte.io',
     'external_id': None,
     'iana_time_zone': 'Pacific/Noumea',
     'id': 6126921294607,
     'last_login_at': None,
     'locale': 'en-US',
     'locale_id': 1,
     'moderator': False,
     'name': 'Jason_Bowen',
     'notes': None,
     'only_private_comments': False,
     'organization_id': None,
     'phone': None,
     'photo': None,
     'report_csv': False,
     'restricted_agent': True,
     'role': 'end-user',
     'role_type': None,
     'shared': False,
     'shared_agent': False,
     'shared_phone_number': None,
     'signature': None,
     'suspended': False,
     'tags': [],
     'ticket_restriction': 'requested',
     'time_zone': 'Pacific/Noumea',
     'two_factor_auth_enabled': False,
     'updated_at': '2022-12-29T04:22:54Z',
     'url': 'https://d3v-airbyte.zendesk.com/api/v2/users/6126921294607.json',
     'user_fields': {},
     'verified': False}
ERROR    root:test_core.py:662 
The ticket_forms stream has the following schema errors:
Additional properties are not allowed ('agent_conditions', 'end_user_conditions' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'active': {'type': ['null', 'boolean']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'default': {'type': ['null', 'boolean']},
                    'display_name': {'type': ['null', 'string']},
                    'end_user_visible': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'in_all_brands': {'type': ['null', 'boolean']},
                    'name': {'type': ['null', 'string']},
                    'position': {'type': ['null', 'integer']},
                    'raw_display_name': {'type': ['null', 'string']},
                    'raw_name': {'type': ['null', 'string']},
                    'restricted_brand_ids': {'items': {'type': ['null',
                                                                'integer']},
                                             'type': ['null', 'array']},
                    'ticket_field_ids': {'items': {'type': ['null',
                                                            'integer']},
                                         'type': ['null', 'array']},
                    'updated_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'url': {'type': ['null', 'string']}},
     'type': ['null', 'object']}

On instance:
    {'active': True,
     'agent_conditions': [],
     'created_at': '2020-12-11T18:34:37Z',
     'default': True,
     'display_name': 'Default Ticket Form',
     'end_user_conditions': [],
     'end_user_visible': True,
     'id': 360000084116,
     'in_all_brands': True,
     'name': 'Default Ticket Form',
     'position': 1,
     'raw_display_name': 'Default Ticket Form',
     'raw_name': 'Default Ticket Form',
     'restricted_brand_ids': [],
     'ticket_field_ids': [360002833076,
                          360002833096,
                          360002833116,
                          360002833136,
                          360002833156,
                          360002833176,
                          360002833196],
     'updated_at': '2020-12-11T18:34:37Z',
     'url': 'https://d3v-airbyte.zendesk.com/api/v2/ticket_forms/360000084116.json'}
=========================== short test summary info ============================
FAILED ../../test_input/test_core.py::TestBasicRead::test_read[inputs0] - Fai...
============ 1 failed, 1 passed, 45 deselected in 563.91s (0:09:23) ============
