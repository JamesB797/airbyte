../../../../connectors/source-orb/acceptance-test-config.yml
/Users/ella/airbytehq/airbyte/airbyte-integrations/connectors/source-orb
============================= test session starts ==============================
platform linux -- Python 3.9.11, pytest-6.2.5, py-1.11.0, pluggy-1.0.0
rootdir: /test_input
plugins: timeout-1.4.2, hypothesis-6.54.6, requests-mock-1.9.3, cov-3.0.0, sugar-0.9.6, mock-3.6.1
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
collected 37 items / 35 deselected / 2 selected

../../test_input/test_core.py F                                          [ 50%]
../../test_input/test_incremental.py .                                   [100%]


=================================== FAILURES ===================================
_______________________ TestBasicRead.test_read[inputs0] _______________________

self = <connector_acceptance_test.tests.test_core.TestBasicRead object at 0xffff8d2da940>
connector_config = SecretDict(******)
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='customers', json_schema={'$schema...cremental'>, cursor_field=None, destination_sync_mode=<DestinationSyncMode.overwrite: 'overwrite'>, primary_key=None)])
expect_records_config = None, should_validate_schema = True
should_validate_data_points = False, should_fail_on_extra_columns = True
empty_streams = set(), ignored_fields = {}, expected_records_by_stream = {}
docker_runner = <connector_acceptance_test.utils.connector_runner.ConnectorRunner object at 0xffff8d2f2b80>
detailed_logger = <Logger detailed_logger /test_input/acceptance_tests_logs/test_core.py__TestBasicRead__test_read[inputs0].txt (DEBUG)>

    def test_read(
        self,
        connector_config,
        configured_catalog,
        expect_records_config: ExpectedRecordsConfig,
        should_validate_schema: Boolean,
        should_validate_data_points: Boolean,
        should_fail_on_extra_columns: Boolean,
        empty_streams: Set[EmptyStreamConfiguration],
        ignored_fields: Optional[Mapping[str, List[IgnoredFieldsConfiguration]]],
        expected_records_by_stream: MutableMapping[str, List[MutableMapping]],
        docker_runner: ConnectorRunner,
        detailed_logger,
    ):
        output = docker_runner.call_read(connector_config, configured_catalog)
        records = [message.record for message in filter_output(output, Type.RECORD)]
    
        assert records, "At least one record should be read using provided catalog"
    
        if should_validate_schema:  # TODO Conditional logic
>           self._validate_schema(
                records=records, configured_catalog=configured_catalog, fail_on_extra_columns=should_fail_on_extra_columns
            )

connector_acceptance_test/tests/test_core.py:823: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

records = [AirbyteRecordMessage(namespace=None, stream='customers', data={'auto_collection': False, 'balance': '0.00', 'billing_...iFfZech', 'billable_metric_name': 'API Requests', 'billable_metric_id': 'AgSn9ncZGHycAesH'}, emitted_at=1679408094834)]
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='customers', json_schema={'$schema...cremental'>, cursor_field=None, destination_sync_mode=<DestinationSyncMode.overwrite: 'overwrite'>, primary_key=None)])
fail_on_extra_columns = True

    @staticmethod
    def _validate_schema(records: List[AirbyteRecordMessage], configured_catalog: ConfiguredAirbyteCatalog, fail_on_extra_columns: Boolean):
        """
        Check if data type and structure in records matches the one in json_schema of the stream in catalog
        """
        TestBasicRead._validate_records_structure(records, configured_catalog)
        bar = "-" * 80
        streams_errors = verify_records_schema(records, configured_catalog, fail_on_extra_columns)
        for stream_name, errors in streams_errors.items():
            errors = map(str, errors.values())
            str_errors = f"\n{bar}\n".join(errors)
            logging.error(f"\nThe {stream_name} stream has the following schema errors:\n{str_errors}")
    
        if streams_errors:
>           pytest.fail(f"Please check your json_schema in selected streams {tuple(streams_errors.keys())}.")
E           Failed: Please check your json_schema in selected streams ('customers', 'subscriptions', 'plans', 'credits_ledger_entries', 'subscription_usage').

connector_acceptance_test/tests/test_core.py:665: Failed
---------------------------- Captured stdout setup -----------------------------
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
------------------------------ Captured log setup ------------------------------
WARNING  root:config.py:282 The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format.
----------------------------- Captured stdout call -----------------------------
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe customers stream has the following schema errors:\nAdditional properties are not allowed ('tax_id', 'auto_collection', 'currency', 'balance' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'billing_address': {'properties': {'city': {'type': ['null',\n                                                                         'string']},\n                                                       'country': {'type': ['null',\n                                                                            'string']},\n                                                       'line1': {'type': ['null',\n                                                                          'string']},\n                                                       'line2': {'type': ['null',\n                                                                          'string']},\n                                                       'postal_code': {'type': ['null',\n                                                                                'string']},\n                                                       'state': {'type': ['null',\n                                                                          'string']}},\n                                        'type': ['null', 'object']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'email': {'type': ['string', 'null']},\n                    'external_customer_id': {'type': ['string', 'null']},\n                    'id': {'type': 'string'},\n                    'name': {'type': 'string'},\n                    'payment_provider': {'type': ['null', 'string']},\n                    'payment_provider_id': {'type': ['null', 'string']},\n                    'shipping_address': {'properties': {'city': {'type': ['null',\n                                                                          'string']},\n                                                        'country': {'type': ['null',\n                                                                             'string']},\n                                                        'line1': {'type': ['null',\n                                                                           'string']},\n                                                        'line2': {'type': ['null',\n                                                                           'string']},\n                                                        'postal_code': {'type': ['null',\n                                                                                 'string']},\n                                                        'state': {'type': ['null',\n                                                                           'string']}},\n                                         'type': ['null', 'object']},\n                    'timezone': {'type': ['null', 'string']}},\n     'required': ['id', 'created_at'],\n     'type': ['null', 'object']}\n\nOn instance:\n    {'auto_collection': False,\n     'balance': '0.00',\n     'billing_address': None,\n     'created_at': '2023-02-02T10:01:15+00:00',\n     'currency': 'USD',\n     'email': 'sample@withorb.com',\n     'external_customer_id': 'acme',\n     'id': 'mL9kTuTcN5xQ2HiC',\n     'name': 'Acme, Inc.',\n     'payment_provider': None,\n     'payment_provider_id': None,\n     'shipping_address': None,\n     'tax_id': None,\n     'timezone': 'Etc/UTC'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe subscriptions stream has the following schema errors:\nAdditional properties are not allowed ('default_invoice_memo', 'active_plan_phase_order', 'current_billing_period_start_date', 'auto_collection', 'net_terms', 'billing_cycle_day', 'trial_info', 'current_billing_period_end_date', 'redeemed_coupon', 'fixed_fee_quantity_schedule', 'metadata' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'customer_id': {'type': 'string'},\n                    'end_date': {'format': 'date-time',\n                                 'type': ['null', 'string']},\n                    'external_customer_id': {'type': ['null', 'string']},\n                    'id': {'type': 'string'},\n                    'plan_id': {'type': 'string'},\n                    'start_date': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'status': {'type': 'string'}},\n     'required': ['id', 'created_at', 'status'],\n     'type': ['null', 'object']}\n\nOn instance:\n    {'active_plan_phase_order': None,\n     'auto_collection': False,\n     'billing_cycle_day': 1,\n     'created_at': '2023-02-02T10:04:09+00:00',\n     'current_billing_period_end_date': '2023-04-01T00:00:00+00:00',\n     'current_billing_period_start_date': '2023-03-01T00:00:00+00:00',\n     'customer_id': 'mL9kTuTcN5xQ2HiC',\n     'default_invoice_memo': '',\n     'end_date': None,\n     'external_customer_id': 'acme',\n     'fixed_fee_quantity_schedule': [],\n     'id': 'FDWRvxuBUiFfZech',\n     'metadata': {},\n     'net_terms': 0,\n     'plan_id': 'WfRkAcGd3ggtnPHf',\n     'redeemed_coupon': None,\n     'start_date': '2023-02-02T00:00:00+00:00',\n     'status': 'active',\n     'trial_info': {'end_date': None}}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe plans stream has the following schema errors:\nAdditional properties are not allowed ('currency', 'base_plan', 'default_invoice_memo', 'invoicing_currency', 'minimum', 'minimum_amount', 'net_terms', 'trial_config', 'plan_phases', 'external_plan_id', 'discount', 'base_plan_id' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'description': {'type': ['null', 'string']},\n                    'id': {'type': 'string'},\n                    'name': {'type': ['null', 'string']},\n                    'prices': {'items': {'properties': {'id': {'type': 'string'}},\n                                         'type': 'object'},\n                               'type': ['array']},\n                    'product': {'properties': {'id': {'type': 'string'}},\n                                'type': 'object'}},\n     'required': ['id', 'created_at'],\n     'type': ['null', 'object']}\n\nOn instance:\n    {'base_plan': None,\n     'base_plan_id': None,\n     'created_at': '2023-02-02T10:03:57+00:00',\n     'currency': 'USD',\n     'default_invoice_memo': '',\n     'description': '',\n     'discount': None,\n     'external_plan_id': None,\n     'id': 'WfRkAcGd3ggtnPHf',\n     'invoicing_currency': 'USD',\n     'minimum': None,\n     'minimum_amount': None,\n     'name': 'Usage Testing Plan',\n     'net_terms': 0,\n     'plan_phases': [],\n     'prices': [{'billable_metric': {'id': 'AgSn9ncZGHycAesH'},\n                 'cadence': 'monthly',\n                 'created_at': '2023-02-02T10:03:57+00:00',\n                 'currency': 'USD',\n                 'discount': None,\n                 'fixed_price_quantity': None,\n                 'id': 'XyvXETnQvZCWupVS',\n                 'minimum': None,\n                 'minimum_amount': None,\n                 'model_type': 'unit',\n                 'name': 'API Requests',\n                 'plan_phase_order': None,\n                 'price_type': 'usage_price',\n                 'unit_config': {'unit_amount': '5.00'}}],\n     'product': {'created_at': '2022-02-01T01:00:01+00:00',\n                 'id': '2utSwvuE2gdSsDmD',\n                 'name': 'integration-product'},\n     'trial_config': {'trial_period': None, 'trial_period_unit': 'days'}}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe credits_ledger_entries stream has the following schema errors:\nAdditional properties are not allowed ('ledger_sequence_number', 'metadata', 'entry_status' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'amount': {'type': ['null', 'number']},\n                    'block_expiry_date': {'format': 'date-time',\n                                          'type': ['null', 'string']},\n                    'created_at': {'format': 'date-time',\n                                   'type': ['null', 'string']},\n                    'credit_block_id': {'type': ['null', 'string']},\n                    'credit_block_per_unit_cost_basis': {'type': ['null',\n                                                                  'string']},\n                    'customer_id': {'type': 'string'},\n                    'description': {'type': ['null', 'string']},\n                    'ending_balance': {'type': 'number'},\n                    'entry_type': {'type': 'string'},\n                    'event': {'properties': {'id': {'type': 'string'},\n                                             'properties': {'properties': {},\n                                                            'type': ['null',\n                                                                     'object']}},\n                              'required': ['id'],\n                              'type': ['null', 'object']},\n                    'id': {'type': 'string'},\n                    'new_block_expiry_date': {'format': 'date-time',\n                                              'type': ['null', 'string']},\n                    'starting_balance': {'type': 'number'}},\n     'required': ['id',\n                  'starting_balance',\n                  'ending_balance',\n                  'amount',\n                  'created_at',\n                  'customer_id',\n                  'entry_type',\n                  'credit_block_per_unit_cost_basis',\n                  'description',\n                  'credit_block_id'],\n     'type': ['null', 'object']}\n\nOn instance:\n    {'amount': 50.0,\n     'block_expiry_date': None,\n     'created_at': '2023-02-03T18:59:01+00:00',\n     'credit_block_id': '2sJVsedDsJt4imiQ',\n     'credit_block_per_unit_cost_basis': '0.00',\n     'customer_id': 'hHQF5BT5jtyj9r7V',\n     'description': None,\n     'ending_balance': 100.0,\n     'entry_status': 'committed',\n     'entry_type': 'increment',\n     'id': 'PCXpBQmGZCBG9LDW',\n     'ledger_sequence_number': 6,\n     'metadata': {},\n     'starting_balance': 50.0}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe subscription_usage stream has the following schema errors:\nAdditional properties are not allowed ('view_mode' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'billable_metric_id': {'type': 'string'},\n                    'billable_metric_name': {'type': 'string'},\n                    'quantity': {'type': 'number'},\n                    'subscription_id': {'type': 'string'},\n                    'timeframe_end': {'format': 'date-time',\n                                      'type': 'string'},\n                    'timeframe_start': {'format': 'date-time',\n                                        'type': 'string'}},\n     'required': ['quantity',\n                  'timeframe_start',\n                  'timeframe_end',\n                  'billable_metric_name',\n                  'billable_metric_id',\n                  'subscription_id'],\n     'type': ['null', 'object']}\n\nOn instance:\n    {'billable_metric_id': 'AgSn9ncZGHycAesH',\n     'billable_metric_name': 'API Requests',\n     'quantity': 10.0,\n     'subscription_id': 'FDWRvxuBUiFfZech',\n     'timeframe_end': '2023-02-03T00:00:00+00:00',\n     'timeframe_start': '2023-02-02T00:00:00+00:00',\n     'view_mode': 'periodic'}"}}
------------------------------ Captured log call -------------------------------
ERROR    root:test_core.py:662 
The customers stream has the following schema errors:
Additional properties are not allowed ('tax_id', 'auto_collection', 'currency', 'balance' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'billing_address': {'properties': {'city': {'type': ['null',
                                                                         'string']},
                                                       'country': {'type': ['null',
                                                                            'string']},
                                                       'line1': {'type': ['null',
                                                                          'string']},
                                                       'line2': {'type': ['null',
                                                                          'string']},
                                                       'postal_code': {'type': ['null',
                                                                                'string']},
                                                       'state': {'type': ['null',
                                                                          'string']}},
                                        'type': ['null', 'object']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'email': {'type': ['string', 'null']},
                    'external_customer_id': {'type': ['string', 'null']},
                    'id': {'type': 'string'},
                    'name': {'type': 'string'},
                    'payment_provider': {'type': ['null', 'string']},
                    'payment_provider_id': {'type': ['null', 'string']},
                    'shipping_address': {'properties': {'city': {'type': ['null',
                                                                          'string']},
                                                        'country': {'type': ['null',
                                                                             'string']},
                                                        'line1': {'type': ['null',
                                                                           'string']},
                                                        'line2': {'type': ['null',
                                                                           'string']},
                                                        'postal_code': {'type': ['null',
                                                                                 'string']},
                                                        'state': {'type': ['null',
                                                                           'string']}},
                                         'type': ['null', 'object']},
                    'timezone': {'type': ['null', 'string']}},
     'required': ['id', 'created_at'],
     'type': ['null', 'object']}

On instance:
    {'auto_collection': False,
     'balance': '0.00',
     'billing_address': None,
     'created_at': '2023-02-02T10:01:15+00:00',
     'currency': 'USD',
     'email': 'sample@withorb.com',
     'external_customer_id': 'acme',
     'id': 'mL9kTuTcN5xQ2HiC',
     'name': 'Acme, Inc.',
     'payment_provider': None,
     'payment_provider_id': None,
     'shipping_address': None,
     'tax_id': None,
     'timezone': 'Etc/UTC'}
ERROR    root:test_core.py:662 
The subscriptions stream has the following schema errors:
Additional properties are not allowed ('default_invoice_memo', 'active_plan_phase_order', 'current_billing_period_start_date', 'auto_collection', 'net_terms', 'billing_cycle_day', 'trial_info', 'current_billing_period_end_date', 'redeemed_coupon', 'fixed_fee_quantity_schedule', 'metadata' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'customer_id': {'type': 'string'},
                    'end_date': {'format': 'date-time',
                                 'type': ['null', 'string']},
                    'external_customer_id': {'type': ['null', 'string']},
                    'id': {'type': 'string'},
                    'plan_id': {'type': 'string'},
                    'start_date': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'status': {'type': 'string'}},
     'required': ['id', 'created_at', 'status'],
     'type': ['null', 'object']}

On instance:
    {'active_plan_phase_order': None,
     'auto_collection': False,
     'billing_cycle_day': 1,
     'created_at': '2023-02-02T10:04:09+00:00',
     'current_billing_period_end_date': '2023-04-01T00:00:00+00:00',
     'current_billing_period_start_date': '2023-03-01T00:00:00+00:00',
     'customer_id': 'mL9kTuTcN5xQ2HiC',
     'default_invoice_memo': '',
     'end_date': None,
     'external_customer_id': 'acme',
     'fixed_fee_quantity_schedule': [],
     'id': 'FDWRvxuBUiFfZech',
     'metadata': {},
     'net_terms': 0,
     'plan_id': 'WfRkAcGd3ggtnPHf',
     'redeemed_coupon': None,
     'start_date': '2023-02-02T00:00:00+00:00',
     'status': 'active',
     'trial_info': {'end_date': None}}
ERROR    root:test_core.py:662 
The plans stream has the following schema errors:
Additional properties are not allowed ('currency', 'base_plan', 'default_invoice_memo', 'invoicing_currency', 'minimum', 'minimum_amount', 'net_terms', 'trial_config', 'plan_phases', 'external_plan_id', 'discount', 'base_plan_id' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'description': {'type': ['null', 'string']},
                    'id': {'type': 'string'},
                    'name': {'type': ['null', 'string']},
                    'prices': {'items': {'properties': {'id': {'type': 'string'}},
                                         'type': 'object'},
                               'type': ['array']},
                    'product': {'properties': {'id': {'type': 'string'}},
                                'type': 'object'}},
     'required': ['id', 'created_at'],
     'type': ['null', 'object']}

On instance:
    {'base_plan': None,
     'base_plan_id': None,
     'created_at': '2023-02-02T10:03:57+00:00',
     'currency': 'USD',
     'default_invoice_memo': '',
     'description': '',
     'discount': None,
     'external_plan_id': None,
     'id': 'WfRkAcGd3ggtnPHf',
     'invoicing_currency': 'USD',
     'minimum': None,
     'minimum_amount': None,
     'name': 'Usage Testing Plan',
     'net_terms': 0,
     'plan_phases': [],
     'prices': [{'billable_metric': {'id': 'AgSn9ncZGHycAesH'},
                 'cadence': 'monthly',
                 'created_at': '2023-02-02T10:03:57+00:00',
                 'currency': 'USD',
                 'discount': None,
                 'fixed_price_quantity': None,
                 'id': 'XyvXETnQvZCWupVS',
                 'minimum': None,
                 'minimum_amount': None,
                 'model_type': 'unit',
                 'name': 'API Requests',
                 'plan_phase_order': None,
                 'price_type': 'usage_price',
                 'unit_config': {'unit_amount': '5.00'}}],
     'product': {'created_at': '2022-02-01T01:00:01+00:00',
                 'id': '2utSwvuE2gdSsDmD',
                 'name': 'integration-product'},
     'trial_config': {'trial_period': None, 'trial_period_unit': 'days'}}
ERROR    root:test_core.py:662 
The credits_ledger_entries stream has the following schema errors:
Additional properties are not allowed ('ledger_sequence_number', 'metadata', 'entry_status' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'amount': {'type': ['null', 'number']},
                    'block_expiry_date': {'format': 'date-time',
                                          'type': ['null', 'string']},
                    'created_at': {'format': 'date-time',
                                   'type': ['null', 'string']},
                    'credit_block_id': {'type': ['null', 'string']},
                    'credit_block_per_unit_cost_basis': {'type': ['null',
                                                                  'string']},
                    'customer_id': {'type': 'string'},
                    'description': {'type': ['null', 'string']},
                    'ending_balance': {'type': 'number'},
                    'entry_type': {'type': 'string'},
                    'event': {'properties': {'id': {'type': 'string'},
                                             'properties': {'properties': {},
                                                            'type': ['null',
                                                                     'object']}},
                              'required': ['id'],
                              'type': ['null', 'object']},
                    'id': {'type': 'string'},
                    'new_block_expiry_date': {'format': 'date-time',
                                              'type': ['null', 'string']},
                    'starting_balance': {'type': 'number'}},
     'required': ['id',
                  'starting_balance',
                  'ending_balance',
                  'amount',
                  'created_at',
                  'customer_id',
                  'entry_type',
                  'credit_block_per_unit_cost_basis',
                  'description',
                  'credit_block_id'],
     'type': ['null', 'object']}

On instance:
    {'amount': 50.0,
     'block_expiry_date': None,
     'created_at': '2023-02-03T18:59:01+00:00',
     'credit_block_id': '2sJVsedDsJt4imiQ',
     'credit_block_per_unit_cost_basis': '0.00',
     'customer_id': 'hHQF5BT5jtyj9r7V',
     'description': None,
     'ending_balance': 100.0,
     'entry_status': 'committed',
     'entry_type': 'increment',
     'id': 'PCXpBQmGZCBG9LDW',
     'ledger_sequence_number': 6,
     'metadata': {},
     'starting_balance': 50.0}
ERROR    root:test_core.py:662 
The subscription_usage stream has the following schema errors:
Additional properties are not allowed ('view_mode' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'billable_metric_id': {'type': 'string'},
                    'billable_metric_name': {'type': 'string'},
                    'quantity': {'type': 'number'},
                    'subscription_id': {'type': 'string'},
                    'timeframe_end': {'format': 'date-time',
                                      'type': 'string'},
                    'timeframe_start': {'format': 'date-time',
                                        'type': 'string'}},
     'required': ['quantity',
                  'timeframe_start',
                  'timeframe_end',
                  'billable_metric_name',
                  'billable_metric_id',
                  'subscription_id'],
     'type': ['null', 'object']}

On instance:
    {'billable_metric_id': 'AgSn9ncZGHycAesH',
     'billable_metric_name': 'API Requests',
     'quantity': 10.0,
     'subscription_id': 'FDWRvxuBUiFfZech',
     'timeframe_end': '2023-02-03T00:00:00+00:00',
     'timeframe_start': '2023-02-02T00:00:00+00:00',
     'view_mode': 'periodic'}
=============================== warnings summary ===============================
connector_acceptance_test/config.py:282: 36 warnings
test_core.py: 1 warning
  /airbyte/connector_acceptance_test/connector_acceptance_test/config.py:282: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
    logging.warn("The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format.")

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED ../../test_input/test_core.py::TestBasicRead::test_read[inputs0] - Fai...
===== 1 failed, 1 passed, 35 deselected, 37 warnings in 988.36s (0:16:28) ======
