../../../../connectors/source-pipedrive/acceptance-test-config.yml
/Users/ella/airbytehq/airbyte/airbyte-integrations/connectors/source-pipedrive
============================= test session starts ==============================
platform linux -- Python 3.9.11, pytest-6.2.5, py-1.11.0, pluggy-1.0.0
rootdir: /test_input
plugins: timeout-1.4.2, hypothesis-6.54.6, requests-mock-1.9.3, cov-3.0.0, sugar-0.9.6, mock-3.6.1
collected 38 items / 36 deselected / 2 selected

../../test_input/test_core.py F                                          [ 50%]
../../test_input/test_incremental.py .                                   [100%]


=================================== FAILURES ===================================
_______________________ TestBasicRead.test_read[inputs0] _______________________

self = <connector_acceptance_test.tests.test_core.TestBasicRead object at 0xffffae2073a0>
connector_config = SecretDict(******)
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='activities', json_schema={'$schem...esh'>, cursor_field=['modified'], destination_sync_mode=<DestinationSyncMode.append: 'append'>, primary_key=[['id']])])
expect_records_config = ExpectedRecordsConfig(bypass_reason=None, path=PosixPath('integration_tests/expected_records.jsonl'), extra_fields=False, exact_order=False, extra_records=True)
should_validate_schema = True, should_validate_data_points = False
should_fail_on_extra_columns = True, empty_streams = set()
ignored_fields = {'users': [IgnoredFieldsConfiguration(name='modified', bypass_reason='constantly increasing date-time field'), IgnoredFieldsConfiguration(name='last_login', bypass_reason='constantly increasing date-time field')]}
expected_records_by_stream = defaultdict(<class 'list'>, {'activities': [{'id': 1, 'company_id': 7780468, 'user_id': 11884360, 'done': False, 'type...edit': '2023-02-22 10:30:01', 'comments': None, 'tax': 0.01, 'quantity_formatted': '120', 'sum_formatted': '$2,400'}]})
docker_runner = <connector_acceptance_test.utils.connector_runner.ConnectorRunner object at 0xffffada3fd60>
detailed_logger = <Logger detailed_logger /test_input/acceptance_tests_logs/test_core.py__TestBasicRead__test_read[inputs0].txt (DEBUG)>

    def test_read(
        self,
        connector_config,
        configured_catalog,
        expect_records_config: ExpectedRecordsConfig,
        should_validate_schema: Boolean,
        should_validate_data_points: Boolean,
        should_fail_on_extra_columns: Boolean,
        empty_streams: Set[EmptyStreamConfiguration],
        ignored_fields: Optional[Mapping[str, List[IgnoredFieldsConfiguration]]],
        expected_records_by_stream: MutableMapping[str, List[MutableMapping]],
        docker_runner: ConnectorRunner,
        detailed_logger,
    ):
        output = docker_runner.call_read(connector_config, configured_catalog)
        records = [message.record for message in filter_output(output, Type.RECORD)]
    
        assert records, "At least one record should be read using provided catalog"
    
        if should_validate_schema:  # TODO Conditional logic
>           self._validate_schema(
                records=records, configured_catalog=configured_catalog, fail_on_extra_columns=should_fail_on_extra_columns
            )

connector_acceptance_test/tests/test_core.py:823: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

records = [AirbyteRecordMessage(namespace=None, stream='activities', data={'id': 1, 'company_id': 7780468, 'user_id': 11884360, ...ropbox_bcc': None, 'assigned_to_user_id': 11884360, 'type_name': 'Call', 'lead': None}, emitted_at=1679408428909), ...]
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='activities', json_schema={'$schem...esh'>, cursor_field=['modified'], destination_sync_mode=<DestinationSyncMode.append: 'append'>, primary_key=[['id']])])
fail_on_extra_columns = True

    @staticmethod
    def _validate_schema(records: List[AirbyteRecordMessage], configured_catalog: ConfiguredAirbyteCatalog, fail_on_extra_columns: Boolean):
        """
        Check if data type and structure in records matches the one in json_schema of the stream in catalog
        """
        TestBasicRead._validate_records_structure(records, configured_catalog)
        bar = "-" * 80
        streams_errors = verify_records_schema(records, configured_catalog, fail_on_extra_columns)
        for stream_name, errors in streams_errors.items():
            errors = map(str, errors.values())
            str_errors = f"\n{bar}\n".join(errors)
            logging.error(f"\nThe {stream_name} stream has the following schema errors:\n{str_errors}")
    
        if streams_errors:
>           pytest.fail(f"Please check your json_schema in selected streams {tuple(streams_errors.keys())}.")
E           Failed: Please check your json_schema in selected streams ('activities', 'activity_fields', 'deals', 'deal_fields', 'leads', 'organizations', 'organization_fields', 'persons', 'person_fields', 'products').

connector_acceptance_test/tests/test_core.py:665: Failed
----------------------------- Captured stdout call -----------------------------
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe activities stream has the following schema errors:\nAdditional properties are not allowed ('original_start_time', 'lead_title', 'lead', 'is_recurring' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'add_time': {'type': ['null', 'string']},\n                    'assigned_to_user_id': {'type': ['null', 'integer']},\n                    'attendees': {'items': {'properties': {'email_address': {'type': ['null',\n                                                                                      'string']},\n                                                           'is_organizer': {'type': ['null',\n                                                                                     'integer']},\n                                                           'name': {'type': ['null',\n                                                                             'string']},\n                                                           'person_id': {'type': ['null',\n                                                                                  'integer']},\n                                                           'status': {'type': ['null',\n                                                                               'string']},\n                                                           'user_id': {'type': ['null',\n                                                                                'integer']}},\n                                            'type': ['null', 'object']},\n                                  'type': ['null', 'array']},\n                    'busy_flag': {'type': ['null', 'boolean']},\n                    'calendar_sync_include_context': {'type': ['null',\n                                                               'boolean']},\n                    'company_id': {'type': ['null', 'integer']},\n                    'conference_meeting_client': {'type': ['null',\n                                                           'string']},\n                    'conference_meeting_id': {'type': ['null', 'string']},\n                    'conference_meeting_url': {'type': ['null', 'string']},\n                    'created_by_user_id': {'type': ['null', 'integer']},\n                    'deal_dropbox_bcc': {'type': ['null', 'string']},\n                    'deal_id': {'type': ['null', 'integer']},\n                    'deal_title': {'type': ['null', 'string']},\n                    'done': {'type': ['null', 'boolean']},\n                    'due_date': {'type': ['null', 'string']},\n                    'due_time': {'type': ['null', 'string']},\n                    'duration': {'type': ['null', 'string']},\n                    'file': {'properties': {'clean_name': {'type': ['null',\n                                                                    'string']},\n                                            'id': {'type': ['null',\n                                                            'string']},\n                                            'url': {'type': ['null',\n                                                             'string']}},\n                             'type': ['null', 'object']},\n                    'gcal_event_id': {'type': ['null', 'string']},\n                    'google_calendar_etag': {'type': ['null', 'string']},\n                    'google_calendar_id': {'type': ['null', 'string']},\n                    'id': {'type': ['null', 'integer']},\n                    'last_notification_time': {'type': ['null', 'string']},\n                    'last_notification_user_id': {'type': ['null',\n                                                           'integer']},\n                    'lead_id': {'type': ['null', 'string']},\n                    'location': {'type': ['null', 'string']},\n                    'location_admin_area_level_1': {'type': ['null',\n                                                             'string']},\n                    'location_admin_area_level_2': {'type': ['null',\n                                                             'string']},\n                    'location_country': {'type': ['null', 'string']},\n                    'location_formatted_address': {'type': ['null',\n                                                            'string']},\n                    'location_lat': {'type': ['null', 'number']},\n                    'location_locality': {'type': ['null', 'string']},\n                    'location_long': {'type': ['null', 'number']},\n                    'location_postal_code': {'type': ['null', 'string']},\n                    'location_route': {'type': ['null', 'string']},\n                    'location_street_number': {'type': ['null', 'string']},\n                    'location_sublocality': {'type': ['null', 'string']},\n                    'location_subpremise': {'type': ['null', 'string']},\n                    'marked_as_done_time': {'type': ['null', 'string']},\n                    'note': {'type': ['null', 'string']},\n                    'notification_language_id': {'type': ['null',\n                                                          'integer']},\n                    'org_id': {'type': ['null', 'integer']},\n                    'org_name': {'type': ['null', 'string']},\n                    'owner_name': {'type': ['null', 'string']},\n                    'participants': {'items': {'properties': {'person_id': {'type': ['null',\n                                                                                     'integer']},\n                                                              'primary_flag': {'type': ['null',\n                                                                                        'boolean']}},\n                                               'type': ['null', 'object']},\n                                     'type': ['null', 'array']},\n                    'person_dropbox_bcc': {'type': ['null', 'string']},\n                    'person_id': {'type': ['null', 'integer']},\n                    'person_name': {'type': ['null', 'string']},\n                    'public_description': {'type': ['null', 'string']},\n                    'rec_master_activity_id': {'type': ['null', 'integer']},\n                    'rec_rule': {'type': ['null', 'string']},\n                    'rec_rule_extension': {'type': ['null', 'string']},\n                    'reference_id': {'type': ['null', 'integer']},\n                    'reference_type': {'type': ['null', 'string']},\n                    'series': {'type': ['null', 'string']},\n                    'source_timezone': {'type': ['null', 'string']},\n                    'subject': {'type': ['null', 'string']},\n                    'type': {'type': ['null', 'string']},\n                    'type_name': {'type': ['null', 'string']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']},\n                    'update_user_id': {'type': ['null', 'integer']},\n                    'user_id': {'type': ['null', 'integer']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'add_time': '2023-02-22 12:01:14',\n     'assigned_to_user_id': 11884360,\n     'attendees': None,\n     'busy_flag': False,\n     'calendar_sync_include_context': None,\n     'company_id': 7780468,\n     'conference_meeting_client': None,\n     'conference_meeting_id': None,\n     'conference_meeting_url': None,\n     'created_by_user_id': 11884360,\n     'deal_dropbox_bcc': 'airbyte-sandbox+deal12@pipedrivemail.com',\n     'deal_id': 12,\n     'deal_title': 'Test Organization 2 deal',\n     'done': False,\n     'due_date': '2023-02-22',\n     'due_time': '',\n     'duration': '',\n     'id': 36,\n     'is_recurring': None,\n     'last_notification_time': None,\n     'last_notification_user_id': None,\n     'lead': None,\n     'lead_id': None,\n     'lead_title': None,\n     'location': None,\n     'location_admin_area_level_1': None,\n     'location_admin_area_level_2': None,\n     'location_country': None,\n     'location_formatted_address': None,\n     'location_locality': None,\n     'location_postal_code': None,\n     'location_route': None,\n     'location_street_number': None,\n     'location_sublocality': None,\n     'location_subpremise': None,\n     'marked_as_done_time': '',\n     'note': None,\n     'notification_language_id': None,\n     'org_id': 2,\n     'org_name': 'Test Organization 2',\n     'original_start_time': None,\n     'owner_name': 'Team Airbyte',\n     'participants': [{'person_id': 11, 'primary_flag': True}],\n     'person_dropbox_bcc': 'airbyte-sandbox@pipedrivemail.com',\n     'person_id': 11,\n     'person_name': 'User10 Sample',\n     'public_description': '',\n     'rec_master_activity_id': None,\n     'rec_rule': None,\n     'rec_rule_extension': None,\n     'reference_id': None,\n     'reference_type': None,\n     'series': None,\n     'source_timezone': None,\n     'subject': 'Call',\n     'type': 'call',\n     'type_name': 'Call',\n     'update_time': '2023-02-22 12:01:14',\n     'update_user_id': None,\n     'user_id': 11884360}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe activity_fields stream has the following schema errors:\nAdditional properties are not allowed ('json_column_flag' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'add_time': {'type': ['null', 'string']},\n                    'add_visible_flag': {'type': ['null', 'boolean']},\n                    'bulk_edit_allowed': {'type': ['null', 'boolean']},\n                    'details_visible_flag': {'type': ['null', 'boolean']},\n                    'edit_flag': {'type': ['null', 'boolean']},\n                    'field_type': {'type': ['null', 'string']},\n                    'filtering_allowed': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'important_flag': {'type': ['null', 'boolean']},\n                    'index_visible_flag': {'type': ['null', 'boolean']},\n                    'key': {'type': ['null', 'string']},\n                    'last_updated_by_user_id': {'type': ['null',\n                                                         'integer']},\n                    'mandatory_flag': {'type': ['null', 'boolean']},\n                    'name': {'type': ['null', 'string']},\n                    'options': {'items': {'properties': {'id': {'type': ['null',\n                                                                         'integer',\n                                                                         'string',\n                                                                         'boolean']},\n                                                         'label': {'type': ['null',\n                                                                            'string']}},\n                                          'type': ['null', 'object']},\n                                'type': ['null', 'array']},\n                    'order_nr': {'type': ['null', 'integer']},\n                    'searchable_flag': {'type': ['null', 'boolean']},\n                    'sortable_flag': {'type': ['null', 'boolean']},\n                    'update_time': {'type': ['null', 'string']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'add_time': '2020-12-10 07:23:48',\n     'add_visible_flag': True,\n     'bulk_edit_allowed': False,\n     'details_visible_flag': True,\n     'edit_flag': False,\n     'field_type': 'lead',\n     'filtering_allowed': True,\n     'id': 21,\n     'important_flag': False,\n     'index_visible_flag': True,\n     'json_column_flag': False,\n     'key': 'lead_id',\n     'last_updated_by_user_id': None,\n     'mandatory_flag': False,\n     'name': 'Lead',\n     'order_nr': 21,\n     'searchable_flag': False,\n     'sortable_flag': True,\n     'update_time': '2020-12-10 07:23:48'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe deals stream has the following schema errors:\nAdditional properties are not allowed ('3ce5b1409718d65a8adc965be1f0da8821d8b9ab', '41505adc22569bf93214dd7f7eaa10eaa387947d', 'renewal_type', 'eae9c2a5b618934581aebed0747cc33cd681379e', 'befdcfc4f54b8410b8d9105ba6d44658fd5965b9', 'bed1d9f4cfdaf761fab04b38df20144b0fd156d6', '26da5bd3c09d3a700b15c23fb2f33a0b798c9d66' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active': {'type': ['null', 'boolean']},\n                    'activities_count': {'type': ['null', 'integer']},\n                    'add_time': {'type': ['null', 'string']},\n                    'cc_email': {'type': ['null', 'string']},\n                    'close_time': {'type': ['null', 'string']},\n                    'creator_user_id': {'type': ['null', 'integer']},\n                    'currency': {'type': ['null', 'string']},\n                    'deleted': {'type': ['null', 'boolean']},\n                    'done_activities_count': {'type': ['null', 'integer']},\n                    'email_messages_count': {'type': ['null', 'integer']},\n                    'expected_close_date': {'format': 'date',\n                                            'type': ['null', 'string']},\n                    'files_count': {'type': ['null', 'integer']},\n                    'first_won_time': {'type': ['null', 'string']},\n                    'followers_count': {'type': ['null', 'integer']},\n                    'formatted_value': {'type': ['null', 'string']},\n                    'formatted_weighted_value': {'type': ['null',\n                                                          'string']},\n                    'id': {'type': ['null', 'integer']},\n                    'label': {'type': ['null', 'string']},\n                    'last_activity_date': {'format': 'date',\n                                           'type': ['null', 'string']},\n                    'last_activity_id': {'type': ['null', 'integer']},\n                    'last_incoming_mail_time': {'type': ['null', 'string']},\n                    'last_outgoing_mail_time': {'type': ['null', 'string']},\n                    'lost_reason': {'type': ['null', 'string']},\n                    'lost_time': {'type': ['null', 'string']},\n                    'next_activity_date': {'format': 'date',\n                                           'type': ['null', 'string']},\n                    'next_activity_duration': {'type': ['null', 'string']},\n                    'next_activity_id': {'type': ['null', 'integer']},\n                    'next_activity_note': {'type': ['null', 'string']},\n                    'next_activity_subject': {'type': ['null', 'string']},\n                    'next_activity_time': {'type': ['null', 'string']},\n                    'next_activity_type': {'type': ['null', 'string']},\n                    'notes_count': {'type': ['null', 'integer']},\n                    'org_hidden': {'type': ['null', 'boolean']},\n                    'org_id': {'type': ['null', 'integer']},\n                    'org_name': {'type': ['null', 'string']},\n                    'owner_name': {'type': ['null', 'string']},\n                    'participants_count': {'type': ['null', 'integer']},\n                    'person_hidden': {'type': ['null', 'boolean']},\n                    'person_id': {'type': ['null', 'integer']},\n                    'person_name': {'type': ['null', 'string']},\n                    'pipeline_id': {'type': ['null', 'integer']},\n                    'probability': {'type': ['null', 'number']},\n                    'products_count': {'type': ['null', 'integer']},\n                    'rotten_time': {'type': ['null', 'string']},\n                    'stage_change_time': {'type': ['null', 'string']},\n                    'stage_id': {'type': ['null', 'integer']},\n                    'stage_order_nr': {'type': ['null', 'integer']},\n                    'status': {'type': ['null', 'string']},\n                    'title': {'type': ['null', 'string']},\n                    'undone_activities_count': {'type': ['null',\n                                                         'integer']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']},\n                    'user_id': {'type': ['null', 'integer']},\n                    'value': {'type': ['null', 'number']},\n                    'visible_to': {'type': ['null', 'string']},\n                    'weighted_value': {'type': ['null', 'number']},\n                    'weighted_value_currency': {'type': ['null', 'string']},\n                    'won_time': {'type': ['null', 'string']}},\n     'type': 'object'}\n\nOn instance:\n    {'26da5bd3c09d3a700b15c23fb2f33a0b798c9d66': None,\n     '3ce5b1409718d65a8adc965be1f0da8821d8b9ab': None,\n     '41505adc22569bf93214dd7f7eaa10eaa387947d': None,\n     'active': True,\n     'activities_count': 3,\n     'add_time': '2023-02-22 08:31:13',\n     'bed1d9f4cfdaf761fab04b38df20144b0fd156d6': None,\n     'befdcfc4f54b8410b8d9105ba6d44658fd5965b9': None,\n     'cc_email': 'airbyte-sandbox+deal12@pipedrivemail.com',\n     'close_time': None,\n     'creator_user_id': 11884360,\n     'currency': 'USD',\n     'deleted': False,\n     'done_activities_count': 2,\n     'eae9c2a5b618934581aebed0747cc33cd681379e': None,\n     'email_messages_count': 0,\n     'expected_close_date': '2023-05-31',\n     'files_count': 0,\n     'first_won_time': None,\n     'followers_count': 1,\n     'formatted_value': '$55,400',\n     'formatted_weighted_value': '$55,400',\n     'id': 12,\n     'label': None,\n     'last_activity_date': '2023-02-22',\n     'last_activity_id': 6,\n     'last_incoming_mail_time': None,\n     'last_outgoing_mail_time': None,\n     'lost_reason': None,\n     'lost_time': None,\n     'next_activity_date': '2023-02-22',\n     'next_activity_duration': None,\n     'next_activity_id': 36,\n     'next_activity_note': None,\n     'next_activity_subject': 'Call',\n     'next_activity_time': None,\n     'next_activity_type': 'call',\n     'notes_count': 0,\n     'org_hidden': False,\n     'org_id': 2,\n     'org_name': 'Test Organization 2',\n     'owner_name': 'Team Airbyte',\n     'participants_count': 1,\n     'person_hidden': False,\n     'person_id': 11,\n     'person_name': 'User10 Sample',\n     'pipeline_id': 1,\n     'probability': None,\n     'products_count': 1845,\n     'renewal_type': 'one_time',\n     'rotten_time': None,\n     'stage_change_time': None,\n     'stage_id': 1,\n     'stage_order_nr': 0,\n     'status': 'open',\n     'title': 'Test Organization 2 deal',\n     'undone_activities_count': 1,\n     'update_time': '2023-02-22 12:01:14',\n     'user_id': 11884360,\n     'value': 55400,\n     'visible_to': '3',\n     'weighted_value': 55400,\n     'weighted_value_currency': 'USD',\n     'won_time': None}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe deal_fields stream has the following schema errors:\nAdditional properties are not allowed ('json_column_flag', 'show_in_pipelines', 'projects_detail_visible_flag' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'add_time': {'type': ['null', 'string']},\n                    'add_visible_flag': {'type': ['null', 'boolean']},\n                    'bulk_edit_allowed': {'type': ['null', 'boolean']},\n                    'details_visible_flag': {'type': ['null', 'boolean']},\n                    'edit_flag': {'type': ['null', 'boolean']},\n                    'field_type': {'type': ['null', 'string']},\n                    'filtering_allowed': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'important_flag': {'type': ['null', 'boolean']},\n                    'index_visible_flag': {'type': ['null', 'boolean']},\n                    'key': {'type': ['null', 'string']},\n                    'last_updated_by_user_id': {'type': ['null',\n                                                         'integer']},\n                    'mandatory_flag': {'type': ['null',\n                                                'string',\n                                                'boolean',\n                                                'object']},\n                    'name': {'type': ['null', 'string']},\n                    'options': {'items': {'properties': {'id': {'type': ['null',\n                                                                         'string',\n                                                                         'integer']},\n                                                         'label': {'type': ['null',\n                                                                            'string']}},\n                                          'type': ['null', 'object']},\n                                'type': ['null', 'array']},\n                    'order_nr': {'type': ['null', 'integer']},\n                    'searchable_flag': {'type': ['null', 'boolean']},\n                    'sortable_flag': {'type': ['null', 'boolean']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'add_time': '2023-02-22 11:04:43',\n     'add_visible_flag': True,\n     'bulk_edit_allowed': True,\n     'details_visible_flag': True,\n     'edit_flag': True,\n     'field_type': 'varchar',\n     'filtering_allowed': True,\n     'id': 12490,\n     'important_flag': True,\n     'json_column_flag': True,\n     'key': '41505adc22569bf93214dd7f7eaa10eaa387947d',\n     'last_updated_by_user_id': 11884360,\n     'mandatory_flag': False,\n     'name': 'Test field 5',\n     'order_nr': 6,\n     'projects_detail_visible_flag': False,\n     'searchable_flag': True,\n     'show_in_pipelines': {'show_in_all': True},\n     'sortable_flag': True,\n     'update_time': '2023-02-22 11:04:43'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe leads stream has the following schema errors:\nAdditional properties are not allowed ('cc_email', 'visible_to' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'add_time': {'type': ['null', 'string']},\n                    'creator_id': {'type': ['null', 'integer']},\n                    'expected_close_date': {'format': 'date',\n                                            'type': ['null', 'string']},\n                    'id': {'type': ['null', 'string']},\n                    'is_archived': {'type': ['null', 'boolean']},\n                    'label_ids': {'type': ['null', 'array']},\n                    'next_activity_id': {'type': ['null', 'integer']},\n                    'organization_id': {'type': ['null', 'integer']},\n                    'owner_id': {'type': ['null', 'integer']},\n                    'person_id': {'type': ['null', 'integer']},\n                    'source_name': {'type': ['null', 'string']},\n                    'title': {'type': ['null', 'string']},\n                    'update_time': {'type': ['null', 'string']},\n                    'value': {'properties': {'amount': {'type': ['null',\n                                                                 'integer']},\n                                             'currency': {'type': ['null',\n                                                                   'string']}},\n                              'type': ['null', 'object']},\n                    'was_seen': {'type': ['null', 'boolean']}},\n     'type': 'object'}\n\nOn instance:\n    {'add_time': '2023-02-22T10:28:07.034Z',\n     'cc_email': 'airbyte-sandbox+7780468+leadjRQpyqdX44BtBmrNTCuTdA@pipedrivemail.com',\n     'creator_id': 11884360,\n     'expected_close_date': '2023-05-30',\n     'id': '98b9c5a0-b29b-11ed-83b4-fd61bd275e86',\n     'is_archived': False,\n     'label_ids': ['aecece60-c069-11eb-93bf-b59c4f1731e6'],\n     'next_activity_id': 32,\n     'organization_id': 10,\n     'owner_id': 11884360,\n     'person_id': 11,\n     'source_name': 'Manually created',\n     'title': 'Test Organization 10 lead',\n     'update_time': '2023-02-22T11:49:24.853Z',\n     'value': {'amount': 2000, 'currency': 'USD'},\n     'visible_to': '3',\n     'was_seen': True}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe organizations stream has the following schema errors:\nAdditional properties are not allowed ('delete_time', 'category_id' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'activities_count': {'type': ['null', 'number']},\n                    'add_time': {'type': ['null', 'string']},\n                    'address': {'type': ['null', 'string']},\n                    'address_admin_area_level_1': {'type': ['null',\n                                                            'string']},\n                    'address_admin_area_level_2': {'type': ['null',\n                                                            'string']},\n                    'address_country': {'type': ['null', 'string']},\n                    'address_formatted_address': {'type': ['null',\n                                                           'string']},\n                    'address_locality': {'type': ['null', 'string']},\n                    'address_postal_code': {'type': ['null', 'string']},\n                    'address_route': {'type': ['null', 'string']},\n                    'address_street_number': {'type': ['null', 'string']},\n                    'address_sublocality': {'type': ['null', 'string']},\n                    'address_subpremise': {'type': ['null', 'string']},\n                    'cc_email': {'type': ['null', 'string']},\n                    'closed_deals_count': {'type': ['null', 'number']},\n                    'company_id': {'type': ['null', 'number']},\n                    'country_code': {'type': ['null', 'string']},\n                    'done_activities_count': {'type': ['null', 'number']},\n                    'email_messages_count': {'type': ['null', 'number']},\n                    'files_count': {'type': ['null', 'number']},\n                    'first_char': {'type': ['null', 'string']},\n                    'followers_count': {'type': ['null', 'number']},\n                    'id': {'type': ['null', 'number']},\n                    'label': {'type': ['null', 'number']},\n                    'last_activity_date': {'type': ['null', 'string']},\n                    'last_activity_id': {'type': ['null', 'number']},\n                    'lost_deals_count': {'type': ['null', 'number']},\n                    'name': {'type': ['null', 'string']},\n                    'next_activity_date': {'type': ['null', 'string']},\n                    'next_activity_id': {'type': ['null', 'number']},\n                    'next_activity_time': {'type': ['null', 'string']},\n                    'notes_count': {'type': ['null', 'number']},\n                    'open_deals_count': {'type': ['null', 'number']},\n                    'owner_id': {'properties': {'active_flag': {'type': ['null',\n                                                                         'boolean']},\n                                                'email': {'type': ['null',\n                                                                   'string']},\n                                                'has_pic': {'type': ['null',\n                                                                     'number']},\n                                                'id': {'type': ['null',\n                                                                'number']},\n                                                'name': {'type': ['null',\n                                                                  'string']},\n                                                'pic_hash': {'type': ['null',\n                                                                      'string']},\n                                                'value': {'type': ['null',\n                                                                   'number']}},\n                                 'type': ['null', 'object', 'number']},\n                    'owner_name': {'type': ['null', 'string']},\n                    'people_count': {'type': ['null', 'number']},\n                    'picture_id': {'properties': {'active_flag': {'type': ['null',\n                                                                           'boolean']},\n                                                  'add_time': {'type': ['null',\n                                                                        'string']},\n                                                  'added_by_user_id': {'type': ['null',\n                                                                                'number']},\n                                                  'item_id': {'type': ['null',\n                                                                       'number']},\n                                                  'item_type': {'type': ['null',\n                                                                         'string']},\n                                                  'pictures': {'properties': {'128': {'type': ['null',\n                                                                                               'string']},\n                                                                              '512': {'type': ['null',\n                                                                                               'string']}},\n                                                               'type': ['null',\n                                                                        'object']},\n                                                  'update_time': {'type': ['null',\n                                                                           'string']},\n                                                  'value': {'type': ['null',\n                                                                     'number']}},\n                                   'type': ['null', 'object']},\n                    'related_closed_deals_count': {'type': ['null',\n                                                            'number']},\n                    'related_lost_deals_count': {'type': ['null',\n                                                          'number']},\n                    'related_open_deals_count': {'type': ['null',\n                                                          'number']},\n                    'related_won_deals_count': {'type': ['null', 'number']},\n                    'undone_activities_count': {'type': ['null', 'number']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']},\n                    'visible_to': {'type': ['null', 'number', 'string']},\n                    'won_deals_count': {'type': ['null', 'number']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'active_flag': True,\n     'activities_count': 11,\n     'add_time': '2021-07-06 13:20:52',\n     'address': 'Boston, MA, USA',\n     'address_admin_area_level_1': 'Massachusetts',\n     'address_admin_area_level_2': 'Suffolk County',\n     'address_country': 'United States',\n     'address_formatted_address': 'Boston, MA, USA',\n     'address_locality': 'Boston',\n     'address_postal_code': '',\n     'address_route': '',\n     'address_street_number': '',\n     'address_sublocality': '',\n     'address_subpremise': '',\n     'category_id': None,\n     'cc_email': 'airbyte-sandbox@pipedrivemail.com',\n     'closed_deals_count': 9,\n     'company_id': 7780468,\n     'country_code': None,\n     'delete_time': None,\n     'done_activities_count': 6,\n     'email_messages_count': 0,\n     'files_count': 1,\n     'first_char': 't',\n     'followers_count': 1,\n     'id': 1,\n     'label': 5,\n     'last_activity_date': '2023-02-22',\n     'last_activity_id': 20,\n     'lost_deals_count': 2,\n     'name': 'Test Organization1',\n     'next_activity_date': '2021-07-06',\n     'next_activity_id': 1,\n     'next_activity_time': None,\n     'notes_count': 3,\n     'open_deals_count': 4,\n     'owner_id': 11884360,\n     'owner_name': 'Team Airbyte',\n     'people_count': 3,\n     'picture_id': None,\n     'related_closed_deals_count': 0,\n     'related_lost_deals_count': 0,\n     'related_open_deals_count': 0,\n     'related_won_deals_count': 0,\n     'undone_activities_count': 5,\n     'update_time': '2023-03-06 18:24:05',\n     'visible_to': '3',\n     'won_deals_count': 7}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe organization_fields stream has the following schema errors:\nAdditional properties are not allowed ('json_column_flag', 'id_suffix', 'parent_id', 'is_subfield' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'add_time': {'type': ['null', 'string']},\n                    'add_visible_flag': {'type': ['null', 'boolean']},\n                    'bulk_edit_allowed': {'type': ['null', 'boolean']},\n                    'details_visible_flag': {'type': ['null', 'boolean']},\n                    'edit_flag': {'type': ['null', 'boolean']},\n                    'field_type': {'type': ['null', 'string']},\n                    'filtering_allowed': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'important_flag': {'type': ['null', 'boolean']},\n                    'index_visible_flag': {'type': ['null', 'boolean']},\n                    'key': {'type': ['null', 'string']},\n                    'last_updated_by_user_id': {'type': ['null',\n                                                         'integer']},\n                    'mandatory_flag': {'type': ['null', 'boolean']},\n                    'name': {'type': ['null', 'string']},\n                    'options': {'items': {'properties': {'id': {'type': ['null',\n                                                                         'integer',\n                                                                         'string',\n                                                                         'boolean']},\n                                                         'label': {'type': ['null',\n                                                                            'string']}},\n                                          'type': ['null', 'object']},\n                                'type': ['null', 'array']},\n                    'order_nr': {'type': ['null', 'integer']},\n                    'searchable_flag': {'type': ['null', 'boolean']},\n                    'sortable_flag': {'type': ['null', 'boolean']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'edit_flag': False,\n     'field_type': 'varchar',\n     'id': 0,\n     'id_suffix': 'formatted_address',\n     'is_subfield': True,\n     'json_column_flag': False,\n     'key': 'address_formatted_address',\n     'mandatory_flag': True,\n     'name': 'Full/combined address',\n     'parent_id': 4021}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe persons stream has the following schema errors:\nAdditional properties are not allowed ('picture_128_url', 'delete_time' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'activities_count': {'type': ['null', 'integer']},\n                    'add_time': {'type': ['null', 'string']},\n                    'cc_email': {'type': ['null', 'string']},\n                    'closed_deals_count': {'type': ['null', 'integer']},\n                    'company_id': {'type': ['null', 'integer']},\n                    'done_activities_count': {'type': ['null', 'integer']},\n                    'email': {'items': {'properties': {'label': {'type': ['null',\n                                                                          'string']},\n                                                       'primary': {'type': ['null',\n                                                                            'boolean']},\n                                                       'value': {'type': ['null',\n                                                                          'string']}},\n                                        'type': ['null', 'object']},\n                              'type': ['null', 'array']},\n                    'email_messages_count': {'type': ['null', 'integer']},\n                    'files_count': {'type': ['null', 'integer']},\n                    'first_char': {'type': ['null', 'string']},\n                    'first_name': {'type': ['null', 'string']},\n                    'followers_count': {'type': ['null', 'integer']},\n                    'id': {'type': ['null', 'integer']},\n                    'label': {'type': ['null', 'integer']},\n                    'last_activity_date': {'type': ['null', 'string']},\n                    'last_activity_id': {'type': ['null', 'integer']},\n                    'last_incoming_mail_time': {'type': ['null', 'string']},\n                    'last_name': {'type': ['null', 'string']},\n                    'last_outgoing_mail_time': {'type': ['null', 'string']},\n                    'lost_deals_count': {'type': ['null', 'integer']},\n                    'name': {'type': ['null', 'string']},\n                    'next_activity_date': {'format': 'date',\n                                           'type': ['null', 'string']},\n                    'next_activity_id': {'type': ['null', 'integer']},\n                    'next_activity_time': {'format': 'time',\n                                           'type': ['null', 'string']},\n                    'notes_count': {'type': ['null', 'integer']},\n                    'open_deals_count': {'type': ['null', 'integer']},\n                    'org_id': {'type': ['null', 'integer']},\n                    'org_name': {'type': ['null', 'string']},\n                    'owner_id': {'type': ['null', 'integer']},\n                    'owner_name': {'type': ['null', 'string']},\n                    'participant_closed_deals_count': {'type': ['null',\n                                                                'integer']},\n                    'participant_open_deals_count': {'type': ['null',\n                                                              'integer']},\n                    'phone': {'items': {'properties': {'label': {'type': ['null',\n                                                                          'string']},\n                                                       'primary': {'type': ['null',\n                                                                            'boolean']},\n                                                       'value': {'type': ['null',\n                                                                          'string']}},\n                                        'type': ['null', 'object']},\n                              'type': ['null', 'array']},\n                    'picture_id': {'properties': {'active_flag': {'type': ['null',\n                                                                           'boolean']},\n                                                  'add_time': {'type': ['null',\n                                                                        'string']},\n                                                  'added_by_user_id': {'type': ['null',\n                                                                                'integer']},\n                                                  'item_id': {'type': ['null',\n                                                                       'integer']},\n                                                  'item_type': {'type': ['null',\n                                                                         'string']},\n                                                  'pictures': {'properties': {'128': {'type': ['null',\n                                                                                               'string']},\n                                                                              '512': {'type': ['null',\n                                                                                               'string']}},\n                                                               'type': ['null',\n                                                                        'object']},\n                                                  'update_time': {'type': ['null',\n                                                                           'string']},\n                                                  'value': {'type': ['null',\n                                                                     'integer']}},\n                                   'type': ['null', 'object']},\n                    'related_closed_deals_count': {'type': ['null',\n                                                            'integer']},\n                    'related_lost_deals_count': {'type': ['null',\n                                                          'integer']},\n                    'related_open_deals_count': {'type': ['null',\n                                                          'integer']},\n                    'related_won_deals_count': {'type': ['null',\n                                                         'integer']},\n                    'undone_activities_count': {'type': ['null',\n                                                         'integer']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']},\n                    'visible_to': {'type': ['null', 'string']},\n                    'won_deals_count': {'type': ['null', 'integer']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'activities_count': 5,\n     'add_time': '2023-02-22 08:31:12',\n     'cc_email': 'airbyte-sandbox@pipedrivemail.com',\n     'closed_deals_count': 0,\n     'company_id': 7780468,\n     'delete_time': None,\n     'done_activities_count': 2,\n     'email': [{'label': 'work',\n                'primary': True,\n                'value': 'user10.sample.airbyte@outlook.com'}],\n     'email_messages_count': 0,\n     'files_count': 0,\n     'first_char': 'u',\n     'first_name': 'User10',\n     'followers_count': 1,\n     'id': 11,\n     'label': 1,\n     'last_activity_date': '2023-02-22',\n     'last_activity_id': 6,\n     'last_incoming_mail_time': None,\n     'last_name': 'Sample',\n     'last_outgoing_mail_time': None,\n     'lost_deals_count': 0,\n     'name': 'User10 Sample',\n     'next_activity_date': '2023-02-22',\n     'next_activity_id': 36,\n     'next_activity_time': None,\n     'notes_count': 0,\n     'open_deals_count': 3,\n     'org_id': 10,\n     'org_name': 'Test Organization 10',\n     'owner_id': 11884360,\n     'owner_name': 'Team Airbyte',\n     'participant_closed_deals_count': 0,\n     'participant_open_deals_count': 0,\n     'phone': [{'label': 'work', 'primary': True, 'value': '+17786665544'}],\n     'picture_128_url': None,\n     'picture_id': None,\n     'related_closed_deals_count': 0,\n     'related_lost_deals_count': 0,\n     'related_open_deals_count': 0,\n     'related_won_deals_count': 0,\n     'undone_activities_count': 3,\n     'update_time': '2023-02-22 12:01:14',\n     'visible_to': '3',\n     'won_deals_count': 0}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe person_fields stream has the following schema errors:\nAdditional properties are not allowed ('json_column_flag' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'add_time': {'type': ['null', 'string']},\n                    'add_visible_flag': {'type': ['null', 'boolean']},\n                    'bulk_edit_allowed': {'type': ['null', 'boolean']},\n                    'details_visible_flag': {'type': ['null', 'boolean']},\n                    'edit_flag': {'type': ['null', 'boolean']},\n                    'field_type': {'type': ['null', 'string']},\n                    'filtering_allowed': {'type': ['null', 'boolean']},\n                    'id': {'type': ['null', 'integer']},\n                    'important_flag': {'type': ['null', 'boolean']},\n                    'index_visible_flag': {'type': ['null', 'boolean']},\n                    'key': {'type': ['null', 'string']},\n                    'last_updated_by_user_id': {'type': ['null',\n                                                         'integer']},\n                    'mandatory_flag': {'type': ['null', 'boolean']},\n                    'name': {'type': ['null', 'string']},\n                    'options': {'items': {'properties': {'id': {'type': ['null',\n                                                                         'integer',\n                                                                         'string',\n                                                                         'boolean']},\n                                                         'label': {'type': ['null',\n                                                                            'string']}},\n                                          'type': ['null', 'object']},\n                                'type': ['null', 'array']},\n                    'order_nr': {'type': ['null', 'integer']},\n                    'searchable_flag': {'type': ['null', 'boolean']},\n                    'sortable_flag': {'type': ['null', 'boolean']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'add_time': '2020-12-10 07:23:48',\n     'add_visible_flag': False,\n     'bulk_edit_allowed': False,\n     'details_visible_flag': False,\n     'edit_flag': False,\n     'field_type': 'date',\n     'filtering_allowed': True,\n     'id': 9061,\n     'important_flag': False,\n     'index_visible_flag': True,\n     'json_column_flag': False,\n     'key': 'last_outgoing_mail_time',\n     'last_updated_by_user_id': None,\n     'mandatory_flag': True,\n     'name': 'Last email sent',\n     'order_nr': 23,\n     'searchable_flag': False,\n     'sortable_flag': True,\n     'update_time': '2020-12-10 07:23:48'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe products stream has the following schema errors:\nAdditional properties are not allowed ('product_variations' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/schema#',\n     'additionalProperties': False,\n     'properties': {'active_flag': {'type': ['null', 'boolean']},\n                    'add_time': {'type': ['null', 'string']},\n                    'category': {'type': ['null', 'string']},\n                    'code': {'type': ['null', 'string']},\n                    'description': {'type': ['null', 'string']},\n                    'files_count': {'type': ['null', 'integer']},\n                    'first_char': {'type': ['null', 'string']},\n                    'followers_count': {'type': ['null', 'integer']},\n                    'id': {'type': ['null', 'integer']},\n                    'name': {'type': ['null', 'string']},\n                    'owner_id': {'type': ['null', 'integer']},\n                    'owner_name': {'type': ['null', 'string']},\n                    'prices': {'items': {'properties': {'cost': {'type': ['null',\n                                                                          'integer']},\n                                                        'currency': {'type': ['null',\n                                                                              'string']},\n                                                        'id': {'type': ['null',\n                                                                        'integer']},\n                                                        'overhead_cost': {'type': ['null',\n                                                                                   'integer']},\n                                                        'price': {'type': ['null',\n                                                                           'integer']},\n                                                        'product_id': {'type': ['null',\n                                                                                'integer']}},\n                                         'type': 'object'},\n                               'type': 'array'},\n                    'selectable': {'type': ['null', 'boolean']},\n                    'tax': {'type': ['null', 'integer']},\n                    'unit': {'type': ['null', 'string']},\n                    'update_time': {'airbyte_type': 'timestamp_without_timezone',\n                                    'format': 'date-time',\n                                    'type': ['null', 'string']},\n                    'visible_to': {'type': ['null', 'string']}},\n     'type': 'object'}\n\nOn instance:\n    {'active_flag': True,\n     'add_time': '2023-02-22 08:31:21',\n     'category': None,\n     'code': None,\n     'description': None,\n     'files_count': None,\n     'first_char': 'i',\n     'followers_count': 0,\n     'id': 11,\n     'name': 'Item 10',\n     'owner_id': 11884360,\n     'owner_name': 'Team Airbyte',\n     'prices': [{'cost': 0,\n                 'currency': 'USD',\n                 'id': 11,\n                 'overhead_cost': None,\n                 'price': 0,\n                 'product_id': 11}],\n     'product_variations': [],\n     'selectable': True,\n     'tax': 0,\n     'unit': None,\n     'update_time': '2023-02-22 08:31:21',\n     'visible_to': '3'}"}}
------------------------------ Captured log call -------------------------------
ERROR    root:test_core.py:662 
The activities stream has the following schema errors:
Additional properties are not allowed ('original_start_time', 'lead_title', 'lead', 'is_recurring' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'add_time': {'type': ['null', 'string']},
                    'assigned_to_user_id': {'type': ['null', 'integer']},
                    'attendees': {'items': {'properties': {'email_address': {'type': ['null',
                                                                                      'string']},
                                                           'is_organizer': {'type': ['null',
                                                                                     'integer']},
                                                           'name': {'type': ['null',
                                                                             'string']},
                                                           'person_id': {'type': ['null',
                                                                                  'integer']},
                                                           'status': {'type': ['null',
                                                                               'string']},
                                                           'user_id': {'type': ['null',
                                                                                'integer']}},
                                            'type': ['null', 'object']},
                                  'type': ['null', 'array']},
                    'busy_flag': {'type': ['null', 'boolean']},
                    'calendar_sync_include_context': {'type': ['null',
                                                               'boolean']},
                    'company_id': {'type': ['null', 'integer']},
                    'conference_meeting_client': {'type': ['null',
                                                           'string']},
                    'conference_meeting_id': {'type': ['null', 'string']},
                    'conference_meeting_url': {'type': ['null', 'string']},
                    'created_by_user_id': {'type': ['null', 'integer']},
                    'deal_dropbox_bcc': {'type': ['null', 'string']},
                    'deal_id': {'type': ['null', 'integer']},
                    'deal_title': {'type': ['null', 'string']},
                    'done': {'type': ['null', 'boolean']},
                    'due_date': {'type': ['null', 'string']},
                    'due_time': {'type': ['null', 'string']},
                    'duration': {'type': ['null', 'string']},
                    'file': {'properties': {'clean_name': {'type': ['null',
                                                                    'string']},
                                            'id': {'type': ['null',
                                                            'string']},
                                            'url': {'type': ['null',
                                                             'string']}},
                             'type': ['null', 'object']},
                    'gcal_event_id': {'type': ['null', 'string']},
                    'google_calendar_etag': {'type': ['null', 'string']},
                    'google_calendar_id': {'type': ['null', 'string']},
                    'id': {'type': ['null', 'integer']},
                    'last_notification_time': {'type': ['null', 'string']},
                    'last_notification_user_id': {'type': ['null',
                                                           'integer']},
                    'lead_id': {'type': ['null', 'string']},
                    'location': {'type': ['null', 'string']},
                    'location_admin_area_level_1': {'type': ['null',
                                                             'string']},
                    'location_admin_area_level_2': {'type': ['null',
                                                             'string']},
                    'location_country': {'type': ['null', 'string']},
                    'location_formatted_address': {'type': ['null',
                                                            'string']},
                    'location_lat': {'type': ['null', 'number']},
                    'location_locality': {'type': ['null', 'string']},
                    'location_long': {'type': ['null', 'number']},
                    'location_postal_code': {'type': ['null', 'string']},
                    'location_route': {'type': ['null', 'string']},
                    'location_street_number': {'type': ['null', 'string']},
                    'location_sublocality': {'type': ['null', 'string']},
                    'location_subpremise': {'type': ['null', 'string']},
                    'marked_as_done_time': {'type': ['null', 'string']},
                    'note': {'type': ['null', 'string']},
                    'notification_language_id': {'type': ['null',
                                                          'integer']},
                    'org_id': {'type': ['null', 'integer']},
                    'org_name': {'type': ['null', 'string']},
                    'owner_name': {'type': ['null', 'string']},
                    'participants': {'items': {'properties': {'person_id': {'type': ['null',
                                                                                     'integer']},
                                                              'primary_flag': {'type': ['null',
                                                                                        'boolean']}},
                                               'type': ['null', 'object']},
                                     'type': ['null', 'array']},
                    'person_dropbox_bcc': {'type': ['null', 'string']},
                    'person_id': {'type': ['null', 'integer']},
                    'person_name': {'type': ['null', 'string']},
                    'public_description': {'type': ['null', 'string']},
                    'rec_master_activity_id': {'type': ['null', 'integer']},
                    'rec_rule': {'type': ['null', 'string']},
                    'rec_rule_extension': {'type': ['null', 'string']},
                    'reference_id': {'type': ['null', 'integer']},
                    'reference_type': {'type': ['null', 'string']},
                    'series': {'type': ['null', 'string']},
                    'source_timezone': {'type': ['null', 'string']},
                    'subject': {'type': ['null', 'string']},
                    'type': {'type': ['null', 'string']},
                    'type_name': {'type': ['null', 'string']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']},
                    'update_user_id': {'type': ['null', 'integer']},
                    'user_id': {'type': ['null', 'integer']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'add_time': '2023-02-22 12:01:14',
     'assigned_to_user_id': 11884360,
     'attendees': None,
     'busy_flag': False,
     'calendar_sync_include_context': None,
     'company_id': 7780468,
     'conference_meeting_client': None,
     'conference_meeting_id': None,
     'conference_meeting_url': None,
     'created_by_user_id': 11884360,
     'deal_dropbox_bcc': 'airbyte-sandbox+deal12@pipedrivemail.com',
     'deal_id': 12,
     'deal_title': 'Test Organization 2 deal',
     'done': False,
     'due_date': '2023-02-22',
     'due_time': '',
     'duration': '',
     'id': 36,
     'is_recurring': None,
     'last_notification_time': None,
     'last_notification_user_id': None,
     'lead': None,
     'lead_id': None,
     'lead_title': None,
     'location': None,
     'location_admin_area_level_1': None,
     'location_admin_area_level_2': None,
     'location_country': None,
     'location_formatted_address': None,
     'location_locality': None,
     'location_postal_code': None,
     'location_route': None,
     'location_street_number': None,
     'location_sublocality': None,
     'location_subpremise': None,
     'marked_as_done_time': '',
     'note': None,
     'notification_language_id': None,
     'org_id': 2,
     'org_name': 'Test Organization 2',
     'original_start_time': None,
     'owner_name': 'Team Airbyte',
     'participants': [{'person_id': 11, 'primary_flag': True}],
     'person_dropbox_bcc': 'airbyte-sandbox@pipedrivemail.com',
     'person_id': 11,
     'person_name': 'User10 Sample',
     'public_description': '',
     'rec_master_activity_id': None,
     'rec_rule': None,
     'rec_rule_extension': None,
     'reference_id': None,
     'reference_type': None,
     'series': None,
     'source_timezone': None,
     'subject': 'Call',
     'type': 'call',
     'type_name': 'Call',
     'update_time': '2023-02-22 12:01:14',
     'update_user_id': None,
     'user_id': 11884360}
ERROR    root:test_core.py:662 
The activity_fields stream has the following schema errors:
Additional properties are not allowed ('json_column_flag' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'add_time': {'type': ['null', 'string']},
                    'add_visible_flag': {'type': ['null', 'boolean']},
                    'bulk_edit_allowed': {'type': ['null', 'boolean']},
                    'details_visible_flag': {'type': ['null', 'boolean']},
                    'edit_flag': {'type': ['null', 'boolean']},
                    'field_type': {'type': ['null', 'string']},
                    'filtering_allowed': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'important_flag': {'type': ['null', 'boolean']},
                    'index_visible_flag': {'type': ['null', 'boolean']},
                    'key': {'type': ['null', 'string']},
                    'last_updated_by_user_id': {'type': ['null',
                                                         'integer']},
                    'mandatory_flag': {'type': ['null', 'boolean']},
                    'name': {'type': ['null', 'string']},
                    'options': {'items': {'properties': {'id': {'type': ['null',
                                                                         'integer',
                                                                         'string',
                                                                         'boolean']},
                                                         'label': {'type': ['null',
                                                                            'string']}},
                                          'type': ['null', 'object']},
                                'type': ['null', 'array']},
                    'order_nr': {'type': ['null', 'integer']},
                    'searchable_flag': {'type': ['null', 'boolean']},
                    'sortable_flag': {'type': ['null', 'boolean']},
                    'update_time': {'type': ['null', 'string']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'add_time': '2020-12-10 07:23:48',
     'add_visible_flag': True,
     'bulk_edit_allowed': False,
     'details_visible_flag': True,
     'edit_flag': False,
     'field_type': 'lead',
     'filtering_allowed': True,
     'id': 21,
     'important_flag': False,
     'index_visible_flag': True,
     'json_column_flag': False,
     'key': 'lead_id',
     'last_updated_by_user_id': None,
     'mandatory_flag': False,
     'name': 'Lead',
     'order_nr': 21,
     'searchable_flag': False,
     'sortable_flag': True,
     'update_time': '2020-12-10 07:23:48'}
ERROR    root:test_core.py:662 
The deals stream has the following schema errors:
Additional properties are not allowed ('3ce5b1409718d65a8adc965be1f0da8821d8b9ab', '41505adc22569bf93214dd7f7eaa10eaa387947d', 'renewal_type', 'eae9c2a5b618934581aebed0747cc33cd681379e', 'befdcfc4f54b8410b8d9105ba6d44658fd5965b9', 'bed1d9f4cfdaf761fab04b38df20144b0fd156d6', '26da5bd3c09d3a700b15c23fb2f33a0b798c9d66' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active': {'type': ['null', 'boolean']},
                    'activities_count': {'type': ['null', 'integer']},
                    'add_time': {'type': ['null', 'string']},
                    'cc_email': {'type': ['null', 'string']},
                    'close_time': {'type': ['null', 'string']},
                    'creator_user_id': {'type': ['null', 'integer']},
                    'currency': {'type': ['null', 'string']},
                    'deleted': {'type': ['null', 'boolean']},
                    'done_activities_count': {'type': ['null', 'integer']},
                    'email_messages_count': {'type': ['null', 'integer']},
                    'expected_close_date': {'format': 'date',
                                            'type': ['null', 'string']},
                    'files_count': {'type': ['null', 'integer']},
                    'first_won_time': {'type': ['null', 'string']},
                    'followers_count': {'type': ['null', 'integer']},
                    'formatted_value': {'type': ['null', 'string']},
                    'formatted_weighted_value': {'type': ['null',
                                                          'string']},
                    'id': {'type': ['null', 'integer']},
                    'label': {'type': ['null', 'string']},
                    'last_activity_date': {'format': 'date',
                                           'type': ['null', 'string']},
                    'last_activity_id': {'type': ['null', 'integer']},
                    'last_incoming_mail_time': {'type': ['null', 'string']},
                    'last_outgoing_mail_time': {'type': ['null', 'string']},
                    'lost_reason': {'type': ['null', 'string']},
                    'lost_time': {'type': ['null', 'string']},
                    'next_activity_date': {'format': 'date',
                                           'type': ['null', 'string']},
                    'next_activity_duration': {'type': ['null', 'string']},
                    'next_activity_id': {'type': ['null', 'integer']},
                    'next_activity_note': {'type': ['null', 'string']},
                    'next_activity_subject': {'type': ['null', 'string']},
                    'next_activity_time': {'type': ['null', 'string']},
                    'next_activity_type': {'type': ['null', 'string']},
                    'notes_count': {'type': ['null', 'integer']},
                    'org_hidden': {'type': ['null', 'boolean']},
                    'org_id': {'type': ['null', 'integer']},
                    'org_name': {'type': ['null', 'string']},
                    'owner_name': {'type': ['null', 'string']},
                    'participants_count': {'type': ['null', 'integer']},
                    'person_hidden': {'type': ['null', 'boolean']},
                    'person_id': {'type': ['null', 'integer']},
                    'person_name': {'type': ['null', 'string']},
                    'pipeline_id': {'type': ['null', 'integer']},
                    'probability': {'type': ['null', 'number']},
                    'products_count': {'type': ['null', 'integer']},
                    'rotten_time': {'type': ['null', 'string']},
                    'stage_change_time': {'type': ['null', 'string']},
                    'stage_id': {'type': ['null', 'integer']},
                    'stage_order_nr': {'type': ['null', 'integer']},
                    'status': {'type': ['null', 'string']},
                    'title': {'type': ['null', 'string']},
                    'undone_activities_count': {'type': ['null',
                                                         'integer']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']},
                    'user_id': {'type': ['null', 'integer']},
                    'value': {'type': ['null', 'number']},
                    'visible_to': {'type': ['null', 'string']},
                    'weighted_value': {'type': ['null', 'number']},
                    'weighted_value_currency': {'type': ['null', 'string']},
                    'won_time': {'type': ['null', 'string']}},
     'type': 'object'}

On instance:
    {'26da5bd3c09d3a700b15c23fb2f33a0b798c9d66': None,
     '3ce5b1409718d65a8adc965be1f0da8821d8b9ab': None,
     '41505adc22569bf93214dd7f7eaa10eaa387947d': None,
     'active': True,
     'activities_count': 3,
     'add_time': '2023-02-22 08:31:13',
     'bed1d9f4cfdaf761fab04b38df20144b0fd156d6': None,
     'befdcfc4f54b8410b8d9105ba6d44658fd5965b9': None,
     'cc_email': 'airbyte-sandbox+deal12@pipedrivemail.com',
     'close_time': None,
     'creator_user_id': 11884360,
     'currency': 'USD',
     'deleted': False,
     'done_activities_count': 2,
     'eae9c2a5b618934581aebed0747cc33cd681379e': None,
     'email_messages_count': 0,
     'expected_close_date': '2023-05-31',
     'files_count': 0,
     'first_won_time': None,
     'followers_count': 1,
     'formatted_value': '$55,400',
     'formatted_weighted_value': '$55,400',
     'id': 12,
     'label': None,
     'last_activity_date': '2023-02-22',
     'last_activity_id': 6,
     'last_incoming_mail_time': None,
     'last_outgoing_mail_time': None,
     'lost_reason': None,
     'lost_time': None,
     'next_activity_date': '2023-02-22',
     'next_activity_duration': None,
     'next_activity_id': 36,
     'next_activity_note': None,
     'next_activity_subject': 'Call',
     'next_activity_time': None,
     'next_activity_type': 'call',
     'notes_count': 0,
     'org_hidden': False,
     'org_id': 2,
     'org_name': 'Test Organization 2',
     'owner_name': 'Team Airbyte',
     'participants_count': 1,
     'person_hidden': False,
     'person_id': 11,
     'person_name': 'User10 Sample',
     'pipeline_id': 1,
     'probability': None,
     'products_count': 1845,
     'renewal_type': 'one_time',
     'rotten_time': None,
     'stage_change_time': None,
     'stage_id': 1,
     'stage_order_nr': 0,
     'status': 'open',
     'title': 'Test Organization 2 deal',
     'undone_activities_count': 1,
     'update_time': '2023-02-22 12:01:14',
     'user_id': 11884360,
     'value': 55400,
     'visible_to': '3',
     'weighted_value': 55400,
     'weighted_value_currency': 'USD',
     'won_time': None}
ERROR    root:test_core.py:662 
The deal_fields stream has the following schema errors:
Additional properties are not allowed ('json_column_flag', 'show_in_pipelines', 'projects_detail_visible_flag' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'add_time': {'type': ['null', 'string']},
                    'add_visible_flag': {'type': ['null', 'boolean']},
                    'bulk_edit_allowed': {'type': ['null', 'boolean']},
                    'details_visible_flag': {'type': ['null', 'boolean']},
                    'edit_flag': {'type': ['null', 'boolean']},
                    'field_type': {'type': ['null', 'string']},
                    'filtering_allowed': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'important_flag': {'type': ['null', 'boolean']},
                    'index_visible_flag': {'type': ['null', 'boolean']},
                    'key': {'type': ['null', 'string']},
                    'last_updated_by_user_id': {'type': ['null',
                                                         'integer']},
                    'mandatory_flag': {'type': ['null',
                                                'string',
                                                'boolean',
                                                'object']},
                    'name': {'type': ['null', 'string']},
                    'options': {'items': {'properties': {'id': {'type': ['null',
                                                                         'string',
                                                                         'integer']},
                                                         'label': {'type': ['null',
                                                                            'string']}},
                                          'type': ['null', 'object']},
                                'type': ['null', 'array']},
                    'order_nr': {'type': ['null', 'integer']},
                    'searchable_flag': {'type': ['null', 'boolean']},
                    'sortable_flag': {'type': ['null', 'boolean']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'add_time': '2023-02-22 11:04:43',
     'add_visible_flag': True,
     'bulk_edit_allowed': True,
     'details_visible_flag': True,
     'edit_flag': True,
     'field_type': 'varchar',
     'filtering_allowed': True,
     'id': 12490,
     'important_flag': True,
     'json_column_flag': True,
     'key': '41505adc22569bf93214dd7f7eaa10eaa387947d',
     'last_updated_by_user_id': 11884360,
     'mandatory_flag': False,
     'name': 'Test field 5',
     'order_nr': 6,
     'projects_detail_visible_flag': False,
     'searchable_flag': True,
     'show_in_pipelines': {'show_in_all': True},
     'sortable_flag': True,
     'update_time': '2023-02-22 11:04:43'}
ERROR    root:test_core.py:662 
The leads stream has the following schema errors:
Additional properties are not allowed ('cc_email', 'visible_to' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'add_time': {'type': ['null', 'string']},
                    'creator_id': {'type': ['null', 'integer']},
                    'expected_close_date': {'format': 'date',
                                            'type': ['null', 'string']},
                    'id': {'type': ['null', 'string']},
                    'is_archived': {'type': ['null', 'boolean']},
                    'label_ids': {'type': ['null', 'array']},
                    'next_activity_id': {'type': ['null', 'integer']},
                    'organization_id': {'type': ['null', 'integer']},
                    'owner_id': {'type': ['null', 'integer']},
                    'person_id': {'type': ['null', 'integer']},
                    'source_name': {'type': ['null', 'string']},
                    'title': {'type': ['null', 'string']},
                    'update_time': {'type': ['null', 'string']},
                    'value': {'properties': {'amount': {'type': ['null',
                                                                 'integer']},
                                             'currency': {'type': ['null',
                                                                   'string']}},
                              'type': ['null', 'object']},
                    'was_seen': {'type': ['null', 'boolean']}},
     'type': 'object'}

On instance:
    {'add_time': '2023-02-22T10:28:07.034Z',
     'cc_email': 'airbyte-sandbox+7780468+leadjRQpyqdX44BtBmrNTCuTdA@pipedrivemail.com',
     'creator_id': 11884360,
     'expected_close_date': '2023-05-30',
     'id': '98b9c5a0-b29b-11ed-83b4-fd61bd275e86',
     'is_archived': False,
     'label_ids': ['aecece60-c069-11eb-93bf-b59c4f1731e6'],
     'next_activity_id': 32,
     'organization_id': 10,
     'owner_id': 11884360,
     'person_id': 11,
     'source_name': 'Manually created',
     'title': 'Test Organization 10 lead',
     'update_time': '2023-02-22T11:49:24.853Z',
     'value': {'amount': 2000, 'currency': 'USD'},
     'visible_to': '3',
     'was_seen': True}
ERROR    root:test_core.py:662 
The organizations stream has the following schema errors:
Additional properties are not allowed ('delete_time', 'category_id' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'activities_count': {'type': ['null', 'number']},
                    'add_time': {'type': ['null', 'string']},
                    'address': {'type': ['null', 'string']},
                    'address_admin_area_level_1': {'type': ['null',
                                                            'string']},
                    'address_admin_area_level_2': {'type': ['null',
                                                            'string']},
                    'address_country': {'type': ['null', 'string']},
                    'address_formatted_address': {'type': ['null',
                                                           'string']},
                    'address_locality': {'type': ['null', 'string']},
                    'address_postal_code': {'type': ['null', 'string']},
                    'address_route': {'type': ['null', 'string']},
                    'address_street_number': {'type': ['null', 'string']},
                    'address_sublocality': {'type': ['null', 'string']},
                    'address_subpremise': {'type': ['null', 'string']},
                    'cc_email': {'type': ['null', 'string']},
                    'closed_deals_count': {'type': ['null', 'number']},
                    'company_id': {'type': ['null', 'number']},
                    'country_code': {'type': ['null', 'string']},
                    'done_activities_count': {'type': ['null', 'number']},
                    'email_messages_count': {'type': ['null', 'number']},
                    'files_count': {'type': ['null', 'number']},
                    'first_char': {'type': ['null', 'string']},
                    'followers_count': {'type': ['null', 'number']},
                    'id': {'type': ['null', 'number']},
                    'label': {'type': ['null', 'number']},
                    'last_activity_date': {'type': ['null', 'string']},
                    'last_activity_id': {'type': ['null', 'number']},
                    'lost_deals_count': {'type': ['null', 'number']},
                    'name': {'type': ['null', 'string']},
                    'next_activity_date': {'type': ['null', 'string']},
                    'next_activity_id': {'type': ['null', 'number']},
                    'next_activity_time': {'type': ['null', 'string']},
                    'notes_count': {'type': ['null', 'number']},
                    'open_deals_count': {'type': ['null', 'number']},
                    'owner_id': {'properties': {'active_flag': {'type': ['null',
                                                                         'boolean']},
                                                'email': {'type': ['null',
                                                                   'string']},
                                                'has_pic': {'type': ['null',
                                                                     'number']},
                                                'id': {'type': ['null',
                                                                'number']},
                                                'name': {'type': ['null',
                                                                  'string']},
                                                'pic_hash': {'type': ['null',
                                                                      'string']},
                                                'value': {'type': ['null',
                                                                   'number']}},
                                 'type': ['null', 'object', 'number']},
                    'owner_name': {'type': ['null', 'string']},
                    'people_count': {'type': ['null', 'number']},
                    'picture_id': {'properties': {'active_flag': {'type': ['null',
                                                                           'boolean']},
                                                  'add_time': {'type': ['null',
                                                                        'string']},
                                                  'added_by_user_id': {'type': ['null',
                                                                                'number']},
                                                  'item_id': {'type': ['null',
                                                                       'number']},
                                                  'item_type': {'type': ['null',
                                                                         'string']},
                                                  'pictures': {'properties': {'128': {'type': ['null',
                                                                                               'string']},
                                                                              '512': {'type': ['null',
                                                                                               'string']}},
                                                               'type': ['null',
                                                                        'object']},
                                                  'update_time': {'type': ['null',
                                                                           'string']},
                                                  'value': {'type': ['null',
                                                                     'number']}},
                                   'type': ['null', 'object']},
                    'related_closed_deals_count': {'type': ['null',
                                                            'number']},
                    'related_lost_deals_count': {'type': ['null',
                                                          'number']},
                    'related_open_deals_count': {'type': ['null',
                                                          'number']},
                    'related_won_deals_count': {'type': ['null', 'number']},
                    'undone_activities_count': {'type': ['null', 'number']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']},
                    'visible_to': {'type': ['null', 'number', 'string']},
                    'won_deals_count': {'type': ['null', 'number']}},
     'type': ['null', 'object']}

On instance:
    {'active_flag': True,
     'activities_count': 11,
     'add_time': '2021-07-06 13:20:52',
     'address': 'Boston, MA, USA',
     'address_admin_area_level_1': 'Massachusetts',
     'address_admin_area_level_2': 'Suffolk County',
     'address_country': 'United States',
     'address_formatted_address': 'Boston, MA, USA',
     'address_locality': 'Boston',
     'address_postal_code': '',
     'address_route': '',
     'address_street_number': '',
     'address_sublocality': '',
     'address_subpremise': '',
     'category_id': None,
     'cc_email': 'airbyte-sandbox@pipedrivemail.com',
     'closed_deals_count': 9,
     'company_id': 7780468,
     'country_code': None,
     'delete_time': None,
     'done_activities_count': 6,
     'email_messages_count': 0,
     'files_count': 1,
     'first_char': 't',
     'followers_count': 1,
     'id': 1,
     'label': 5,
     'last_activity_date': '2023-02-22',
     'last_activity_id': 20,
     'lost_deals_count': 2,
     'name': 'Test Organization1',
     'next_activity_date': '2021-07-06',
     'next_activity_id': 1,
     'next_activity_time': None,
     'notes_count': 3,
     'open_deals_count': 4,
     'owner_id': 11884360,
     'owner_name': 'Team Airbyte',
     'people_count': 3,
     'picture_id': None,
     'related_closed_deals_count': 0,
     'related_lost_deals_count': 0,
     'related_open_deals_count': 0,
     'related_won_deals_count': 0,
     'undone_activities_count': 5,
     'update_time': '2023-03-06 18:24:05',
     'visible_to': '3',
     'won_deals_count': 7}
ERROR    root:test_core.py:662 
The organization_fields stream has the following schema errors:
Additional properties are not allowed ('json_column_flag', 'id_suffix', 'parent_id', 'is_subfield' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'add_time': {'type': ['null', 'string']},
                    'add_visible_flag': {'type': ['null', 'boolean']},
                    'bulk_edit_allowed': {'type': ['null', 'boolean']},
                    'details_visible_flag': {'type': ['null', 'boolean']},
                    'edit_flag': {'type': ['null', 'boolean']},
                    'field_type': {'type': ['null', 'string']},
                    'filtering_allowed': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'important_flag': {'type': ['null', 'boolean']},
                    'index_visible_flag': {'type': ['null', 'boolean']},
                    'key': {'type': ['null', 'string']},
                    'last_updated_by_user_id': {'type': ['null',
                                                         'integer']},
                    'mandatory_flag': {'type': ['null', 'boolean']},
                    'name': {'type': ['null', 'string']},
                    'options': {'items': {'properties': {'id': {'type': ['null',
                                                                         'integer',
                                                                         'string',
                                                                         'boolean']},
                                                         'label': {'type': ['null',
                                                                            'string']}},
                                          'type': ['null', 'object']},
                                'type': ['null', 'array']},
                    'order_nr': {'type': ['null', 'integer']},
                    'searchable_flag': {'type': ['null', 'boolean']},
                    'sortable_flag': {'type': ['null', 'boolean']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'edit_flag': False,
     'field_type': 'varchar',
     'id': 0,
     'id_suffix': 'formatted_address',
     'is_subfield': True,
     'json_column_flag': False,
     'key': 'address_formatted_address',
     'mandatory_flag': True,
     'name': 'Full/combined address',
     'parent_id': 4021}
ERROR    root:test_core.py:662 
The persons stream has the following schema errors:
Additional properties are not allowed ('picture_128_url', 'delete_time' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'activities_count': {'type': ['null', 'integer']},
                    'add_time': {'type': ['null', 'string']},
                    'cc_email': {'type': ['null', 'string']},
                    'closed_deals_count': {'type': ['null', 'integer']},
                    'company_id': {'type': ['null', 'integer']},
                    'done_activities_count': {'type': ['null', 'integer']},
                    'email': {'items': {'properties': {'label': {'type': ['null',
                                                                          'string']},
                                                       'primary': {'type': ['null',
                                                                            'boolean']},
                                                       'value': {'type': ['null',
                                                                          'string']}},
                                        'type': ['null', 'object']},
                              'type': ['null', 'array']},
                    'email_messages_count': {'type': ['null', 'integer']},
                    'files_count': {'type': ['null', 'integer']},
                    'first_char': {'type': ['null', 'string']},
                    'first_name': {'type': ['null', 'string']},
                    'followers_count': {'type': ['null', 'integer']},
                    'id': {'type': ['null', 'integer']},
                    'label': {'type': ['null', 'integer']},
                    'last_activity_date': {'type': ['null', 'string']},
                    'last_activity_id': {'type': ['null', 'integer']},
                    'last_incoming_mail_time': {'type': ['null', 'string']},
                    'last_name': {'type': ['null', 'string']},
                    'last_outgoing_mail_time': {'type': ['null', 'string']},
                    'lost_deals_count': {'type': ['null', 'integer']},
                    'name': {'type': ['null', 'string']},
                    'next_activity_date': {'format': 'date',
                                           'type': ['null', 'string']},
                    'next_activity_id': {'type': ['null', 'integer']},
                    'next_activity_time': {'format': 'time',
                                           'type': ['null', 'string']},
                    'notes_count': {'type': ['null', 'integer']},
                    'open_deals_count': {'type': ['null', 'integer']},
                    'org_id': {'type': ['null', 'integer']},
                    'org_name': {'type': ['null', 'string']},
                    'owner_id': {'type': ['null', 'integer']},
                    'owner_name': {'type': ['null', 'string']},
                    'participant_closed_deals_count': {'type': ['null',
                                                                'integer']},
                    'participant_open_deals_count': {'type': ['null',
                                                              'integer']},
                    'phone': {'items': {'properties': {'label': {'type': ['null',
                                                                          'string']},
                                                       'primary': {'type': ['null',
                                                                            'boolean']},
                                                       'value': {'type': ['null',
                                                                          'string']}},
                                        'type': ['null', 'object']},
                              'type': ['null', 'array']},
                    'picture_id': {'properties': {'active_flag': {'type': ['null',
                                                                           'boolean']},
                                                  'add_time': {'type': ['null',
                                                                        'string']},
                                                  'added_by_user_id': {'type': ['null',
                                                                                'integer']},
                                                  'item_id': {'type': ['null',
                                                                       'integer']},
                                                  'item_type': {'type': ['null',
                                                                         'string']},
                                                  'pictures': {'properties': {'128': {'type': ['null',
                                                                                               'string']},
                                                                              '512': {'type': ['null',
                                                                                               'string']}},
                                                               'type': ['null',
                                                                        'object']},
                                                  'update_time': {'type': ['null',
                                                                           'string']},
                                                  'value': {'type': ['null',
                                                                     'integer']}},
                                   'type': ['null', 'object']},
                    'related_closed_deals_count': {'type': ['null',
                                                            'integer']},
                    'related_lost_deals_count': {'type': ['null',
                                                          'integer']},
                    'related_open_deals_count': {'type': ['null',
                                                          'integer']},
                    'related_won_deals_count': {'type': ['null',
                                                         'integer']},
                    'undone_activities_count': {'type': ['null',
                                                         'integer']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']},
                    'visible_to': {'type': ['null', 'string']},
                    'won_deals_count': {'type': ['null', 'integer']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'activities_count': 5,
     'add_time': '2023-02-22 08:31:12',
     'cc_email': 'airbyte-sandbox@pipedrivemail.com',
     'closed_deals_count': 0,
     'company_id': 7780468,
     'delete_time': None,
     'done_activities_count': 2,
     'email': [{'label': 'work',
                'primary': True,
                'value': 'user10.sample.airbyte@outlook.com'}],
     'email_messages_count': 0,
     'files_count': 0,
     'first_char': 'u',
     'first_name': 'User10',
     'followers_count': 1,
     'id': 11,
     'label': 1,
     'last_activity_date': '2023-02-22',
     'last_activity_id': 6,
     'last_incoming_mail_time': None,
     'last_name': 'Sample',
     'last_outgoing_mail_time': None,
     'lost_deals_count': 0,
     'name': 'User10 Sample',
     'next_activity_date': '2023-02-22',
     'next_activity_id': 36,
     'next_activity_time': None,
     'notes_count': 0,
     'open_deals_count': 3,
     'org_id': 10,
     'org_name': 'Test Organization 10',
     'owner_id': 11884360,
     'owner_name': 'Team Airbyte',
     'participant_closed_deals_count': 0,
     'participant_open_deals_count': 0,
     'phone': [{'label': 'work', 'primary': True, 'value': '+17786665544'}],
     'picture_128_url': None,
     'picture_id': None,
     'related_closed_deals_count': 0,
     'related_lost_deals_count': 0,
     'related_open_deals_count': 0,
     'related_won_deals_count': 0,
     'undone_activities_count': 3,
     'update_time': '2023-02-22 12:01:14',
     'visible_to': '3',
     'won_deals_count': 0}
ERROR    root:test_core.py:662 
The person_fields stream has the following schema errors:
Additional properties are not allowed ('json_column_flag' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'add_time': {'type': ['null', 'string']},
                    'add_visible_flag': {'type': ['null', 'boolean']},
                    'bulk_edit_allowed': {'type': ['null', 'boolean']},
                    'details_visible_flag': {'type': ['null', 'boolean']},
                    'edit_flag': {'type': ['null', 'boolean']},
                    'field_type': {'type': ['null', 'string']},
                    'filtering_allowed': {'type': ['null', 'boolean']},
                    'id': {'type': ['null', 'integer']},
                    'important_flag': {'type': ['null', 'boolean']},
                    'index_visible_flag': {'type': ['null', 'boolean']},
                    'key': {'type': ['null', 'string']},
                    'last_updated_by_user_id': {'type': ['null',
                                                         'integer']},
                    'mandatory_flag': {'type': ['null', 'boolean']},
                    'name': {'type': ['null', 'string']},
                    'options': {'items': {'properties': {'id': {'type': ['null',
                                                                         'integer',
                                                                         'string',
                                                                         'boolean']},
                                                         'label': {'type': ['null',
                                                                            'string']}},
                                          'type': ['null', 'object']},
                                'type': ['null', 'array']},
                    'order_nr': {'type': ['null', 'integer']},
                    'searchable_flag': {'type': ['null', 'boolean']},
                    'sortable_flag': {'type': ['null', 'boolean']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'add_time': '2020-12-10 07:23:48',
     'add_visible_flag': False,
     'bulk_edit_allowed': False,
     'details_visible_flag': False,
     'edit_flag': False,
     'field_type': 'date',
     'filtering_allowed': True,
     'id': 9061,
     'important_flag': False,
     'index_visible_flag': True,
     'json_column_flag': False,
     'key': 'last_outgoing_mail_time',
     'last_updated_by_user_id': None,
     'mandatory_flag': True,
     'name': 'Last email sent',
     'order_nr': 23,
     'searchable_flag': False,
     'sortable_flag': True,
     'update_time': '2020-12-10 07:23:48'}
ERROR    root:test_core.py:662 
The products stream has the following schema errors:
Additional properties are not allowed ('product_variations' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/schema#',
     'additionalProperties': False,
     'properties': {'active_flag': {'type': ['null', 'boolean']},
                    'add_time': {'type': ['null', 'string']},
                    'category': {'type': ['null', 'string']},
                    'code': {'type': ['null', 'string']},
                    'description': {'type': ['null', 'string']},
                    'files_count': {'type': ['null', 'integer']},
                    'first_char': {'type': ['null', 'string']},
                    'followers_count': {'type': ['null', 'integer']},
                    'id': {'type': ['null', 'integer']},
                    'name': {'type': ['null', 'string']},
                    'owner_id': {'type': ['null', 'integer']},
                    'owner_name': {'type': ['null', 'string']},
                    'prices': {'items': {'properties': {'cost': {'type': ['null',
                                                                          'integer']},
                                                        'currency': {'type': ['null',
                                                                              'string']},
                                                        'id': {'type': ['null',
                                                                        'integer']},
                                                        'overhead_cost': {'type': ['null',
                                                                                   'integer']},
                                                        'price': {'type': ['null',
                                                                           'integer']},
                                                        'product_id': {'type': ['null',
                                                                                'integer']}},
                                         'type': 'object'},
                               'type': 'array'},
                    'selectable': {'type': ['null', 'boolean']},
                    'tax': {'type': ['null', 'integer']},
                    'unit': {'type': ['null', 'string']},
                    'update_time': {'airbyte_type': 'timestamp_without_timezone',
                                    'format': 'date-time',
                                    'type': ['null', 'string']},
                    'visible_to': {'type': ['null', 'string']}},
     'type': 'object'}

On instance:
    {'active_flag': True,
     'add_time': '2023-02-22 08:31:21',
     'category': None,
     'code': None,
     'description': None,
     'files_count': None,
     'first_char': 'i',
     'followers_count': 0,
     'id': 11,
     'name': 'Item 10',
     'owner_id': 11884360,
     'owner_name': 'Team Airbyte',
     'prices': [{'cost': 0,
                 'currency': 'USD',
                 'id': 11,
                 'overhead_cost': None,
                 'price': 0,
                 'product_id': 11}],
     'product_variations': [],
     'selectable': True,
     'tax': 0,
     'unit': None,
     'update_time': '2023-02-22 08:31:21',
     'visible_to': '3'}
=========================== short test summary info ============================
FAILED ../../test_input/test_core.py::TestBasicRead::test_read[inputs0] - Fai...
============ 1 failed, 1 passed, 36 deselected in 157.57s (0:02:37) ============
