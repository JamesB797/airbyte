../../../../connectors/source-chargify/acceptance-test-config.yml
/Users/ella/airbytehq/airbyte/airbyte-integrations/connectors/source-chargify
============================= test session starts ==============================
platform linux -- Python 3.9.11, pytest-6.2.5, py-1.11.0, pluggy-1.0.0
rootdir: /test_input
plugins: timeout-1.4.2, hypothesis-6.54.6, requests-mock-1.9.3, cov-3.0.0, sugar-0.9.6, mock-3.6.1
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
collected 34 items / 33 deselected / 1 skipped

../../test_input/test_core.py F                                          [100%]


=================================== FAILURES ===================================
_______________________ TestBasicRead.test_read[inputs0] _______________________

self = <connector_acceptance_test.tests.test_core.TestBasicRead object at 0xffff90b31be0>
connector_config = SecretDict(******)
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='customers', json_schema={'$schema...l_refresh'>, cursor_field=None, destination_sync_mode=<DestinationSyncMode.overwrite: 'overwrite'>, primary_key=None)])
expect_records_config = None, should_validate_schema = True
should_validate_data_points = False, should_fail_on_extra_columns = True
empty_streams = set(), ignored_fields = {}, expected_records_by_stream = {}
docker_runner = <connector_acceptance_test.utils.connector_runner.ConnectorRunner object at 0xffff8fdb7c70>
detailed_logger = <Logger detailed_logger /test_input/acceptance_tests_logs/test_core.py__TestBasicRead__test_read[inputs0].txt (DEBUG)>

    def test_read(
        self,
        connector_config,
        configured_catalog,
        expect_records_config: ExpectedRecordsConfig,
        should_validate_schema: Boolean,
        should_validate_data_points: Boolean,
        should_fail_on_extra_columns: Boolean,
        empty_streams: Set[EmptyStreamConfiguration],
        ignored_fields: Optional[Mapping[str, List[IgnoredFieldsConfiguration]]],
        expected_records_by_stream: MutableMapping[str, List[MutableMapping]],
        docker_runner: ConnectorRunner,
        detailed_logger,
    ):
        output = docker_runner.call_read(connector_config, configured_catalog)
        records = [message.record for message in filter_output(output, Type.RECORD)]
    
        assert records, "At least one record should be read using provided catalog"
    
        if should_validate_schema:  # TODO Conditional logic
>           self._validate_schema(
                records=records, configured_catalog=configured_catalog, fail_on_extra_columns=should_fail_on_extra_columns
            )

connector_acceptance_test/tests/test_core.py:823: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

records = [AirbyteRecordMessage(namespace=None, stream='customers', data={'first_name': 'Kayla', 'last_name': 'Test', 'email': '...y_enabled': False, 'dunning_communication_delay_time_zone': '"Eastern Time (US & Canada)"'}, emitted_at=1679404652990)]
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='customers', json_schema={'$schema...l_refresh'>, cursor_field=None, destination_sync_mode=<DestinationSyncMode.overwrite: 'overwrite'>, primary_key=None)])
fail_on_extra_columns = True

    @staticmethod
    def _validate_schema(records: List[AirbyteRecordMessage], configured_catalog: ConfiguredAirbyteCatalog, fail_on_extra_columns: Boolean):
        """
        Check if data type and structure in records matches the one in json_schema of the stream in catalog
        """
        TestBasicRead._validate_records_structure(records, configured_catalog)
        bar = "-" * 80
        streams_errors = verify_records_schema(records, configured_catalog, fail_on_extra_columns)
        for stream_name, errors in streams_errors.items():
            errors = map(str, errors.values())
            str_errors = f"\n{bar}\n".join(errors)
            logging.error(f"\nThe {stream_name} stream has the following schema errors:\n{str_errors}")
    
        if streams_errors:
>           pytest.fail(f"Please check your json_schema in selected streams {tuple(streams_errors.keys())}.")
E           Failed: Please check your json_schema in selected streams ('subscriptions',).

connector_acceptance_test/tests/test_core.py:665: Failed
---------------------------- Captured stdout setup -----------------------------
{"type": "LOG", "log": {"level": "WARN", "message": "The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format."}}
------------------------------ Captured log setup ------------------------------
WARNING  root:config.py:282 The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format.
----------------------------- Captured stdout call -----------------------------
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe subscriptions stream has the following schema errors:\nAdditional properties are not allowed ('coupons', 'dunning_communication_delay_time_zone', 'dunning_communication_delay_enabled' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$schema': 'http://json-schema.org/draft-07/schema',\n     'additionalProperties': False,\n     'properties': {'activated_at': {'type': 'string'},\n                    'automatically_resume_at': {'type': 'string'},\n                    'balance_in_cents': {'type': 'integer'},\n                    'bank_account': {'properties': {'bank_account_holder_type': {'type': 'string'},\n                                                    'bank_account_type': {'type': 'string'},\n                                                    'bank_name': {'type': 'string'},\n                                                    'billing_address': {'type': 'string'},\n                                                    'billing_address_2': {'type': 'string'},\n                                                    'billing_city': {'type': 'string'},\n                                                    'billing_country': {'type': 'string'},\n                                                    'billing_state': {'type': 'string'},\n                                                    'billing_zip': {'type': 'string'},\n                                                    'chargify_token': {'type': 'string'},\n                                                    'current_vault': {'type': 'string'},\n                                                    'customer_id': {'type': 'integer'},\n                                                    'customer_vault_token': {'type': 'string'},\n                                                    'first_name': {'type': 'string'},\n                                                    'gateway_handle': {'type': 'string'},\n                                                    'id': {'type': 'integer'},\n                                                    'last_name': {'type': 'string'},\n                                                    'masked_bank_account_number': {'type': 'string'},\n                                                    'masked_bank_routing_number': {'type': 'string'},\n                                                    'site_gateway_setting_id': {'type': 'integer'},\n                                                    'vault_token': {'type': 'string'}},\n                                     'type': 'object'},\n                    'cancel_at_end_of_period': {'type': 'boolean'},\n                    'canceled_at': {'type': 'string'},\n                    'cancellation_message': {'type': 'string'},\n                    'cancellation_method': {'type': 'string'},\n                    'coupon_code': {'type': 'string'},\n                    'coupon_codes': {'items': {'anyOf': [{'type': 'string'}]},\n                                     'type': 'array'},\n                    'coupon_use_count': {'type': 'integer'},\n                    'coupon_uses_allowed': {'type': 'integer'},\n                    'created_at': {'type': 'string'},\n                    'credit_card': {'properties': {'billing_address': {'type': 'string'},\n                                                   'billing_address_2': {'type': 'string'},\n                                                   'billing_city': {'type': 'string'},\n                                                   'billing_country': {'type': 'string'},\n                                                   'billing_state': {'type': 'string'},\n                                                   'billing_zip': {'type': 'string'},\n                                                   'card_type': {'type': 'string'},\n                                                   'chargify_token': {'type': 'string'},\n                                                   'current_vault': {'type': 'string'},\n                                                   'customer_id': {'type': 'integer'},\n                                                   'customer_vault_token': {'type': 'string'},\n                                                   'disabled': {'type': 'boolean'},\n                                                   'expiration_month': {'type': 'integer'},\n                                                   'expiration_year': {'type': 'integer'},\n                                                   'first_name': {'type': 'string'},\n                                                   'gateway_handle': {'type': 'string'},\n                                                   'id': {'type': 'integer'},\n                                                   'last_name': {'type': 'string'},\n                                                   'masked_card_number': {'type': 'string'},\n                                                   'payment_type': {'type': 'string'},\n                                                   'site_gateway_setting_id': {'type': 'integer'},\n                                                   'vault_token': {'type': 'string'}},\n                                    'type': 'object'},\n                    'current_billing_amount_in_cents': {'type': 'integer'},\n                    'current_period_ends_at': {'type': 'string'},\n                    'current_period_started_at': {'type': 'string'},\n                    'customer': {'properties': {'address': {'type': 'string'},\n                                                'address_2': {'type': 'string'},\n                                                'cc_emails': {'type': 'string'},\n                                                'city': {'type': 'string'},\n                                                'country': {'type': 'string'},\n                                                'country_name': {'type': 'string'},\n                                                'created_at': {'type': 'string'},\n                                                'default_subscription_group_uid': {'type': 'string'},\n                                                'email': {'type': 'string'},\n                                                'first_name': {'type': 'string'},\n                                                'id': {'type': 'integer'},\n                                                'last_name': {'type': 'string'},\n                                                'locale': {'type': 'string'},\n                                                'organization': {'type': 'string'},\n                                                'parent_id': {'type': 'integer'},\n                                                'phone': {'type': 'string'},\n                                                'portal_customer_created_at': {'type': 'string'},\n                                                'portal_invite_last_accepted_at': {'type': ['null',\n                                                                                            'string']},\n                                                'portal_invite_last_sent_at': {'type': 'string'},\n                                                'reference': {'type': 'string'},\n                                                'state': {'type': 'string'},\n                                                'state_name': {'type': 'string'},\n                                                'tax_exempt': {'type': 'boolean'},\n                                                'updated_at': {'type': 'string'},\n                                                'vat_number': {'type': 'string'},\n                                                'verified': {'type': 'boolean'},\n                                                'zip': {'type': 'string'}},\n                                 'type': 'object'},\n                    'delayed_cancel_at': {'type': 'string'},\n                    'expires_at': {'type': 'string'},\n                    'group': {'properties': {'primary': {'type': 'string'},\n                                             'primary_subscription_id': {'type': 'string'},\n                                             'scheme': {'type': 'string'},\n                                             'uid': {'type': 'string'}},\n                              'type': 'object'},\n                    'id': {'type': 'integer'},\n                    'net_terms': {'type': 'integer'},\n                    'next_assessment_at': {'type': 'string'},\n                    'next_product_handle': {'type': 'string'},\n                    'next_product_id': {'type': 'integer'},\n                    'next_product_price_point_id': {'type': 'integer'},\n                    'offer_id': {'type': 'string'},\n                    'on_hold_at': {'type': 'string'},\n                    'payer_id': {'type': 'integer'},\n                    'payment_collection_method': {'type': 'string'},\n                    'payment_type': {'type': 'string'},\n                    'prepaid_dunning': {'type': 'boolean'},\n                    'previous_state': {'type': 'string'},\n                    'product': {'properties': {'accounting_code': {'type': 'string'},\n                                               'archived_at': {'type': 'string'},\n                                               'created_at': {'type': 'string'},\n                                               'default_product_price_point_id': {'type': 'integer'},\n                                               'description': {'type': 'string'},\n                                               'expiration_interval': {'type': 'integer'},\n                                               'expiration_interval_unit': {'type': 'string'},\n                                               'handle': {'type': 'string'},\n                                               'id': {'type': 'integer'},\n                                               'initial_charge_after_trial': {'type': 'boolean'},\n                                               'initial_charge_in_cents': {'type': 'integer'},\n                                               'interval': {'type': 'integer'},\n                                               'interval_unit': {'type': 'string'},\n                                               'name': {'type': 'string'},\n                                               'price_in_cents': {'type': 'integer'},\n                                               'product_family': {'properties': {'accounting_code': {'type': 'null'},\n                                                                                 'created_at': {'type': 'string'},\n                                                                                 'description': {'type': 'string'},\n                                                                                 'handle': {'type': 'string'},\n                                                                                 'id': {'type': 'integer'},\n                                                                                 'name': {'type': 'string'},\n                                                                                 'updated_at': {'type': 'string'}},\n                                                                  'type': 'object'},\n                                               'product_price_point_name': {'type': 'string'},\n                                               'public_signup_pages': {'items': {'anyOf': [{'properties': {'id': {'type': 'integer'},\n                                                                                                           'return_params': {'type': 'string'},\n                                                                                                           'return_url': {'type': 'string'},\n                                                                                                           'url': {'type': 'string'}},\n                                                                                            'type': 'object'}]},\n                                                                       'type': 'array'},\n                                               'request_billing_address': {'type': 'boolean'},\n                                               'request_credit_card': {'type': 'boolean'},\n                                               'require_billing_address': {'type': 'boolean'},\n                                               'require_credit_card': {'type': 'boolean'},\n                                               'require_shipping_address': {'type': 'boolean'},\n                                               'return_params': {'type': 'string'},\n                                               'tax_code': {'type': 'string'},\n                                               'taxable': {'type': 'boolean'},\n                                               'trial_interval': {'type': 'integer'},\n                                               'trial_interval_unit': {'type': 'string'},\n                                               'trial_price_in_cents': {'type': 'integer'},\n                                               'update_return_params': {'type': 'string'},\n                                               'update_return_url': {'type': 'string'},\n                                               'updated_at': {'type': 'string'},\n                                               'version_number': {'type': 'integer'}},\n                                'type': 'object'},\n                    'product_price_in_cents': {'type': 'integer'},\n                    'product_price_point_id': {'type': 'integer'},\n                    'product_version_number': {'type': 'integer'},\n                    'reason_code': {'type': 'string'},\n                    'reference': {'type': 'string'},\n                    'referral_code': {'type': 'string'},\n                    'signup_payment_id': {'type': 'integer'},\n                    'signup_revenue': {'type': 'string'},\n                    'snap_day': {'type': 'string'},\n                    'state': {'type': 'string'},\n                    'stored_credential_transaction_id': {'type': 'integer'},\n                    'total_revenue_in_cents': {'type': 'integer'},\n                    'trial_ended_at': {'type': 'string'},\n                    'trial_started_at': {'type': 'string'},\n                    'updated_at': {'type': 'string'}},\n     'type': 'object'}\n\nOn instance:\n    {'activated_at': 'string',\n     'automatically_resume_at': 'string',\n     'balance_in_cents': 0,\n     'bank_account': {'bank_account_holder_type': 'string',\n                      'bank_account_type': 'string',\n                      'bank_name': 'string',\n                      'billing_address': 'string',\n                      'billing_address_2': 'string',\n                      'billing_city': 'string',\n                      'billing_country': 'string',\n                      'billing_state': 'string',\n                      'billing_zip': 'string',\n                      'chargify_token': 'string',\n                      'current_vault': 'authorizenet',\n                      'customer_id': 0,\n                      'customer_vault_token': 'string',\n                      'first_name': 'string',\n                      'gateway_handle': 'string',\n                      'id': 0,\n                      'last_name': 'string',\n                      'masked_bank_account_number': 'string',\n                      'masked_bank_routing_number': 'string',\n                      'site_gateway_setting_id': 0,\n                      'vault_token': 'string'},\n     'cancel_at_end_of_period': True,\n     'canceled_at': 'string',\n     'cancellation_message': 'string',\n     'cancellation_method': 'merchant_ui',\n     'coupon_code': 'string',\n     'coupon_codes': ['string'],\n     'coupon_use_count': 0,\n     'coupon_uses_allowed': 0,\n     'coupons': [{'': {'amount_in_cents': '\"1000\"',\n                       'code': '\"ABCD_10\"',\n                       'expires_at': '\"2023-07-13T05:18:58-04:00\"',\n                       'percentage': '\"15.0\"',\n                       'recurring': True,\n                       'use_count': 2,\n                       'uses_allowed': 10}}],\n     'created_at': 'string',\n     'credit_card': {'billing_address': 'string',\n                     'billing_address_2': 'string',\n                     'billing_city': 'string',\n                     'billing_country': 'string',\n                     'billing_state': 'string',\n                     'billing_zip': 'string',\n                     'card_type': 'bogus',\n                     'chargify_token': 'string',\n                     'current_vault': 'bogus',\n                     'customer_id': 0,\n                     'customer_vault_token': 'string',\n                     'disabled': True,\n                     'expiration_month': 0,\n                     'expiration_year': 0,\n                     'first_name': 'string',\n                     'gateway_handle': 'string',\n                     'id': 0,\n                     'last_name': 'string',\n                     'masked_card_number': 'string',\n                     'payment_type': 'string',\n                     'site_gateway_setting_id': 0,\n                     'vault_token': 'string'},\n     'current_billing_amount_in_cents': 0,\n     'current_period_ends_at': 'string',\n     'current_period_started_at': 'string',\n     'customer': {'address': 'string',\n                  'address_2': 'string',\n                  'cc_emails': 'string',\n                  'city': 'string',\n                  'country': 'string',\n                  'country_name': 'string',\n                  'created_at': 'string',\n                  'default_subscription_group_uid': 'string',\n                  'email': 'string',\n                  'first_name': 'string',\n                  'id': 0,\n                  'last_name': 'string',\n                  'locale': 'string',\n                  'organization': 'string',\n                  'parent_id': 0,\n                  'phone': 'string',\n                  'portal_customer_created_at': 'string',\n                  'portal_invite_last_accepted_at': 'string',\n                  'portal_invite_last_sent_at': 'string',\n                  'reference': 'string',\n                  'state': 'string',\n                  'state_name': 'string',\n                  'tax_exempt': True,\n                  'updated_at': 'string',\n                  'vat_number': 'string',\n                  'verified': True,\n                  'zip': 'string'},\n     'delayed_cancel_at': 'string',\n     'dunning_communication_delay_enabled': False,\n     'dunning_communication_delay_time_zone': '\"Eastern Time (US & '\n                                              'Canada)\"',\n     'expires_at': 'string',\n     'group': {'primary': 'string',\n               'primary_subscription_id': 'string',\n               'scheme': 'string',\n               'uid': 'string'},\n     'id': 0,\n     'net_terms': 0,\n     'next_assessment_at': 'string',\n     'next_product_handle': 'string',\n     'next_product_id': 0,\n     'next_product_price_point_id': 0,\n     'offer_id': 'string',\n     'on_hold_at': 'string',\n     'payer_id': 0,\n     'payment_collection_method': 'automatic',\n     'payment_type': 'string',\n     'prepaid_dunning': True,\n     'previous_state': 'string',\n     'product': {'accounting_code': 'string',\n                 'archived_at': 'string',\n                 'created_at': 'string',\n                 'default_product_price_point_id': 0,\n                 'description': 'string',\n                 'expiration_interval': 0,\n                 'expiration_interval_unit': 'month',\n                 'handle': 'string',\n                 'id': 0,\n                 'initial_charge_after_trial': True,\n                 'initial_charge_in_cents': 0,\n                 'interval': 0,\n                 'interval_unit': 'month',\n                 'item_category': 'string',\n                 'name': 'string',\n                 'price_in_cents': 0,\n                 'product_family': {'accounting_code': None,\n                                    'created_at': 'string',\n                                    'description': 'string',\n                                    'handle': 'string',\n                                    'id': 0,\n                                    'name': 'string',\n                                    'updated_at': 'string'},\n                 'product_price_point_name': 'string',\n                 'public_signup_pages': [{'id': 0,\n                                          'return_params': 'string',\n                                          'return_url': 'string',\n                                          'url': 'string'}],\n                 'request_billing_address': True,\n                 'request_credit_card': True,\n                 'require_billing_address': True,\n                 'require_credit_card': True,\n                 'require_shipping_address': True,\n                 'return_params': 'string',\n                 'tax_code': 'string',\n                 'taxable': True,\n                 'trial_interval': 0,\n                 'trial_interval_unit': 'month',\n                 'trial_price_in_cents': 0,\n                 'update_return_params': 'string',\n                 'update_return_url': 'string',\n                 'updated_at': 'string',\n                 'use_site_exchange_rate': True,\n                 'version_number': 0},\n     'product_price_in_cents': 0,\n     'product_price_point_id': 0,\n     'product_version_number': 0,\n     'reason_code': 'string',\n     'reference': 'string',\n     'referral_code': 'string',\n     'signup_payment_id': 0,\n     'signup_revenue': 'string',\n     'snap_day': 'string',\n     'state': 'string',\n     'stored_credential_transaction_id': 0,\n     'total_revenue_in_cents': 0,\n     'trial_ended_at': 'string',\n     'trial_started_at': 'string',\n     'updated_at': 'string'}"}}
------------------------------ Captured log call -------------------------------
ERROR    root:test_core.py:662 
The subscriptions stream has the following schema errors:
Additional properties are not allowed ('coupons', 'dunning_communication_delay_time_zone', 'dunning_communication_delay_enabled' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$schema': 'http://json-schema.org/draft-07/schema',
     'additionalProperties': False,
     'properties': {'activated_at': {'type': 'string'},
                    'automatically_resume_at': {'type': 'string'},
                    'balance_in_cents': {'type': 'integer'},
                    'bank_account': {'properties': {'bank_account_holder_type': {'type': 'string'},
                                                    'bank_account_type': {'type': 'string'},
                                                    'bank_name': {'type': 'string'},
                                                    'billing_address': {'type': 'string'},
                                                    'billing_address_2': {'type': 'string'},
                                                    'billing_city': {'type': 'string'},
                                                    'billing_country': {'type': 'string'},
                                                    'billing_state': {'type': 'string'},
                                                    'billing_zip': {'type': 'string'},
                                                    'chargify_token': {'type': 'string'},
                                                    'current_vault': {'type': 'string'},
                                                    'customer_id': {'type': 'integer'},
                                                    'customer_vault_token': {'type': 'string'},
                                                    'first_name': {'type': 'string'},
                                                    'gateway_handle': {'type': 'string'},
                                                    'id': {'type': 'integer'},
                                                    'last_name': {'type': 'string'},
                                                    'masked_bank_account_number': {'type': 'string'},
                                                    'masked_bank_routing_number': {'type': 'string'},
                                                    'site_gateway_setting_id': {'type': 'integer'},
                                                    'vault_token': {'type': 'string'}},
                                     'type': 'object'},
                    'cancel_at_end_of_period': {'type': 'boolean'},
                    'canceled_at': {'type': 'string'},
                    'cancellation_message': {'type': 'string'},
                    'cancellation_method': {'type': 'string'},
                    'coupon_code': {'type': 'string'},
                    'coupon_codes': {'items': {'anyOf': [{'type': 'string'}]},
                                     'type': 'array'},
                    'coupon_use_count': {'type': 'integer'},
                    'coupon_uses_allowed': {'type': 'integer'},
                    'created_at': {'type': 'string'},
                    'credit_card': {'properties': {'billing_address': {'type': 'string'},
                                                   'billing_address_2': {'type': 'string'},
                                                   'billing_city': {'type': 'string'},
                                                   'billing_country': {'type': 'string'},
                                                   'billing_state': {'type': 'string'},
                                                   'billing_zip': {'type': 'string'},
                                                   'card_type': {'type': 'string'},
                                                   'chargify_token': {'type': 'string'},
                                                   'current_vault': {'type': 'string'},
                                                   'customer_id': {'type': 'integer'},
                                                   'customer_vault_token': {'type': 'string'},
                                                   'disabled': {'type': 'boolean'},
                                                   'expiration_month': {'type': 'integer'},
                                                   'expiration_year': {'type': 'integer'},
                                                   'first_name': {'type': 'string'},
                                                   'gateway_handle': {'type': 'string'},
                                                   'id': {'type': 'integer'},
                                                   'last_name': {'type': 'string'},
                                                   'masked_card_number': {'type': 'string'},
                                                   'payment_type': {'type': 'string'},
                                                   'site_gateway_setting_id': {'type': 'integer'},
                                                   'vault_token': {'type': 'string'}},
                                    'type': 'object'},
                    'current_billing_amount_in_cents': {'type': 'integer'},
                    'current_period_ends_at': {'type': 'string'},
                    'current_period_started_at': {'type': 'string'},
                    'customer': {'properties': {'address': {'type': 'string'},
                                                'address_2': {'type': 'string'},
                                                'cc_emails': {'type': 'string'},
                                                'city': {'type': 'string'},
                                                'country': {'type': 'string'},
                                                'country_name': {'type': 'string'},
                                                'created_at': {'type': 'string'},
                                                'default_subscription_group_uid': {'type': 'string'},
                                                'email': {'type': 'string'},
                                                'first_name': {'type': 'string'},
                                                'id': {'type': 'integer'},
                                                'last_name': {'type': 'string'},
                                                'locale': {'type': 'string'},
                                                'organization': {'type': 'string'},
                                                'parent_id': {'type': 'integer'},
                                                'phone': {'type': 'string'},
                                                'portal_customer_created_at': {'type': 'string'},
                                                'portal_invite_last_accepted_at': {'type': ['null',
                                                                                            'string']},
                                                'portal_invite_last_sent_at': {'type': 'string'},
                                                'reference': {'type': 'string'},
                                                'state': {'type': 'string'},
                                                'state_name': {'type': 'string'},
                                                'tax_exempt': {'type': 'boolean'},
                                                'updated_at': {'type': 'string'},
                                                'vat_number': {'type': 'string'},
                                                'verified': {'type': 'boolean'},
                                                'zip': {'type': 'string'}},
                                 'type': 'object'},
                    'delayed_cancel_at': {'type': 'string'},
                    'expires_at': {'type': 'string'},
                    'group': {'properties': {'primary': {'type': 'string'},
                                             'primary_subscription_id': {'type': 'string'},
                                             'scheme': {'type': 'string'},
                                             'uid': {'type': 'string'}},
                              'type': 'object'},
                    'id': {'type': 'integer'},
                    'net_terms': {'type': 'integer'},
                    'next_assessment_at': {'type': 'string'},
                    'next_product_handle': {'type': 'string'},
                    'next_product_id': {'type': 'integer'},
                    'next_product_price_point_id': {'type': 'integer'},
                    'offer_id': {'type': 'string'},
                    'on_hold_at': {'type': 'string'},
                    'payer_id': {'type': 'integer'},
                    'payment_collection_method': {'type': 'string'},
                    'payment_type': {'type': 'string'},
                    'prepaid_dunning': {'type': 'boolean'},
                    'previous_state': {'type': 'string'},
                    'product': {'properties': {'accounting_code': {'type': 'string'},
                                               'archived_at': {'type': 'string'},
                                               'created_at': {'type': 'string'},
                                               'default_product_price_point_id': {'type': 'integer'},
                                               'description': {'type': 'string'},
                                               'expiration_interval': {'type': 'integer'},
                                               'expiration_interval_unit': {'type': 'string'},
                                               'handle': {'type': 'string'},
                                               'id': {'type': 'integer'},
                                               'initial_charge_after_trial': {'type': 'boolean'},
                                               'initial_charge_in_cents': {'type': 'integer'},
                                               'interval': {'type': 'integer'},
                                               'interval_unit': {'type': 'string'},
                                               'name': {'type': 'string'},
                                               'price_in_cents': {'type': 'integer'},
                                               'product_family': {'properties': {'accounting_code': {'type': 'null'},
                                                                                 'created_at': {'type': 'string'},
                                                                                 'description': {'type': 'string'},
                                                                                 'handle': {'type': 'string'},
                                                                                 'id': {'type': 'integer'},
                                                                                 'name': {'type': 'string'},
                                                                                 'updated_at': {'type': 'string'}},
                                                                  'type': 'object'},
                                               'product_price_point_name': {'type': 'string'},
                                               'public_signup_pages': {'items': {'anyOf': [{'properties': {'id': {'type': 'integer'},
                                                                                                           'return_params': {'type': 'string'},
                                                                                                           'return_url': {'type': 'string'},
                                                                                                           'url': {'type': 'string'}},
                                                                                            'type': 'object'}]},
                                                                       'type': 'array'},
                                               'request_billing_address': {'type': 'boolean'},
                                               'request_credit_card': {'type': 'boolean'},
                                               'require_billing_address': {'type': 'boolean'},
                                               'require_credit_card': {'type': 'boolean'},
                                               'require_shipping_address': {'type': 'boolean'},
                                               'return_params': {'type': 'string'},
                                               'tax_code': {'type': 'string'},
                                               'taxable': {'type': 'boolean'},
                                               'trial_interval': {'type': 'integer'},
                                               'trial_interval_unit': {'type': 'string'},
                                               'trial_price_in_cents': {'type': 'integer'},
                                               'update_return_params': {'type': 'string'},
                                               'update_return_url': {'type': 'string'},
                                               'updated_at': {'type': 'string'},
                                               'version_number': {'type': 'integer'}},
                                'type': 'object'},
                    'product_price_in_cents': {'type': 'integer'},
                    'product_price_point_id': {'type': 'integer'},
                    'product_version_number': {'type': 'integer'},
                    'reason_code': {'type': 'string'},
                    'reference': {'type': 'string'},
                    'referral_code': {'type': 'string'},
                    'signup_payment_id': {'type': 'integer'},
                    'signup_revenue': {'type': 'string'},
                    'snap_day': {'type': 'string'},
                    'state': {'type': 'string'},
                    'stored_credential_transaction_id': {'type': 'integer'},
                    'total_revenue_in_cents': {'type': 'integer'},
                    'trial_ended_at': {'type': 'string'},
                    'trial_started_at': {'type': 'string'},
                    'updated_at': {'type': 'string'}},
     'type': 'object'}

On instance:
    {'activated_at': 'string',
     'automatically_resume_at': 'string',
     'balance_in_cents': 0,
     'bank_account': {'bank_account_holder_type': 'string',
                      'bank_account_type': 'string',
                      'bank_name': 'string',
                      'billing_address': 'string',
                      'billing_address_2': 'string',
                      'billing_city': 'string',
                      'billing_country': 'string',
                      'billing_state': 'string',
                      'billing_zip': 'string',
                      'chargify_token': 'string',
                      'current_vault': 'authorizenet',
                      'customer_id': 0,
                      'customer_vault_token': 'string',
                      'first_name': 'string',
                      'gateway_handle': 'string',
                      'id': 0,
                      'last_name': 'string',
                      'masked_bank_account_number': 'string',
                      'masked_bank_routing_number': 'string',
                      'site_gateway_setting_id': 0,
                      'vault_token': 'string'},
     'cancel_at_end_of_period': True,
     'canceled_at': 'string',
     'cancellation_message': 'string',
     'cancellation_method': 'merchant_ui',
     'coupon_code': 'string',
     'coupon_codes': ['string'],
     'coupon_use_count': 0,
     'coupon_uses_allowed': 0,
     'coupons': [{'': {'amount_in_cents': '"1000"',
                       'code': '"ABCD_10"',
                       'expires_at': '"2023-07-13T05:18:58-04:00"',
                       'percentage': '"15.0"',
                       'recurring': True,
                       'use_count': 2,
                       'uses_allowed': 10}}],
     'created_at': 'string',
     'credit_card': {'billing_address': 'string',
                     'billing_address_2': 'string',
                     'billing_city': 'string',
                     'billing_country': 'string',
                     'billing_state': 'string',
                     'billing_zip': 'string',
                     'card_type': 'bogus',
                     'chargify_token': 'string',
                     'current_vault': 'bogus',
                     'customer_id': 0,
                     'customer_vault_token': 'string',
                     'disabled': True,
                     'expiration_month': 0,
                     'expiration_year': 0,
                     'first_name': 'string',
                     'gateway_handle': 'string',
                     'id': 0,
                     'last_name': 'string',
                     'masked_card_number': 'string',
                     'payment_type': 'string',
                     'site_gateway_setting_id': 0,
                     'vault_token': 'string'},
     'current_billing_amount_in_cents': 0,
     'current_period_ends_at': 'string',
     'current_period_started_at': 'string',
     'customer': {'address': 'string',
                  'address_2': 'string',
                  'cc_emails': 'string',
                  'city': 'string',
                  'country': 'string',
                  'country_name': 'string',
                  'created_at': 'string',
                  'default_subscription_group_uid': 'string',
                  'email': 'string',
                  'first_name': 'string',
                  'id': 0,
                  'last_name': 'string',
                  'locale': 'string',
                  'organization': 'string',
                  'parent_id': 0,
                  'phone': 'string',
                  'portal_customer_created_at': 'string',
                  'portal_invite_last_accepted_at': 'string',
                  'portal_invite_last_sent_at': 'string',
                  'reference': 'string',
                  'state': 'string',
                  'state_name': 'string',
                  'tax_exempt': True,
                  'updated_at': 'string',
                  'vat_number': 'string',
                  'verified': True,
                  'zip': 'string'},
     'delayed_cancel_at': 'string',
     'dunning_communication_delay_enabled': False,
     'dunning_communication_delay_time_zone': '"Eastern Time (US & '
                                              'Canada)"',
     'expires_at': 'string',
     'group': {'primary': 'string',
               'primary_subscription_id': 'string',
               'scheme': 'string',
               'uid': 'string'},
     'id': 0,
     'net_terms': 0,
     'next_assessment_at': 'string',
     'next_product_handle': 'string',
     'next_product_id': 0,
     'next_product_price_point_id': 0,
     'offer_id': 'string',
     'on_hold_at': 'string',
     'payer_id': 0,
     'payment_collection_method': 'automatic',
     'payment_type': 'string',
     'prepaid_dunning': True,
     'previous_state': 'string',
     'product': {'accounting_code': 'string',
                 'archived_at': 'string',
                 'created_at': 'string',
                 'default_product_price_point_id': 0,
                 'description': 'string',
                 'expiration_interval': 0,
                 'expiration_interval_unit': 'month',
                 'handle': 'string',
                 'id': 0,
                 'initial_charge_after_trial': True,
                 'initial_charge_in_cents': 0,
                 'interval': 0,
                 'interval_unit': 'month',
                 'item_category': 'string',
                 'name': 'string',
                 'price_in_cents': 0,
                 'product_family': {'accounting_code': None,
                                    'created_at': 'string',
                                    'description': 'string',
                                    'handle': 'string',
                                    'id': 0,
                                    'name': 'string',
                                    'updated_at': 'string'},
                 'product_price_point_name': 'string',
                 'public_signup_pages': [{'id': 0,
                                          'return_params': 'string',
                                          'return_url': 'string',
                                          'url': 'string'}],
                 'request_billing_address': True,
                 'request_credit_card': True,
                 'require_billing_address': True,
                 'require_credit_card': True,
                 'require_shipping_address': True,
                 'return_params': 'string',
                 'tax_code': 'string',
                 'taxable': True,
                 'trial_interval': 0,
                 'trial_interval_unit': 'month',
                 'trial_price_in_cents': 0,
                 'update_return_params': 'string',
                 'update_return_url': 'string',
                 'updated_at': 'string',
                 'use_site_exchange_rate': True,
                 'version_number': 0},
     'product_price_in_cents': 0,
     'product_price_point_id': 0,
     'product_version_number': 0,
     'reason_code': 'string',
     'reference': 'string',
     'referral_code': 'string',
     'signup_payment_id': 0,
     'signup_revenue': 'string',
     'snap_day': 'string',
     'state': 'string',
     'stored_credential_transaction_id': 0,
     'total_revenue_in_cents': 0,
     'trial_ended_at': 'string',
     'trial_started_at': 'string',
     'updated_at': 'string'}
=============================== warnings summary ===============================
connector_acceptance_test/config.py:282: 34 warnings
test_core.py: 1 warning
  /airbyte/connector_acceptance_test/connector_acceptance_test/config.py:282: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
    logging.warn("The acceptance-test-config.yml file is in a legacy format. Please migrate to the latest format.")

-- Docs: https://docs.pytest.org/en/stable/warnings.html
=========================== short test summary info ============================
FAILED ../../test_input/test_core.py::TestBasicRead::test_read[inputs0] - Fai...
SKIPPED [1] connector_acceptance_test/plugin.py:63: Skipping TestIncremental.test_two_sequential_reads: not found in the config.
========== 1 failed, 1 skipped, 33 deselected, 35 warnings in 11.13s ===========
