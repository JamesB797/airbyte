../../../../connectors/source-punk-api/acceptance-test-config.yml
/Users/ella/airbytehq/airbyte/airbyte-integrations/connectors/source-punk-api
============================= test session starts ==============================
platform linux -- Python 3.9.11, pytest-6.2.5, py-1.11.0, pluggy-1.0.0
rootdir: /test_input
plugins: timeout-1.4.2, hypothesis-6.54.6, requests-mock-1.9.3, cov-3.0.0, sugar-0.9.6, mock-3.6.1
collected 34 items / 33 deselected / 1 skipped

../../test_input/test_core.py F                                          [100%]


=================================== FAILURES ===================================
_______________________ TestBasicRead.test_read[inputs0] _______________________

self = <connector_acceptance_test.tests.test_core.TestBasicRead object at 0xffff7c939a60>
connector_config = SecretDict(******)
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='beers', json_schema={'definitions...l_refresh'>, cursor_field=None, destination_sync_mode=<DestinationSyncMode.overwrite: 'overwrite'>, primary_key=None)])
expect_records_config = None, should_validate_schema = True
should_validate_data_points = False, should_fail_on_extra_columns = True
empty_streams = set(), ignored_fields = {}, expected_records_by_stream = {}
docker_runner = <connector_acceptance_test.utils.connector_runner.ConnectorRunner object at 0xffff7c294fa0>
detailed_logger = <Logger detailed_logger /test_input/acceptance_tests_logs/test_core.py__TestBasicRead__test_read[inputs0].txt (DEBUG)>

    def test_read(
        self,
        connector_config,
        configured_catalog,
        expect_records_config: ExpectedRecordsConfig,
        should_validate_schema: Boolean,
        should_validate_data_points: Boolean,
        should_fail_on_extra_columns: Boolean,
        empty_streams: Set[EmptyStreamConfiguration],
        ignored_fields: Optional[Mapping[str, List[IgnoredFieldsConfiguration]]],
        expected_records_by_stream: MutableMapping[str, List[MutableMapping]],
        docker_runner: ConnectorRunner,
        detailed_logger,
    ):
        output = docker_runner.call_read(connector_config, configured_catalog)
        records = [message.record for message in filter_output(output, Type.RECORD)]
    
        assert records, "At least one record should be read using provided catalog"
    
        if should_validate_schema:  # TODO Conditional logic
>           self._validate_schema(
                records=records, configured_catalog=configured_catalog, fail_on_extra_columns=should_fail_on_extra_columns
            )

connector_acceptance_test/tests/test_core.py:823: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

records = [AirbyteRecordMessage(namespace=None, stream='beers', data={'id': 1, 'name': 'Buzz', 'tagline': 'A Real Bitter Experie... get the right spicy esters in the beer.', 'contributed_by': 'Sam Mason <samjbmason>'}, emitted_at=1679408781680), ...]
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='beers', json_schema={'definitions...l_refresh'>, cursor_field=None, destination_sync_mode=<DestinationSyncMode.overwrite: 'overwrite'>, primary_key=None)])
fail_on_extra_columns = True

    @staticmethod
    def _validate_schema(records: List[AirbyteRecordMessage], configured_catalog: ConfiguredAirbyteCatalog, fail_on_extra_columns: Boolean):
        """
        Check if data type and structure in records matches the one in json_schema of the stream in catalog
        """
        TestBasicRead._validate_records_structure(records, configured_catalog)
        bar = "-" * 80
        streams_errors = verify_records_schema(records, configured_catalog, fail_on_extra_columns)
        for stream_name, errors in streams_errors.items():
            errors = map(str, errors.values())
            str_errors = f"\n{bar}\n".join(errors)
            logging.error(f"\nThe {stream_name} stream has the following schema errors:\n{str_errors}")
    
        if streams_errors:
>           pytest.fail(f"Please check your json_schema in selected streams {tuple(streams_errors.keys())}.")
E           Failed: Please check your json_schema in selected streams ('beers', 'beers_with_id').

connector_acceptance_test/tests/test_core.py:665: Failed
----------------------------- Captured stdout call -----------------------------
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe beers stream has the following schema errors:\nAdditional properties are not allowed ('first_brewed', 'abv', 'attenuation_level', 'id', 'ebc', 'target_fg', 'boil_volume', 'ingredients', 'ibu', 'contributed_by', 'ph', 'target_og', 'srm', 'brewers_tips', 'volume', 'tagline', 'description', 'image_url', 'food_pairing', 'method', 'name' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$id': 'https://example.com/object1667227839.json',\n     '$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'default': [],\n     'definitions': {},\n     'items': {'$id': '#root/items',\n               'properties': {'abv': {'$id': '#root/items/abv',\n                                      'default': 0.0,\n                                      'title': 'Abv',\n                                      'type': 'number'},\n                              'attenuation_level': {'$id': '#root/items/attenuation_level',\n                                                    'default': 0,\n                                                    'title': 'Attenuation_level',\n                                                    'type': ['null',\n                                                             'number',\n                                                             'integer',\n                                                             'string']},\n                              'boil_volume': {'$id': '#root/items/boil_volume',\n                                              'properties': {'unit': {'$id': '#root/items/boil_volume/unit',\n                                                                      'default': '',\n                                                                      'pattern': '^.*$',\n                                                                      'title': 'Unit',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object',\n                                                                               'string']},\n                                                             'value': {'$id': '#root/items/boil_volume/value',\n                                                                       'default': 0,\n                                                                       'title': 'Value',\n                                                                       'type': ['null',\n                                                                                'number',\n                                                                                'integer']}},\n                                              'title': 'Boil_volume',\n                                              'type': ['null', 'object']},\n                              'brewers_tips': {'$id': '#root/items/brewers_tips',\n                                               'default': '',\n                                               'pattern': '^.*$',\n                                               'title': 'Brewers_tips',\n                                               'type': ['null',\n                                                        'array',\n                                                        'object',\n                                                        'string']},\n                              'contributed_by': {'$id': '#root/items/contributed_by',\n                                                 'default': '',\n                                                 'pattern': '^.*$',\n                                                 'title': 'Contributed_by',\n                                                 'type': ['null',\n                                                          'array',\n                                                          'object',\n                                                          'string']},\n                              'description': {'$id': '#root/items/description',\n                                              'default': '',\n                                              'pattern': '^.*$',\n                                              'title': 'Description',\n                                              'type': ['null',\n                                                       'array',\n                                                       'object',\n                                                       'string']},\n                              'ebc': {'$id': '#root/items/ebc',\n                                      'default': 0,\n                                      'title': 'Ebc',\n                                      'type': ['null',\n                                               'number',\n                                               'integer',\n                                               'string']},\n                              'first_brewed': {'$id': '#root/items/first_brewed',\n                                               'default': '',\n                                               'pattern': '^.*$',\n                                               'title': 'First_brewed',\n                                               'type': ['null',\n                                                        'array',\n                                                        'object',\n                                                        'string']},\n                              'food_pairing': {'$id': '#root/items/food_pairing',\n                                               'default': [],\n                                               'items': {'$id': '#root/items/food_pairing/items',\n                                                         'default': '',\n                                                         'pattern': '^.*$',\n                                                         'title': 'Items',\n                                                         'type': ['null',\n                                                                  'array',\n                                                                  'object',\n                                                                  'string']},\n                                               'title': 'Food_pairing',\n                                               'type': ['null',\n                                                        'array',\n                                                        'object']},\n                              'ibu': {'$id': '#root/items/ibu',\n                                      'default': 0,\n                                      'title': 'Ibu',\n                                      'type': ['null',\n                                               'number',\n                                               'integer']},\n                              'id': {'$id': '#root/items/id',\n                                     'default': 0,\n                                     'title': 'Id',\n                                     'type': 'integer'},\n                              'image_url': {'$id': '#root/items/image_url',\n                                            'default': '',\n                                            'pattern': '^.*$',\n                                            'title': 'Image_url',\n                                            'type': ['null',\n                                                     'array',\n                                                     'object',\n                                                     'string']},\n                              'ingredients': {'$id': '#root/items/ingredients',\n                                              'properties': {'hops': {'$id': '#root/items/ingredients/hops',\n                                                                      'default': [],\n                                                                      'items': {'$id': '#root/items/ingredients/hops/items',\n                                                                                'properties': {'add': {'$id': '#root/items/ingredients/hops/items/add',\n                                                                                                       'default': '',\n                                                                                                       'pattern': '^.*$',\n                                                                                                       'title': 'Add',\n                                                                                                       'type': ['null',\n                                                                                                                'array',\n                                                                                                                'object',\n                                                                                                                'string']},\n                                                                                               'amount': {'$id': '#root/items/ingredients/hops/items/amount',\n                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/hops/items/amount/unit',\n                                                                                                                                  'default': '',\n                                                                                                                                  'pattern': '^.*$',\n                                                                                                                                  'title': 'Unit',\n                                                                                                                                  'type': ['null',\n                                                                                                                                           'array',\n                                                                                                                                           'object',\n                                                                                                                                           'string']},\n                                                                                                                         'value': {'$id': '#root/items/ingredients/hops/items/amount/value',\n                                                                                                                                   'default': 0,\n                                                                                                                                   'title': 'Value',\n                                                                                                                                   'type': ['null',\n                                                                                                                                            'number',\n                                                                                                                                            'integer']}},\n                                                                                                          'title': 'Amount',\n                                                                                                          'type': ['null',\n                                                                                                                   'object']},\n                                                                                               'attribute': {'$id': '#root/items/ingredients/hops/items/attribute',\n                                                                                                             'default': '',\n                                                                                                             'pattern': '^.*$',\n                                                                                                             'title': 'Attribute',\n                                                                                                             'type': ['null',\n                                                                                                                      'array',\n                                                                                                                      'object',\n                                                                                                                      'string']},\n                                                                                               'name': {'$id': '#root/items/ingredients/hops/items/name',\n                                                                                                        'default': '',\n                                                                                                        'pattern': '^.*$',\n                                                                                                        'title': 'Name',\n                                                                                                        'type': ['null',\n                                                                                                                 'array',\n                                                                                                                 'object',\n                                                                                                                 'string']}},\n                                                                                'title': 'Items',\n                                                                                'type': ['null',\n                                                                                         'object']},\n                                                                      'title': 'Hops',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object']},\n                                                             'malt': {'$id': '#root/items/ingredients/malt',\n                                                                      'default': [],\n                                                                      'items': {'$id': '#root/items/ingredients/malt/items',\n                                                                                'properties': {'amount': {'$id': '#root/items/ingredients/malt/items/amount',\n                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/malt/items/amount/unit',\n                                                                                                                                  'default': '',\n                                                                                                                                  'pattern': '^.*$',\n                                                                                                                                  'title': 'Unit',\n                                                                                                                                  'type': ['null',\n                                                                                                                                           'array',\n                                                                                                                                           'object',\n                                                                                                                                           'string']},\n                                                                                                                         'value': {'$id': '#root/items/ingredients/malt/items/amount/value',\n                                                                                                                                   'default': 0.0,\n                                                                                                                                   'title': 'Value',\n                                                                                                                                   'type': 'number'}},\n                                                                                                          'title': 'Amount',\n                                                                                                          'type': ['null',\n                                                                                                                   'object']},\n                                                                                               'name': {'$id': '#root/items/ingredients/malt/items/name',\n                                                                                                        'default': '',\n                                                                                                        'pattern': '^.*$',\n                                                                                                        'title': 'Name',\n                                                                                                        'type': ['null',\n                                                                                                                 'array',\n                                                                                                                 'object',\n                                                                                                                 'string']}},\n                                                                                'title': 'Items',\n                                                                                'type': ['null',\n                                                                                         'object']},\n                                                                      'title': 'Malt',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object']},\n                                                             'yeast': {'$id': '#root/items/ingredients/yeast',\n                                                                       'default': '',\n                                                                       'pattern': '^.*$',\n                                                                       'title': 'Yeast',\n                                                                       'type': ['null',\n                                                                                'array',\n                                                                                'object',\n                                                                                'string']}},\n                                              'title': 'Ingredients',\n                                              'type': ['null', 'object']},\n                              'method': {'$id': '#root/items/method',\n                                         'properties': {'fermentation': {'$id': '#root/items/method/fermentation',\n                                                                         'properties': {'temp': {'$id': '#root/items/method/fermentation/temp',\n                                                                                                 'properties': {'unit': {'$id': '#root/items/method/fermentation/temp/unit',\n                                                                                                                         'default': '',\n                                                                                                                         'pattern': '^.*$',\n                                                                                                                         'title': 'Unit',\n                                                                                                                         'type': ['null',\n                                                                                                                                  'array',\n                                                                                                                                  'object',\n                                                                                                                                  'string']},\n                                                                                                                'value': {'$id': '#root/items/method/fermentation/temp/value',\n                                                                                                                          'default': 0,\n                                                                                                                          'title': 'Value',\n                                                                                                                          'type': ['null',\n                                                                                                                                   'integer',\n                                                                                                                                   'number']}},\n                                                                                                 'title': 'Temp',\n                                                                                                 'type': ['null',\n                                                                                                          'object']}},\n                                                                         'title': 'Fermentation',\n                                                                         'type': ['null',\n                                                                                  'object']},\n                                                        'mash_temp': {'$id': '#root/items/method/mash_temp',\n                                                                      'default': [],\n                                                                      'items': {'$id': '#root/items/method/mash_temp/items',\n                                                                                'properties': {'duration': {'$id': '#root/items/method/mash_temp/items/duration',\n                                                                                                            'default': 0,\n                                                                                                            'title': 'Duration',\n                                                                                                            'type': ['null',\n                                                                                                                     'number',\n                                                                                                                     'integer']},\n                                                                                               'temp': {'$id': '#root/items/method/mash_temp/items/temp',\n                                                                                                        'properties': {'unit': {'$id': '#root/items/method/mash_temp/items/temp/unit',\n                                                                                                                                'default': '',\n                                                                                                                                'pattern': '^.*$',\n                                                                                                                                'title': 'Unit',\n                                                                                                                                'type': ['null',\n                                                                                                                                         'array',\n                                                                                                                                         'object',\n                                                                                                                                         'string']},\n                                                                                                                       'value': {'$id': '#root/items/method/mash_temp/items/temp/value',\n                                                                                                                                 'default': 0,\n                                                                                                                                 'title': 'Value',\n                                                                                                                                 'type': ['null',\n                                                                                                                                          'integer',\n                                                                                                                                          'number']}},\n                                                                                                        'title': 'Temp',\n                                                                                                        'type': ['null',\n                                                                                                                 'object']}},\n                                                                                'title': 'Items',\n                                                                                'type': ['null',\n                                                                                         'object']},\n                                                                      'title': 'Mash_temp',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object']},\n                                                        'twist': {'$id': '#root/items/method/twist',\n                                                                  'default': None,\n                                                                  'title': 'Twist',\n                                                                  'type': ['null',\n                                                                           'number',\n                                                                           'integer',\n                                                                           'string']}},\n                                         'title': 'Method',\n                                         'type': ['null', 'object']},\n                              'name': {'$id': '#root/items/name',\n                                       'default': '',\n                                       'pattern': '^.*$',\n                                       'title': 'Name',\n                                       'type': ['null',\n                                                'array',\n                                                'object',\n                                                'string']},\n                              'ph': {'$id': '#root/items/ph',\n                                     'default': 0.0,\n                                     'title': 'Ph',\n                                     'type': ['null',\n                                              'number',\n                                              'integer',\n                                              'string']},\n                              'srm': {'$id': '#root/items/srm',\n                                      'default': 0,\n                                      'title': 'Srm',\n                                      'type': ['null',\n                                               'number',\n                                               'integer',\n                                               'string']},\n                              'tagline': {'$id': '#root/items/tagline',\n                                          'default': '',\n                                          'pattern': '^.*$',\n                                          'title': 'Tagline',\n                                          'type': ['null',\n                                                   'array',\n                                                   'object',\n                                                   'string']},\n                              'target_fg': {'$id': '#root/items/target_fg',\n                                            'default': 0,\n                                            'title': 'Target_fg',\n                                            'type': ['null',\n                                                     'integer',\n                                                     'number']},\n                              'target_og': {'$id': '#root/items/target_og',\n                                            'default': 0,\n                                            'title': 'Target_og',\n                                            'type': ['null',\n                                                     'number',\n                                                     'integer']},\n                              'volume': {'$id': '#root/items/volume',\n                                         'properties': {'unit': {'$id': '#root/items/volume/unit',\n                                                                 'default': '',\n                                                                 'pattern': '^.*$',\n                                                                 'title': 'Unit',\n                                                                 'type': ['null',\n                                                                          'array',\n                                                                          'object',\n                                                                          'string']},\n                                                        'value': {'$id': '#root/items/volume/value',\n                                                                  'default': 0,\n                                                                  'title': 'Value',\n                                                                  'type': ['null',\n                                                                           'number',\n                                                                           'integer']}},\n                                         'title': 'Volume',\n                                         'type': ['null', 'object']}},\n               'title': 'Items',\n               'type': ['null', 'object']},\n     'title': 'Root',\n     'type': ['null', 'array', 'object']}\n\nOn instance:\n    {'abv': 5,\n     'attenuation_level': 86,\n     'boil_volume': {'unit': 'litres', 'value': 25},\n     'brewers_tips': 'Saphir hops are not widespread at the moment if you '\n                     'cannot get hold of any, a good batch of Mittlefruh '\n                     'is a fair substitute.',\n     'contributed_by': 'John Jenkman <johnjenkman>',\n     'description': 'A new 5% Pilsner, that feaures in Fanzine, our new '\n                    'subscription model.',\n     'ebc': 5,\n     'first_brewed': '2018',\n     'food_pairing': [\"Goat's cheese salad\",\n                      'Pesto pasta',\n                      'Lemon cookies'],\n     'ibu': 37,\n     'id': 325,\n     'image_url': None,\n     'ingredients': {'hops': [{'add': '70',\n                               'amount': {'unit': 'grams', 'value': 12},\n                               'attribute': 'Bittering',\n                               'name': 'Magnum'},\n                              {'add': '30',\n                               'amount': {'unit': 'grams', 'value': 15},\n                               'attribute': 'Flavour',\n                               'name': 'Spalter'},\n                              {'add': '10',\n                               'amount': {'unit': 'grams', 'value': 15},\n                               'attribute': 'Flavour',\n                               'name': 'Spalter'},\n                              {'add': '0',\n                               'amount': {'unit': 'grams', 'value': 30},\n                               'attribute': 'Aroma',\n                               'name': 'Saphire'},\n                              {'add': 'Dry Hop',\n                               'amount': {'unit': 'grams', 'value': 30},\n                               'attribute': 'Aroma',\n                               'name': 'Saphire'}],\n                     'malt': [{'amount': {'unit': 'kilograms',\n                                          'value': 3.54},\n                               'name': 'Pilsner'},\n                              {'amount': {'unit': 'kilograms',\n                                          'value': 0.24},\n                               'name': 'Carapils'}],\n                     'yeast': 'Saflager W-34/70'},\n     'method': {'fermentation': {'temp': {'unit': 'celsius', 'value': 11}},\n                'mash_temp': [{'duration': 50,\n                               'temp': {'unit': 'celsius', 'value': 50}}],\n                'twist': None},\n     'name': 'Zipcode',\n     'ph': 4.4,\n     'srm': 3,\n     'tagline': 'Pilsner.',\n     'target_fg': 1006,\n     'target_og': 1044,\n     'volume': {'unit': 'litres', 'value': 20}}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe beers_with_id stream has the following schema errors:\nAdditional properties are not allowed ('first_brewed', 'abv', 'attenuation_level', 'id', 'ebc', 'target_fg', 'boil_volume', 'ingredients', 'ibu', 'contributed_by', 'ph', 'target_og', 'srm', 'brewers_tips', 'volume', 'tagline', 'description', 'image_url', 'food_pairing', 'method', 'name' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'$id': 'https://example.com/object1667227839.json',\n     '$schema': 'http://json-schema.org/draft-07/schema#',\n     'additionalProperties': False,\n     'default': [],\n     'definitions': {},\n     'items': {'$id': '#root/items',\n               'properties': {'abv': {'$id': '#root/items/abv',\n                                      'default': 0.0,\n                                      'title': 'Abv',\n                                      'type': 'number'},\n                              'attenuation_level': {'$id': '#root/items/attenuation_level',\n                                                    'default': 0,\n                                                    'title': 'Attenuation_level',\n                                                    'type': ['null',\n                                                             'number',\n                                                             'integer',\n                                                             'string']},\n                              'boil_volume': {'$id': '#root/items/boil_volume',\n                                              'properties': {'unit': {'$id': '#root/items/boil_volume/unit',\n                                                                      'default': '',\n                                                                      'pattern': '^.*$',\n                                                                      'title': 'Unit',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object',\n                                                                               'string']},\n                                                             'value': {'$id': '#root/items/boil_volume/value',\n                                                                       'default': 0,\n                                                                       'title': 'Value',\n                                                                       'type': ['null',\n                                                                                'number',\n                                                                                'integer']}},\n                                              'title': 'Boil_volume',\n                                              'type': ['null', 'object']},\n                              'brewers_tips': {'$id': '#root/items/brewers_tips',\n                                               'default': '',\n                                               'pattern': '^.*$',\n                                               'title': 'Brewers_tips',\n                                               'type': ['null',\n                                                        'array',\n                                                        'object',\n                                                        'string']},\n                              'contributed_by': {'$id': '#root/items/contributed_by',\n                                                 'default': '',\n                                                 'pattern': '^.*$',\n                                                 'title': 'Contributed_by',\n                                                 'type': ['null',\n                                                          'array',\n                                                          'object',\n                                                          'string']},\n                              'description': {'$id': '#root/items/description',\n                                              'default': '',\n                                              'pattern': '^.*$',\n                                              'title': 'Description',\n                                              'type': ['null',\n                                                       'array',\n                                                       'object',\n                                                       'string']},\n                              'ebc': {'$id': '#root/items/ebc',\n                                      'default': 0,\n                                      'title': 'Ebc',\n                                      'type': ['null',\n                                               'number',\n                                               'integer',\n                                               'string']},\n                              'first_brewed': {'$id': '#root/items/first_brewed',\n                                               'default': '',\n                                               'pattern': '^.*$',\n                                               'title': 'First_brewed',\n                                               'type': ['null',\n                                                        'array',\n                                                        'object',\n                                                        'string']},\n                              'food_pairing': {'$id': '#root/items/food_pairing',\n                                               'default': [],\n                                               'items': {'$id': '#root/items/food_pairing/items',\n                                                         'default': '',\n                                                         'pattern': '^.*$',\n                                                         'title': 'Items',\n                                                         'type': ['null',\n                                                                  'array',\n                                                                  'object',\n                                                                  'string']},\n                                               'title': 'Food_pairing',\n                                               'type': ['null',\n                                                        'array',\n                                                        'object']},\n                              'ibu': {'$id': '#root/items/ibu',\n                                      'default': 0,\n                                      'title': 'Ibu',\n                                      'type': ['null',\n                                               'number',\n                                               'integer']},\n                              'id': {'$id': '#root/items/id',\n                                     'default': 0,\n                                     'title': 'Id',\n                                     'type': ['null', 'integer', 'number']},\n                              'image_url': {'$id': '#root/items/image_url',\n                                            'default': '',\n                                            'pattern': '^.*$',\n                                            'title': 'Image_url',\n                                            'type': ['null',\n                                                     'array',\n                                                     'object',\n                                                     'string']},\n                              'ingredients': {'$id': '#root/items/ingredients',\n                                              'properties': {'hops': {'$id': '#root/items/ingredients/hops',\n                                                                      'default': [],\n                                                                      'items': {'$id': '#root/items/ingredients/hops/items',\n                                                                                'properties': {'add': {'$id': '#root/items/ingredients/hops/items/add',\n                                                                                                       'default': '',\n                                                                                                       'pattern': '^.*$',\n                                                                                                       'title': 'Add',\n                                                                                                       'type': ['null',\n                                                                                                                'array',\n                                                                                                                'object',\n                                                                                                                'string']},\n                                                                                               'amount': {'$id': '#root/items/ingredients/hops/items/amount',\n                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/hops/items/amount/unit',\n                                                                                                                                  'default': '',\n                                                                                                                                  'pattern': '^.*$',\n                                                                                                                                  'title': 'Unit',\n                                                                                                                                  'type': 'string'},\n                                                                                                                         'value': {'$id': '#root/items/ingredients/hops/items/amount/value',\n                                                                                                                                   'default': 0,\n                                                                                                                                   'title': 'Value',\n                                                                                                                                   'type': ['null',\n                                                                                                                                            'number',\n                                                                                                                                            'integer']}},\n                                                                                                          'title': 'Amount',\n                                                                                                          'type': ['null',\n                                                                                                                   'object']},\n                                                                                               'attribute': {'$id': '#root/items/ingredients/hops/items/attribute',\n                                                                                                             'default': '',\n                                                                                                             'pattern': '^.*$',\n                                                                                                             'title': 'Attribute',\n                                                                                                             'type': ['null',\n                                                                                                                      'array',\n                                                                                                                      'object',\n                                                                                                                      'string']},\n                                                                                               'name': {'$id': '#root/items/ingredients/hops/items/name',\n                                                                                                        'default': '',\n                                                                                                        'pattern': '^.*$',\n                                                                                                        'title': 'Name',\n                                                                                                        'type': ['null',\n                                                                                                                 'array',\n                                                                                                                 'object',\n                                                                                                                 'string']}},\n                                                                                'title': 'Items',\n                                                                                'type': ['null',\n                                                                                         'object']},\n                                                                      'title': 'Hops',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object']},\n                                                             'malt': {'$id': '#root/items/ingredients/malt',\n                                                                      'default': [],\n                                                                      'items': {'$id': '#root/items/ingredients/malt/items',\n                                                                                'properties': {'amount': {'$id': '#root/items/ingredients/malt/items/amount',\n                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/malt/items/amount/unit',\n                                                                                                                                  'default': '',\n                                                                                                                                  'pattern': '^.*$',\n                                                                                                                                  'title': 'Unit',\n                                                                                                                                  'type': ['null',\n                                                                                                                                           'array',\n                                                                                                                                           'object',\n                                                                                                                                           'string']},\n                                                                                                                         'value': {'$id': '#root/items/ingredients/malt/items/amount/value',\n                                                                                                                                   'default': 0.0,\n                                                                                                                                   'title': 'Value',\n                                                                                                                                   'type': 'number'}},\n                                                                                                          'title': 'Amount',\n                                                                                                          'type': ['null',\n                                                                                                                   'object']},\n                                                                                               'name': {'$id': '#root/items/ingredients/malt/items/name',\n                                                                                                        'default': '',\n                                                                                                        'pattern': '^.*$',\n                                                                                                        'title': 'Name',\n                                                                                                        'type': 'string'}},\n                                                                                'title': 'Items',\n                                                                                'type': ['null',\n                                                                                         'object']},\n                                                                      'title': 'Malt',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object']},\n                                                             'yeast': {'$id': '#root/items/ingredients/yeast',\n                                                                       'default': '',\n                                                                       'pattern': '^.*$',\n                                                                       'title': 'Yeast',\n                                                                       'type': ['null',\n                                                                                'array',\n                                                                                'object',\n                                                                                'string']}},\n                                              'title': 'Ingredients',\n                                              'type': ['null', 'object']},\n                              'method': {'$id': '#root/items/method',\n                                         'properties': {'fermentation': {'$id': '#root/items/method/fermentation',\n                                                                         'properties': {'temp': {'$id': '#root/items/method/fermentation/temp',\n                                                                                                 'properties': {'unit': {'$id': '#root/items/method/fermentation/temp/unit',\n                                                                                                                         'default': '',\n                                                                                                                         'pattern': '^.*$',\n                                                                                                                         'title': 'Unit',\n                                                                                                                         'type': ['null',\n                                                                                                                                  'array',\n                                                                                                                                  'object',\n                                                                                                                                  'string']},\n                                                                                                                'value': {'$id': '#root/items/method/fermentation/temp/value',\n                                                                                                                          'default': 0,\n                                                                                                                          'title': 'Value',\n                                                                                                                          'type': ['null',\n                                                                                                                                   'integer',\n                                                                                                                                   'number']}},\n                                                                                                 'title': 'Temp',\n                                                                                                 'type': ['null',\n                                                                                                          'object']}},\n                                                                         'title': 'Fermentation',\n                                                                         'type': ['null',\n                                                                                  'object']},\n                                                        'mash_temp': {'$id': '#root/items/method/mash_temp',\n                                                                      'default': [],\n                                                                      'items': {'$id': '#root/items/method/mash_temp/items',\n                                                                                'properties': {'duration': {'$id': '#root/items/method/mash_temp/items/duration',\n                                                                                                            'default': 0,\n                                                                                                            'title': 'Duration',\n                                                                                                            'type': ['null',\n                                                                                                                     'number',\n                                                                                                                     'integer']},\n                                                                                               'temp': {'$id': '#root/items/method/mash_temp/items/temp',\n                                                                                                        'properties': {'unit': {'$id': '#root/items/method/mash_temp/items/temp/unit',\n                                                                                                                                'default': '',\n                                                                                                                                'pattern': '^.*$',\n                                                                                                                                'title': 'Unit',\n                                                                                                                                'type': ['null',\n                                                                                                                                         'array',\n                                                                                                                                         'object',\n                                                                                                                                         'string']},\n                                                                                                                       'value': {'$id': '#root/items/method/mash_temp/items/temp/value',\n                                                                                                                                 'default': 0,\n                                                                                                                                 'title': 'Value',\n                                                                                                                                 'type': ['null',\n                                                                                                                                          'integer',\n                                                                                                                                          'number']}},\n                                                                                                        'title': 'Temp',\n                                                                                                        'type': ['null',\n                                                                                                                 'object']}},\n                                                                                'title': 'Items',\n                                                                                'type': ['null',\n                                                                                         'object']},\n                                                                      'title': 'Mash_temp',\n                                                                      'type': ['null',\n                                                                               'array',\n                                                                               'object']},\n                                                        'twist': {'$id': '#root/items/method/twist',\n                                                                  'default': None,\n                                                                  'title': 'Twist',\n                                                                  'type': ['null',\n                                                                           'number',\n                                                                           'integer',\n                                                                           'string']}},\n                                         'title': 'Method',\n                                         'type': ['null', 'object']},\n                              'name': {'$id': '#root/items/name',\n                                       'default': '',\n                                       'pattern': '^.*$',\n                                       'title': 'Name',\n                                       'type': ['null',\n                                                'array',\n                                                'object',\n                                                'string']},\n                              'ph': {'$id': '#root/items/ph',\n                                     'default': 0.0,\n                                     'title': 'Ph',\n                                     'type': ['null',\n                                              'number',\n                                              'integer',\n                                              'string']},\n                              'srm': {'$id': '#root/items/srm',\n                                      'default': 0,\n                                      'title': 'Srm',\n                                      'type': ['null',\n                                               'number',\n                                               'integer',\n                                               'string']},\n                              'tagline': {'$id': '#root/items/tagline',\n                                          'default': '',\n                                          'pattern': '^.*$',\n                                          'title': 'Tagline',\n                                          'type': ['null',\n                                                   'array',\n                                                   'object',\n                                                   'string']},\n                              'target_fg': {'$id': '#root/items/target_fg',\n                                            'default': 0,\n                                            'title': 'Target_fg',\n                                            'type': ['null',\n                                                     'integer',\n                                                     'number']},\n                              'target_og': {'$id': '#root/items/target_og',\n                                            'default': 0,\n                                            'title': 'Target_og',\n                                            'type': ['null',\n                                                     'number',\n                                                     'integer']},\n                              'volume': {'$id': '#root/items/volume',\n                                         'properties': {'unit': {'$id': '#root/items/volume/unit',\n                                                                 'default': '',\n                                                                 'pattern': '^.*$',\n                                                                 'title': 'Unit',\n                                                                 'type': ['null',\n                                                                          'array',\n                                                                          'object',\n                                                                          'string']},\n                                                        'value': {'$id': '#root/items/volume/value',\n                                                                  'default': 0,\n                                                                  'title': 'Value',\n                                                                  'type': ['null',\n                                                                           'number',\n                                                                           'integer']}},\n                                         'title': 'Volume',\n                                         'type': ['null', 'object']}},\n               'title': 'Items',\n               'type': ['null', 'object']},\n     'title': 'Root',\n     'type': ['null', 'array', 'object']}\n\nOn instance:\n    {'abv': 5,\n     'attenuation_level': 86,\n     'boil_volume': {'unit': 'litres', 'value': 25},\n     'brewers_tips': 'Saphir hops are not widespread at the moment if you '\n                     'cannot get hold of any, a good batch of Mittlefruh '\n                     'is a fair substitute.',\n     'contributed_by': 'John Jenkman <johnjenkman>',\n     'description': 'A new 5% Pilsner, that feaures in Fanzine, our new '\n                    'subscription model.',\n     'ebc': 5,\n     'first_brewed': '2018',\n     'food_pairing': [\"Goat's cheese salad\",\n                      'Pesto pasta',\n                      'Lemon cookies'],\n     'ibu': 37,\n     'id': 325,\n     'image_url': None,\n     'ingredients': {'hops': [{'add': '70',\n                               'amount': {'unit': 'grams', 'value': 12},\n                               'attribute': 'Bittering',\n                               'name': 'Magnum'},\n                              {'add': '30',\n                               'amount': {'unit': 'grams', 'value': 15},\n                               'attribute': 'Flavour',\n                               'name': 'Spalter'},\n                              {'add': '10',\n                               'amount': {'unit': 'grams', 'value': 15},\n                               'attribute': 'Flavour',\n                               'name': 'Spalter'},\n                              {'add': '0',\n                               'amount': {'unit': 'grams', 'value': 30},\n                               'attribute': 'Aroma',\n                               'name': 'Saphire'},\n                              {'add': 'Dry Hop',\n                               'amount': {'unit': 'grams', 'value': 30},\n                               'attribute': 'Aroma',\n                               'name': 'Saphire'}],\n                     'malt': [{'amount': {'unit': 'kilograms',\n                                          'value': 3.54},\n                               'name': 'Pilsner'},\n                              {'amount': {'unit': 'kilograms',\n                                          'value': 0.24},\n                               'name': 'Carapils'}],\n                     'yeast': 'Saflager W-34/70'},\n     'method': {'fermentation': {'temp': {'unit': 'celsius', 'value': 11}},\n                'mash_temp': [{'duration': 50,\n                               'temp': {'unit': 'celsius', 'value': 50}}],\n                'twist': None},\n     'name': 'Zipcode',\n     'ph': 4.4,\n     'srm': 3,\n     'tagline': 'Pilsner.',\n     'target_fg': 1006,\n     'target_og': 1044,\n     'volume': {'unit': 'litres', 'value': 20}}"}}
------------------------------ Captured log call -------------------------------
ERROR    root:test_core.py:662 
The beers stream has the following schema errors:
Additional properties are not allowed ('first_brewed', 'abv', 'attenuation_level', 'id', 'ebc', 'target_fg', 'boil_volume', 'ingredients', 'ibu', 'contributed_by', 'ph', 'target_og', 'srm', 'brewers_tips', 'volume', 'tagline', 'description', 'image_url', 'food_pairing', 'method', 'name' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$id': 'https://example.com/object1667227839.json',
     '$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'default': [],
     'definitions': {},
     'items': {'$id': '#root/items',
               'properties': {'abv': {'$id': '#root/items/abv',
                                      'default': 0.0,
                                      'title': 'Abv',
                                      'type': 'number'},
                              'attenuation_level': {'$id': '#root/items/attenuation_level',
                                                    'default': 0,
                                                    'title': 'Attenuation_level',
                                                    'type': ['null',
                                                             'number',
                                                             'integer',
                                                             'string']},
                              'boil_volume': {'$id': '#root/items/boil_volume',
                                              'properties': {'unit': {'$id': '#root/items/boil_volume/unit',
                                                                      'default': '',
                                                                      'pattern': '^.*$',
                                                                      'title': 'Unit',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object',
                                                                               'string']},
                                                             'value': {'$id': '#root/items/boil_volume/value',
                                                                       'default': 0,
                                                                       'title': 'Value',
                                                                       'type': ['null',
                                                                                'number',
                                                                                'integer']}},
                                              'title': 'Boil_volume',
                                              'type': ['null', 'object']},
                              'brewers_tips': {'$id': '#root/items/brewers_tips',
                                               'default': '',
                                               'pattern': '^.*$',
                                               'title': 'Brewers_tips',
                                               'type': ['null',
                                                        'array',
                                                        'object',
                                                        'string']},
                              'contributed_by': {'$id': '#root/items/contributed_by',
                                                 'default': '',
                                                 'pattern': '^.*$',
                                                 'title': 'Contributed_by',
                                                 'type': ['null',
                                                          'array',
                                                          'object',
                                                          'string']},
                              'description': {'$id': '#root/items/description',
                                              'default': '',
                                              'pattern': '^.*$',
                                              'title': 'Description',
                                              'type': ['null',
                                                       'array',
                                                       'object',
                                                       'string']},
                              'ebc': {'$id': '#root/items/ebc',
                                      'default': 0,
                                      'title': 'Ebc',
                                      'type': ['null',
                                               'number',
                                               'integer',
                                               'string']},
                              'first_brewed': {'$id': '#root/items/first_brewed',
                                               'default': '',
                                               'pattern': '^.*$',
                                               'title': 'First_brewed',
                                               'type': ['null',
                                                        'array',
                                                        'object',
                                                        'string']},
                              'food_pairing': {'$id': '#root/items/food_pairing',
                                               'default': [],
                                               'items': {'$id': '#root/items/food_pairing/items',
                                                         'default': '',
                                                         'pattern': '^.*$',
                                                         'title': 'Items',
                                                         'type': ['null',
                                                                  'array',
                                                                  'object',
                                                                  'string']},
                                               'title': 'Food_pairing',
                                               'type': ['null',
                                                        'array',
                                                        'object']},
                              'ibu': {'$id': '#root/items/ibu',
                                      'default': 0,
                                      'title': 'Ibu',
                                      'type': ['null',
                                               'number',
                                               'integer']},
                              'id': {'$id': '#root/items/id',
                                     'default': 0,
                                     'title': 'Id',
                                     'type': 'integer'},
                              'image_url': {'$id': '#root/items/image_url',
                                            'default': '',
                                            'pattern': '^.*$',
                                            'title': 'Image_url',
                                            'type': ['null',
                                                     'array',
                                                     'object',
                                                     'string']},
                              'ingredients': {'$id': '#root/items/ingredients',
                                              'properties': {'hops': {'$id': '#root/items/ingredients/hops',
                                                                      'default': [],
                                                                      'items': {'$id': '#root/items/ingredients/hops/items',
                                                                                'properties': {'add': {'$id': '#root/items/ingredients/hops/items/add',
                                                                                                       'default': '',
                                                                                                       'pattern': '^.*$',
                                                                                                       'title': 'Add',
                                                                                                       'type': ['null',
                                                                                                                'array',
                                                                                                                'object',
                                                                                                                'string']},
                                                                                               'amount': {'$id': '#root/items/ingredients/hops/items/amount',
                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/hops/items/amount/unit',
                                                                                                                                  'default': '',
                                                                                                                                  'pattern': '^.*$',
                                                                                                                                  'title': 'Unit',
                                                                                                                                  'type': ['null',
                                                                                                                                           'array',
                                                                                                                                           'object',
                                                                                                                                           'string']},
                                                                                                                         'value': {'$id': '#root/items/ingredients/hops/items/amount/value',
                                                                                                                                   'default': 0,
                                                                                                                                   'title': 'Value',
                                                                                                                                   'type': ['null',
                                                                                                                                            'number',
                                                                                                                                            'integer']}},
                                                                                                          'title': 'Amount',
                                                                                                          'type': ['null',
                                                                                                                   'object']},
                                                                                               'attribute': {'$id': '#root/items/ingredients/hops/items/attribute',
                                                                                                             'default': '',
                                                                                                             'pattern': '^.*$',
                                                                                                             'title': 'Attribute',
                                                                                                             'type': ['null',
                                                                                                                      'array',
                                                                                                                      'object',
                                                                                                                      'string']},
                                                                                               'name': {'$id': '#root/items/ingredients/hops/items/name',
                                                                                                        'default': '',
                                                                                                        'pattern': '^.*$',
                                                                                                        'title': 'Name',
                                                                                                        'type': ['null',
                                                                                                                 'array',
                                                                                                                 'object',
                                                                                                                 'string']}},
                                                                                'title': 'Items',
                                                                                'type': ['null',
                                                                                         'object']},
                                                                      'title': 'Hops',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object']},
                                                             'malt': {'$id': '#root/items/ingredients/malt',
                                                                      'default': [],
                                                                      'items': {'$id': '#root/items/ingredients/malt/items',
                                                                                'properties': {'amount': {'$id': '#root/items/ingredients/malt/items/amount',
                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/malt/items/amount/unit',
                                                                                                                                  'default': '',
                                                                                                                                  'pattern': '^.*$',
                                                                                                                                  'title': 'Unit',
                                                                                                                                  'type': ['null',
                                                                                                                                           'array',
                                                                                                                                           'object',
                                                                                                                                           'string']},
                                                                                                                         'value': {'$id': '#root/items/ingredients/malt/items/amount/value',
                                                                                                                                   'default': 0.0,
                                                                                                                                   'title': 'Value',
                                                                                                                                   'type': 'number'}},
                                                                                                          'title': 'Amount',
                                                                                                          'type': ['null',
                                                                                                                   'object']},
                                                                                               'name': {'$id': '#root/items/ingredients/malt/items/name',
                                                                                                        'default': '',
                                                                                                        'pattern': '^.*$',
                                                                                                        'title': 'Name',
                                                                                                        'type': ['null',
                                                                                                                 'array',
                                                                                                                 'object',
                                                                                                                 'string']}},
                                                                                'title': 'Items',
                                                                                'type': ['null',
                                                                                         'object']},
                                                                      'title': 'Malt',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object']},
                                                             'yeast': {'$id': '#root/items/ingredients/yeast',
                                                                       'default': '',
                                                                       'pattern': '^.*$',
                                                                       'title': 'Yeast',
                                                                       'type': ['null',
                                                                                'array',
                                                                                'object',
                                                                                'string']}},
                                              'title': 'Ingredients',
                                              'type': ['null', 'object']},
                              'method': {'$id': '#root/items/method',
                                         'properties': {'fermentation': {'$id': '#root/items/method/fermentation',
                                                                         'properties': {'temp': {'$id': '#root/items/method/fermentation/temp',
                                                                                                 'properties': {'unit': {'$id': '#root/items/method/fermentation/temp/unit',
                                                                                                                         'default': '',
                                                                                                                         'pattern': '^.*$',
                                                                                                                         'title': 'Unit',
                                                                                                                         'type': ['null',
                                                                                                                                  'array',
                                                                                                                                  'object',
                                                                                                                                  'string']},
                                                                                                                'value': {'$id': '#root/items/method/fermentation/temp/value',
                                                                                                                          'default': 0,
                                                                                                                          'title': 'Value',
                                                                                                                          'type': ['null',
                                                                                                                                   'integer',
                                                                                                                                   'number']}},
                                                                                                 'title': 'Temp',
                                                                                                 'type': ['null',
                                                                                                          'object']}},
                                                                         'title': 'Fermentation',
                                                                         'type': ['null',
                                                                                  'object']},
                                                        'mash_temp': {'$id': '#root/items/method/mash_temp',
                                                                      'default': [],
                                                                      'items': {'$id': '#root/items/method/mash_temp/items',
                                                                                'properties': {'duration': {'$id': '#root/items/method/mash_temp/items/duration',
                                                                                                            'default': 0,
                                                                                                            'title': 'Duration',
                                                                                                            'type': ['null',
                                                                                                                     'number',
                                                                                                                     'integer']},
                                                                                               'temp': {'$id': '#root/items/method/mash_temp/items/temp',
                                                                                                        'properties': {'unit': {'$id': '#root/items/method/mash_temp/items/temp/unit',
                                                                                                                                'default': '',
                                                                                                                                'pattern': '^.*$',
                                                                                                                                'title': 'Unit',
                                                                                                                                'type': ['null',
                                                                                                                                         'array',
                                                                                                                                         'object',
                                                                                                                                         'string']},
                                                                                                                       'value': {'$id': '#root/items/method/mash_temp/items/temp/value',
                                                                                                                                 'default': 0,
                                                                                                                                 'title': 'Value',
                                                                                                                                 'type': ['null',
                                                                                                                                          'integer',
                                                                                                                                          'number']}},
                                                                                                        'title': 'Temp',
                                                                                                        'type': ['null',
                                                                                                                 'object']}},
                                                                                'title': 'Items',
                                                                                'type': ['null',
                                                                                         'object']},
                                                                      'title': 'Mash_temp',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object']},
                                                        'twist': {'$id': '#root/items/method/twist',
                                                                  'default': None,
                                                                  'title': 'Twist',
                                                                  'type': ['null',
                                                                           'number',
                                                                           'integer',
                                                                           'string']}},
                                         'title': 'Method',
                                         'type': ['null', 'object']},
                              'name': {'$id': '#root/items/name',
                                       'default': '',
                                       'pattern': '^.*$',
                                       'title': 'Name',
                                       'type': ['null',
                                                'array',
                                                'object',
                                                'string']},
                              'ph': {'$id': '#root/items/ph',
                                     'default': 0.0,
                                     'title': 'Ph',
                                     'type': ['null',
                                              'number',
                                              'integer',
                                              'string']},
                              'srm': {'$id': '#root/items/srm',
                                      'default': 0,
                                      'title': 'Srm',
                                      'type': ['null',
                                               'number',
                                               'integer',
                                               'string']},
                              'tagline': {'$id': '#root/items/tagline',
                                          'default': '',
                                          'pattern': '^.*$',
                                          'title': 'Tagline',
                                          'type': ['null',
                                                   'array',
                                                   'object',
                                                   'string']},
                              'target_fg': {'$id': '#root/items/target_fg',
                                            'default': 0,
                                            'title': 'Target_fg',
                                            'type': ['null',
                                                     'integer',
                                                     'number']},
                              'target_og': {'$id': '#root/items/target_og',
                                            'default': 0,
                                            'title': 'Target_og',
                                            'type': ['null',
                                                     'number',
                                                     'integer']},
                              'volume': {'$id': '#root/items/volume',
                                         'properties': {'unit': {'$id': '#root/items/volume/unit',
                                                                 'default': '',
                                                                 'pattern': '^.*$',
                                                                 'title': 'Unit',
                                                                 'type': ['null',
                                                                          'array',
                                                                          'object',
                                                                          'string']},
                                                        'value': {'$id': '#root/items/volume/value',
                                                                  'default': 0,
                                                                  'title': 'Value',
                                                                  'type': ['null',
                                                                           'number',
                                                                           'integer']}},
                                         'title': 'Volume',
                                         'type': ['null', 'object']}},
               'title': 'Items',
               'type': ['null', 'object']},
     'title': 'Root',
     'type': ['null', 'array', 'object']}

On instance:
    {'abv': 5,
     'attenuation_level': 86,
     'boil_volume': {'unit': 'litres', 'value': 25},
     'brewers_tips': 'Saphir hops are not widespread at the moment if you '
                     'cannot get hold of any, a good batch of Mittlefruh '
                     'is a fair substitute.',
     'contributed_by': 'John Jenkman <johnjenkman>',
     'description': 'A new 5% Pilsner, that feaures in Fanzine, our new '
                    'subscription model.',
     'ebc': 5,
     'first_brewed': '2018',
     'food_pairing': ["Goat's cheese salad",
                      'Pesto pasta',
                      'Lemon cookies'],
     'ibu': 37,
     'id': 325,
     'image_url': None,
     'ingredients': {'hops': [{'add': '70',
                               'amount': {'unit': 'grams', 'value': 12},
                               'attribute': 'Bittering',
                               'name': 'Magnum'},
                              {'add': '30',
                               'amount': {'unit': 'grams', 'value': 15},
                               'attribute': 'Flavour',
                               'name': 'Spalter'},
                              {'add': '10',
                               'amount': {'unit': 'grams', 'value': 15},
                               'attribute': 'Flavour',
                               'name': 'Spalter'},
                              {'add': '0',
                               'amount': {'unit': 'grams', 'value': 30},
                               'attribute': 'Aroma',
                               'name': 'Saphire'},
                              {'add': 'Dry Hop',
                               'amount': {'unit': 'grams', 'value': 30},
                               'attribute': 'Aroma',
                               'name': 'Saphire'}],
                     'malt': [{'amount': {'unit': 'kilograms',
                                          'value': 3.54},
                               'name': 'Pilsner'},
                              {'amount': {'unit': 'kilograms',
                                          'value': 0.24},
                               'name': 'Carapils'}],
                     'yeast': 'Saflager W-34/70'},
     'method': {'fermentation': {'temp': {'unit': 'celsius', 'value': 11}},
                'mash_temp': [{'duration': 50,
                               'temp': {'unit': 'celsius', 'value': 50}}],
                'twist': None},
     'name': 'Zipcode',
     'ph': 4.4,
     'srm': 3,
     'tagline': 'Pilsner.',
     'target_fg': 1006,
     'target_og': 1044,
     'volume': {'unit': 'litres', 'value': 20}}
ERROR    root:test_core.py:662 
The beers_with_id stream has the following schema errors:
Additional properties are not allowed ('first_brewed', 'abv', 'attenuation_level', 'id', 'ebc', 'target_fg', 'boil_volume', 'ingredients', 'ibu', 'contributed_by', 'ph', 'target_og', 'srm', 'brewers_tips', 'volume', 'tagline', 'description', 'image_url', 'food_pairing', 'method', 'name' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'$id': 'https://example.com/object1667227839.json',
     '$schema': 'http://json-schema.org/draft-07/schema#',
     'additionalProperties': False,
     'default': [],
     'definitions': {},
     'items': {'$id': '#root/items',
               'properties': {'abv': {'$id': '#root/items/abv',
                                      'default': 0.0,
                                      'title': 'Abv',
                                      'type': 'number'},
                              'attenuation_level': {'$id': '#root/items/attenuation_level',
                                                    'default': 0,
                                                    'title': 'Attenuation_level',
                                                    'type': ['null',
                                                             'number',
                                                             'integer',
                                                             'string']},
                              'boil_volume': {'$id': '#root/items/boil_volume',
                                              'properties': {'unit': {'$id': '#root/items/boil_volume/unit',
                                                                      'default': '',
                                                                      'pattern': '^.*$',
                                                                      'title': 'Unit',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object',
                                                                               'string']},
                                                             'value': {'$id': '#root/items/boil_volume/value',
                                                                       'default': 0,
                                                                       'title': 'Value',
                                                                       'type': ['null',
                                                                                'number',
                                                                                'integer']}},
                                              'title': 'Boil_volume',
                                              'type': ['null', 'object']},
                              'brewers_tips': {'$id': '#root/items/brewers_tips',
                                               'default': '',
                                               'pattern': '^.*$',
                                               'title': 'Brewers_tips',
                                               'type': ['null',
                                                        'array',
                                                        'object',
                                                        'string']},
                              'contributed_by': {'$id': '#root/items/contributed_by',
                                                 'default': '',
                                                 'pattern': '^.*$',
                                                 'title': 'Contributed_by',
                                                 'type': ['null',
                                                          'array',
                                                          'object',
                                                          'string']},
                              'description': {'$id': '#root/items/description',
                                              'default': '',
                                              'pattern': '^.*$',
                                              'title': 'Description',
                                              'type': ['null',
                                                       'array',
                                                       'object',
                                                       'string']},
                              'ebc': {'$id': '#root/items/ebc',
                                      'default': 0,
                                      'title': 'Ebc',
                                      'type': ['null',
                                               'number',
                                               'integer',
                                               'string']},
                              'first_brewed': {'$id': '#root/items/first_brewed',
                                               'default': '',
                                               'pattern': '^.*$',
                                               'title': 'First_brewed',
                                               'type': ['null',
                                                        'array',
                                                        'object',
                                                        'string']},
                              'food_pairing': {'$id': '#root/items/food_pairing',
                                               'default': [],
                                               'items': {'$id': '#root/items/food_pairing/items',
                                                         'default': '',
                                                         'pattern': '^.*$',
                                                         'title': 'Items',
                                                         'type': ['null',
                                                                  'array',
                                                                  'object',
                                                                  'string']},
                                               'title': 'Food_pairing',
                                               'type': ['null',
                                                        'array',
                                                        'object']},
                              'ibu': {'$id': '#root/items/ibu',
                                      'default': 0,
                                      'title': 'Ibu',
                                      'type': ['null',
                                               'number',
                                               'integer']},
                              'id': {'$id': '#root/items/id',
                                     'default': 0,
                                     'title': 'Id',
                                     'type': ['null', 'integer', 'number']},
                              'image_url': {'$id': '#root/items/image_url',
                                            'default': '',
                                            'pattern': '^.*$',
                                            'title': 'Image_url',
                                            'type': ['null',
                                                     'array',
                                                     'object',
                                                     'string']},
                              'ingredients': {'$id': '#root/items/ingredients',
                                              'properties': {'hops': {'$id': '#root/items/ingredients/hops',
                                                                      'default': [],
                                                                      'items': {'$id': '#root/items/ingredients/hops/items',
                                                                                'properties': {'add': {'$id': '#root/items/ingredients/hops/items/add',
                                                                                                       'default': '',
                                                                                                       'pattern': '^.*$',
                                                                                                       'title': 'Add',
                                                                                                       'type': ['null',
                                                                                                                'array',
                                                                                                                'object',
                                                                                                                'string']},
                                                                                               'amount': {'$id': '#root/items/ingredients/hops/items/amount',
                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/hops/items/amount/unit',
                                                                                                                                  'default': '',
                                                                                                                                  'pattern': '^.*$',
                                                                                                                                  'title': 'Unit',
                                                                                                                                  'type': 'string'},
                                                                                                                         'value': {'$id': '#root/items/ingredients/hops/items/amount/value',
                                                                                                                                   'default': 0,
                                                                                                                                   'title': 'Value',
                                                                                                                                   'type': ['null',
                                                                                                                                            'number',
                                                                                                                                            'integer']}},
                                                                                                          'title': 'Amount',
                                                                                                          'type': ['null',
                                                                                                                   'object']},
                                                                                               'attribute': {'$id': '#root/items/ingredients/hops/items/attribute',
                                                                                                             'default': '',
                                                                                                             'pattern': '^.*$',
                                                                                                             'title': 'Attribute',
                                                                                                             'type': ['null',
                                                                                                                      'array',
                                                                                                                      'object',
                                                                                                                      'string']},
                                                                                               'name': {'$id': '#root/items/ingredients/hops/items/name',
                                                                                                        'default': '',
                                                                                                        'pattern': '^.*$',
                                                                                                        'title': 'Name',
                                                                                                        'type': ['null',
                                                                                                                 'array',
                                                                                                                 'object',
                                                                                                                 'string']}},
                                                                                'title': 'Items',
                                                                                'type': ['null',
                                                                                         'object']},
                                                                      'title': 'Hops',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object']},
                                                             'malt': {'$id': '#root/items/ingredients/malt',
                                                                      'default': [],
                                                                      'items': {'$id': '#root/items/ingredients/malt/items',
                                                                                'properties': {'amount': {'$id': '#root/items/ingredients/malt/items/amount',
                                                                                                          'properties': {'unit': {'$id': '#root/items/ingredients/malt/items/amount/unit',
                                                                                                                                  'default': '',
                                                                                                                                  'pattern': '^.*$',
                                                                                                                                  'title': 'Unit',
                                                                                                                                  'type': ['null',
                                                                                                                                           'array',
                                                                                                                                           'object',
                                                                                                                                           'string']},
                                                                                                                         'value': {'$id': '#root/items/ingredients/malt/items/amount/value',
                                                                                                                                   'default': 0.0,
                                                                                                                                   'title': 'Value',
                                                                                                                                   'type': 'number'}},
                                                                                                          'title': 'Amount',
                                                                                                          'type': ['null',
                                                                                                                   'object']},
                                                                                               'name': {'$id': '#root/items/ingredients/malt/items/name',
                                                                                                        'default': '',
                                                                                                        'pattern': '^.*$',
                                                                                                        'title': 'Name',
                                                                                                        'type': 'string'}},
                                                                                'title': 'Items',
                                                                                'type': ['null',
                                                                                         'object']},
                                                                      'title': 'Malt',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object']},
                                                             'yeast': {'$id': '#root/items/ingredients/yeast',
                                                                       'default': '',
                                                                       'pattern': '^.*$',
                                                                       'title': 'Yeast',
                                                                       'type': ['null',
                                                                                'array',
                                                                                'object',
                                                                                'string']}},
                                              'title': 'Ingredients',
                                              'type': ['null', 'object']},
                              'method': {'$id': '#root/items/method',
                                         'properties': {'fermentation': {'$id': '#root/items/method/fermentation',
                                                                         'properties': {'temp': {'$id': '#root/items/method/fermentation/temp',
                                                                                                 'properties': {'unit': {'$id': '#root/items/method/fermentation/temp/unit',
                                                                                                                         'default': '',
                                                                                                                         'pattern': '^.*$',
                                                                                                                         'title': 'Unit',
                                                                                                                         'type': ['null',
                                                                                                                                  'array',
                                                                                                                                  'object',
                                                                                                                                  'string']},
                                                                                                                'value': {'$id': '#root/items/method/fermentation/temp/value',
                                                                                                                          'default': 0,
                                                                                                                          'title': 'Value',
                                                                                                                          'type': ['null',
                                                                                                                                   'integer',
                                                                                                                                   'number']}},
                                                                                                 'title': 'Temp',
                                                                                                 'type': ['null',
                                                                                                          'object']}},
                                                                         'title': 'Fermentation',
                                                                         'type': ['null',
                                                                                  'object']},
                                                        'mash_temp': {'$id': '#root/items/method/mash_temp',
                                                                      'default': [],
                                                                      'items': {'$id': '#root/items/method/mash_temp/items',
                                                                                'properties': {'duration': {'$id': '#root/items/method/mash_temp/items/duration',
                                                                                                            'default': 0,
                                                                                                            'title': 'Duration',
                                                                                                            'type': ['null',
                                                                                                                     'number',
                                                                                                                     'integer']},
                                                                                               'temp': {'$id': '#root/items/method/mash_temp/items/temp',
                                                                                                        'properties': {'unit': {'$id': '#root/items/method/mash_temp/items/temp/unit',
                                                                                                                                'default': '',
                                                                                                                                'pattern': '^.*$',
                                                                                                                                'title': 'Unit',
                                                                                                                                'type': ['null',
                                                                                                                                         'array',
                                                                                                                                         'object',
                                                                                                                                         'string']},
                                                                                                                       'value': {'$id': '#root/items/method/mash_temp/items/temp/value',
                                                                                                                                 'default': 0,
                                                                                                                                 'title': 'Value',
                                                                                                                                 'type': ['null',
                                                                                                                                          'integer',
                                                                                                                                          'number']}},
                                                                                                        'title': 'Temp',
                                                                                                        'type': ['null',
                                                                                                                 'object']}},
                                                                                'title': 'Items',
                                                                                'type': ['null',
                                                                                         'object']},
                                                                      'title': 'Mash_temp',
                                                                      'type': ['null',
                                                                               'array',
                                                                               'object']},
                                                        'twist': {'$id': '#root/items/method/twist',
                                                                  'default': None,
                                                                  'title': 'Twist',
                                                                  'type': ['null',
                                                                           'number',
                                                                           'integer',
                                                                           'string']}},
                                         'title': 'Method',
                                         'type': ['null', 'object']},
                              'name': {'$id': '#root/items/name',
                                       'default': '',
                                       'pattern': '^.*$',
                                       'title': 'Name',
                                       'type': ['null',
                                                'array',
                                                'object',
                                                'string']},
                              'ph': {'$id': '#root/items/ph',
                                     'default': 0.0,
                                     'title': 'Ph',
                                     'type': ['null',
                                              'number',
                                              'integer',
                                              'string']},
                              'srm': {'$id': '#root/items/srm',
                                      'default': 0,
                                      'title': 'Srm',
                                      'type': ['null',
                                               'number',
                                               'integer',
                                               'string']},
                              'tagline': {'$id': '#root/items/tagline',
                                          'default': '',
                                          'pattern': '^.*$',
                                          'title': 'Tagline',
                                          'type': ['null',
                                                   'array',
                                                   'object',
                                                   'string']},
                              'target_fg': {'$id': '#root/items/target_fg',
                                            'default': 0,
                                            'title': 'Target_fg',
                                            'type': ['null',
                                                     'integer',
                                                     'number']},
                              'target_og': {'$id': '#root/items/target_og',
                                            'default': 0,
                                            'title': 'Target_og',
                                            'type': ['null',
                                                     'number',
                                                     'integer']},
                              'volume': {'$id': '#root/items/volume',
                                         'properties': {'unit': {'$id': '#root/items/volume/unit',
                                                                 'default': '',
                                                                 'pattern': '^.*$',
                                                                 'title': 'Unit',
                                                                 'type': ['null',
                                                                          'array',
                                                                          'object',
                                                                          'string']},
                                                        'value': {'$id': '#root/items/volume/value',
                                                                  'default': 0,
                                                                  'title': 'Value',
                                                                  'type': ['null',
                                                                           'number',
                                                                           'integer']}},
                                         'title': 'Volume',
                                         'type': ['null', 'object']}},
               'title': 'Items',
               'type': ['null', 'object']},
     'title': 'Root',
     'type': ['null', 'array', 'object']}

On instance:
    {'abv': 5,
     'attenuation_level': 86,
     'boil_volume': {'unit': 'litres', 'value': 25},
     'brewers_tips': 'Saphir hops are not widespread at the moment if you '
                     'cannot get hold of any, a good batch of Mittlefruh '
                     'is a fair substitute.',
     'contributed_by': 'John Jenkman <johnjenkman>',
     'description': 'A new 5% Pilsner, that feaures in Fanzine, our new '
                    'subscription model.',
     'ebc': 5,
     'first_brewed': '2018',
     'food_pairing': ["Goat's cheese salad",
                      'Pesto pasta',
                      'Lemon cookies'],
     'ibu': 37,
     'id': 325,
     'image_url': None,
     'ingredients': {'hops': [{'add': '70',
                               'amount': {'unit': 'grams', 'value': 12},
                               'attribute': 'Bittering',
                               'name': 'Magnum'},
                              {'add': '30',
                               'amount': {'unit': 'grams', 'value': 15},
                               'attribute': 'Flavour',
                               'name': 'Spalter'},
                              {'add': '10',
                               'amount': {'unit': 'grams', 'value': 15},
                               'attribute': 'Flavour',
                               'name': 'Spalter'},
                              {'add': '0',
                               'amount': {'unit': 'grams', 'value': 30},
                               'attribute': 'Aroma',
                               'name': 'Saphire'},
                              {'add': 'Dry Hop',
                               'amount': {'unit': 'grams', 'value': 30},
                               'attribute': 'Aroma',
                               'name': 'Saphire'}],
                     'malt': [{'amount': {'unit': 'kilograms',
                                          'value': 3.54},
                               'name': 'Pilsner'},
                              {'amount': {'unit': 'kilograms',
                                          'value': 0.24},
                               'name': 'Carapils'}],
                     'yeast': 'Saflager W-34/70'},
     'method': {'fermentation': {'temp': {'unit': 'celsius', 'value': 11}},
                'mash_temp': [{'duration': 50,
                               'temp': {'unit': 'celsius', 'value': 50}}],
                'twist': None},
     'name': 'Zipcode',
     'ph': 4.4,
     'srm': 3,
     'tagline': 'Pilsner.',
     'target_fg': 1006,
     'target_og': 1044,
     'volume': {'unit': 'litres', 'value': 20}}
=========================== short test summary info ============================
FAILED ../../test_input/test_core.py::TestBasicRead::test_read[inputs0] - Fai...
SKIPPED [1] connector_acceptance_test/plugin.py:63: Skipping TestIncremental.test_two_sequential_reads: not found in the config.
================= 1 failed, 1 skipped, 33 deselected in 6.51s ==================
