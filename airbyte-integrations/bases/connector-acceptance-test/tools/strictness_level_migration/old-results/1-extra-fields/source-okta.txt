../../../../connectors/source-okta/acceptance-test-config.yml
/Users/ella/airbytehq/airbyte/airbyte-integrations/connectors/source-okta
============================= test session starts ==============================
platform linux -- Python 3.9.11, pytest-6.2.5, py-1.11.0, pluggy-1.0.0
rootdir: /test_input
plugins: timeout-1.4.2, hypothesis-6.54.6, requests-mock-1.9.3, cov-3.0.0, sugar-0.9.6, mock-3.6.1
collected 39 items / 37 deselected / 2 selected

../../test_input/test_core.py F                                          [ 50%]
../../test_input/test_incremental.py .                                   [100%]


=================================== FAILURES ===================================
_______________________ TestBasicRead.test_read[inputs0] _______________________

self = <connector_acceptance_test.tests.test_core.TestBasicRead object at 0xffffa3743760>
connector_config = SecretDict(******)
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='groups', json_schema={'properties...l_refresh'>, cursor_field=['id'], destination_sync_mode=<DestinationSyncMode.append: 'append'>, primary_key=[['id']])])
expect_records_config = ExpectedRecordsConfig(bypass_reason=None, path=PosixPath('integration_tests/expected_records.jsonl'), extra_fields=False, exact_order=False, extra_records=True)
should_validate_schema = True, should_validate_data_points = False
should_fail_on_extra_columns = True, empty_streams = set(), ignored_fields = {}
expected_records_by_stream = defaultdict(<class 'list'>, {'users': [{'id': '00u1o8nqx8yJbdIpH5d7', 'status': 'PASSWORD_EXPIRED', 'created': '2021-0...tps://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7/permissions/okta.users.lifecycle.suspend'}}}]})
docker_runner = <connector_acceptance_test.utils.connector_runner.ConnectorRunner object at 0xffffa2da8c10>
detailed_logger = <Logger detailed_logger /test_input/acceptance_tests_logs/test_core.py__TestBasicRead__test_read[inputs0].txt (DEBUG)>

    def test_read(
        self,
        connector_config,
        configured_catalog,
        expect_records_config: ExpectedRecordsConfig,
        should_validate_schema: Boolean,
        should_validate_data_points: Boolean,
        should_fail_on_extra_columns: Boolean,
        empty_streams: Set[EmptyStreamConfiguration],
        ignored_fields: Optional[Mapping[str, List[IgnoredFieldsConfiguration]]],
        expected_records_by_stream: MutableMapping[str, List[MutableMapping]],
        docker_runner: ConnectorRunner,
        detailed_logger,
    ):
        output = docker_runner.call_read(connector_config, configured_catalog)
        records = [message.record for message in filter_output(output, Type.RECORD)]
    
        assert records, "At least one record should be read using provided catalog"
    
        if should_validate_schema:  # TODO Conditional logic
>           self._validate_schema(
                records=records, configured_catalog=configured_catalog, fail_on_extra_columns=should_fail_on_extra_columns
            )

connector_acceptance_test/tests/test_core.py:823: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

records = [AirbyteRecordMessage(namespace=None, stream='groups', data={'id': '00gmj7cvt3E2YKzGZ5d6', 'created': '2021-04-21T21:0... {'lat': 43.5866, 'lon': 7.1242}}, 'version': 'V4', 'source': None}]}, 'target': None}, emitted_at=1679408026883), ...]
configured_catalog = ConfiguredAirbyteCatalog(streams=[ConfiguredAirbyteStream(stream=AirbyteStream(name='groups', json_schema={'properties...l_refresh'>, cursor_field=['id'], destination_sync_mode=<DestinationSyncMode.append: 'append'>, primary_key=[['id']])])
fail_on_extra_columns = True

    @staticmethod
    def _validate_schema(records: List[AirbyteRecordMessage], configured_catalog: ConfiguredAirbyteCatalog, fail_on_extra_columns: Boolean):
        """
        Check if data type and structure in records matches the one in json_schema of the stream in catalog
        """
        TestBasicRead._validate_records_structure(records, configured_catalog)
        bar = "-" * 80
        streams_errors = verify_records_schema(records, configured_catalog, fail_on_extra_columns)
        for stream_name, errors in streams_errors.items():
            errors = map(str, errors.values())
            str_errors = f"\n{bar}\n".join(errors)
            logging.error(f"\nThe {stream_name} stream has the following schema errors:\n{str_errors}")
    
        if streams_errors:
>           pytest.fail(f"Please check your json_schema in selected streams {tuple(streams_errors.keys())}.")
E           Failed: Please check your json_schema in selected streams ('logs', 'custom_roles', 'permissions', 'resource_sets').

connector_acceptance_test/tests/test_core.py:665: Failed
----------------------------- Captured stdout call -----------------------------
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe logs stream has the following schema errors:\nAdditional properties are not allowed ('device' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'actor': {'properties': {'alternateId': {'type': ['string',\n                                                                      'null']},\n                                             'detailEntry': {'type': ['object',\n                                                                      'null']},\n                                             'displayName': {'type': ['string',\n                                                                      'null']},\n                                             'id': {'type': ['string',\n                                                             'null']},\n                                             'type': {'type': ['string',\n                                                               'null']}},\n                              'type': ['object', 'null']},\n                    'authenticationContext': {'properties': {'authenticationProvider': {'type': ['string',\n                                                                                                 'null']},\n                                                             'authenticationStep': {'type': ['integer']},\n                                                             'credentialProvider': {'type': ['string',\n                                                                                             'null']},\n                                                             'credentialType': {'type': ['string',\n                                                                                         'null']},\n                                                             'externalSessionId': {'type': ['string',\n                                                                                            'null']},\n                                                             'interface': {'type': ['string',\n                                                                                    'null']},\n                                                             'issuer': {'properties': {'id': {'type': ['string',\n                                                                                                       'null']},\n                                                                                       'type': {'type': ['string',\n                                                                                                         'null']}},\n                                                                        'type': ['object',\n                                                                                 'null']}},\n                                              'type': ['object', 'null']},\n                    'client': {'properties': {'device': {'type': ['string',\n                                                                  'null']},\n                                              'geographicalContext': {'properties': {'city': {'type': ['string',\n                                                                                                       'null']},\n                                                                                     'country': {'type': ['string',\n                                                                                                          'null']},\n                                                                                     'geolocation': {'properties': {'lat': {'type': ['number',\n                                                                                                                                     'null']},\n                                                                                                                    'lon': {'type': ['number',\n                                                                                                                                     'null']}},\n                                                                                                     'type': ['object',\n                                                                                                              'null']},\n                                                                                     'postalCode': {'type': ['string',\n                                                                                                             'null']},\n                                                                                     'state': {'type': ['string',\n                                                                                                        'null']}},\n                                                                      'type': ['object',\n                                                                               'null']},\n                                              'id': {'type': ['string',\n                                                              'null']},\n                                              'ipAddress': {'type': ['string',\n                                                                     'null']},\n                                              'userAgent': {'properties': {'browser': {'type': ['string',\n                                                                                                'null']},\n                                                                           'os': {'type': ['string',\n                                                                                           'null']},\n                                                                           'rawUserAgent': {'type': ['string',\n                                                                                                     'null']}},\n                                                            'type': ['object',\n                                                                     'null']},\n                                              'zone': {'type': ['string',\n                                                                'null']}},\n                               'type': ['object', 'null']},\n                    'debugContext': {'properties': {'debugData': {'type': ['object',\n                                                                           'null']}},\n                                     'type': ['object', 'null']},\n                    'displayMessage': {'type': ['string', 'null']},\n                    'eventType': {'type': ['string', 'null']},\n                    'legacyEventType': {'type': ['string', 'null']},\n                    'outcome': {'properties': {'reason': {'type': ['string',\n                                                                   'null']},\n                                               'result': {'type': ['string',\n                                                                   'null']}},\n                                'type': ['object', 'null']},\n                    'published': {'format': 'date-time',\n                                  'type': ['string', 'null']},\n                    'request': {'properties': {'ipChain': {'items': {'properties': {'geographicalContext': {'properties': {'city': {'type': ['string',\n                                                                                                                                             'null']},\n                                                                                                                           'country': {'type': ['string',\n                                                                                                                                                'null']},\n                                                                                                                           'geolocation': {'properties': {'lat': {'type': ['number',\n                                                                                                                                                                           'null']},\n                                                                                                                                                          'lon': {'type': ['number',\n                                                                                                                                                                           'null']}},\n                                                                                                                                           'type': ['object',\n                                                                                                                                                    'null']},\n                                                                                                                           'postalCode': {'type': ['string',\n                                                                                                                                                   'null']},\n                                                                                                                           'state': {'type': ['string',\n                                                                                                                                              'null']}},\n                                                                                                            'type': ['object',\n                                                                                                                     'null']},\n                                                                                    'ip': {'type': ['string',\n                                                                                                    'null']},\n                                                                                    'source': {'type': ['string',\n                                                                                                        'null']},\n                                                                                    'version': {'type': ['string',\n                                                                                                         'null']}},\n                                                                     'type': ['object',\n                                                                              'null']},\n                                                           'type': ['array',\n                                                                    'null']}},\n                                'type': ['object', 'null']},\n                    'securityContext': {'properties': {'asNumber': {'type': ['integer',\n                                                                             'null']},\n                                                       'asOrg': {'type': ['string',\n                                                                          'null']},\n                                                       'domain': {'type': ['string',\n                                                                           'null']},\n                                                       'isProxy': {'type': ['boolean',\n                                                                            'null']},\n                                                       'isp': {'type': ['string',\n                                                                        'null']}},\n                                        'type': ['object', 'null']},\n                    'severity': {'type': ['string', 'null']},\n                    'target': {'items': {'properties': {'alternateId': {'type': ['string',\n                                                                                 'null']},\n                                                        'detailEntry': {'type': ['object',\n                                                                                 'null']},\n                                                        'displayName': {'type': ['string',\n                                                                                 'null']},\n                                                        'id': {'type': ['string',\n                                                                        'null']},\n                                                        'type': {'type': ['string',\n                                                                          'null']}},\n                                         'type': ['object', 'null']},\n                               'type': ['array', 'null']},\n                    'transaction': {'properties': {'detail': {'type': ['object',\n                                                                       'null']},\n                                                   'id': {'type': ['string',\n                                                                   'null']},\n                                                   'type': {'type': ['string',\n                                                                     'null']}},\n                                    'type': ['object', 'null']},\n                    'uuid': {'type': ['string', 'null']},\n                    'version': {'type': ['string', 'null']}},\n     'type': ['object', 'null']}\n\nOn instance:\n    {'actor': {'alternateId': 'integration-test+2@airbyte.io',\n               'detailEntry': None,\n               'displayName': 'Shrif Nada',\n               'id': '00umj7d1bEH95JjIE5d6',\n               'type': 'User'},\n     'authenticationContext': {'authenticationProvider': None,\n                               'authenticationStep': 0,\n                               'credentialProvider': None,\n                               'credentialType': None,\n                               'externalSessionId': 'trsciUxuHuKSLSSDd44VIfE8w',\n                               'interface': None,\n                               'issuer': None},\n     'client': {'device': 'Unknown',\n                'geographicalContext': None,\n                'id': None,\n                'ipAddress': '68.112.186.247',\n                'userAgent': {'browser': 'UNKNOWN',\n                              'os': 'Unknown',\n                              'rawUserAgent': 'python-requests/2.28.2'},\n                'zone': 'null'},\n     'debugContext': {'debugData': {'dtHash': '0f0e2e69854cc46c5a8789cd9e7379bf4e20cbb629a52401a82c33c3d2ca17da',\n                                    'operationRateLimitScopeType': 'token',\n                                    'operationRateLimitSecondsToReset': '45',\n                                    'operationRateLimitSubtype': 'ssws_token',\n                                    'operationRateLimitThreshold': '10',\n                                    'operationRateLimitTimeSpan': '1',\n                                    'operationRateLimitTimeUnit': 'MINUTES',\n                                    'operationRateLimitType': 'web_request',\n                                    'requestId': 'ZBjFrTtFUOUuCEhEIL_GcwAAALM',\n                                    'requestUri': '/api/v1/logs',\n                                    'url': '/api/v1/logs?limit=200&since=2021-03-21T20%3A49%3A13%2B00%3A00'}},\n     'device': None,\n     'displayMessage': 'This API token has made too many requests',\n     'eventType': 'system.operation.rate_limit.violation',\n     'legacyEventType': None,\n     'outcome': None,\n     'published': '2023-03-20T20:44:29Z',\n     'request': {'ipChain': [{'geographicalContext': None,\n                              'ip': '68.112.186.247',\n                              'source': None,\n                              'version': 'V4'}]},\n     'securityContext': {'asNumber': None,\n                         'asOrg': None,\n                         'domain': None,\n                         'isProxy': None,\n                         'isp': None},\n     'severity': 'WARN',\n     'target': [{'alternateId': None,\n                 'detailEntry': None,\n                 'displayName': None,\n                 'id': 'b192d91c-b242-36da-9332-d97a5579f865',\n                 'type': 'Bucket UUID'},\n                {'alternateId': 'unknown',\n                 'detailEntry': None,\n                 'displayName': 'integration_tests',\n                 'id': '00Ttxw230cHHhID0S5d6',\n                 'type': 'Token'}],\n     'transaction': {'detail': {'requestApiTokenId': '00Ttxw230cHHhID0S5d6'},\n                     'id': 'ZBjFrTtFUOUuCEhEIL_GcwAAALM',\n                     'type': 'WEB'},\n     'uuid': '02a7c332-c760-11ed-b73a-ff1e791459ee',\n     'version': '0'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe custom_roles stream has the following schema errors:\nAdditional properties are not allowed ('description' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'description': 'Gets a paginated list of Custom Roles',\n     'properties': {'_links': {'properties': {'assignee': {'additionalProperties': True,\n                                                           'properties': {'permissions': {'additionalProperties': True,\n                                                                                          'properties': {'href': {'type': ['null',\n                                                                                                                           'string']}},\n                                                                                          'type': ['null',\n                                                                                                   'object']},\n                                                                          'self': {'additionalProperties': True,\n                                                                                   'properties': {'href': {'type': ['null',\n                                                                                                                    'string']}},\n                                                                                   'type': ['null',\n                                                                                            'object']}},\n                                                           'type': ['null',\n                                                                    'object']}},\n                               'type': ['null', 'object']},\n                    'created': {'format': 'date-time',\n                                'type': ['null', 'string']},\n                    'id': {'type': ['null', 'string']},\n                    'label': {'type': ['null', 'string']},\n                    'lastUpdated': {'format': 'date-time',\n                                    'type': ['null', 'string']}},\n     'type': ['null', 'object']}\n\nOn instance:\n    {'_links': {'permissions': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7/permissions'},\n                'self': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7'}},\n     'created': '2022-07-13T07:54:31.000Z',\n     'description': 'custom role for test',\n     'id': 'cr05rkz69f72I0GyP5d7',\n     'label': 'custom role for test',\n     'lastUpdated': '2022-07-13T07:54:31.000Z'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe permissions stream has the following schema errors:\nAdditional properties are not allowed ('conditions' was unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'description': 'Gets the list of permissions included in a Custom '\n                    'Role identified by its id',\n     'properties': {'_links': {'properties': {'assignee': {'properties': {'role': {'additionalProperties': True,\n                                                                                   'properties': {'href': {'type': ['null',\n                                                                                                                    'string']}},\n                                                                                   'type': ['null',\n                                                                                            'object']},\n                                                                          'self': {'additionalProperties': True,\n                                                                                   'properties': {'href': {'type': ['null',\n                                                                                                                    'string']}},\n                                                                                   'type': ['null',\n                                                                                            'object']}}}},\n                               'type': ['object', 'null']},\n                    'created': {'format': 'date-time', 'type': 'string'},\n                    'label': {'description': 'Type of permissions',\n                              'enum': ['okta.users.manage',\n                                       'okta.users.create',\n                                       'okta.users.read',\n                                       'okta.users.credentials.manage',\n                                       'okta.users.credentials.resetFactors',\n                                       'okta.users.credentials.resetPassword',\n                                       'okta.users.credentials.expirePassword',\n                                       'okta.users.userprofile.manage',\n                                       'okta.users.lifecycle.manage',\n                                       'okta.users.lifecycle.activate',\n                                       'okta.users.lifecycle.deactivate',\n                                       'okta.users.lifecycle.suspend',\n                                       'okta.users.lifecycle.unsuspend',\n                                       'okta.users.lifecycle.delete',\n                                       'okta.users.lifecycle.unlock',\n                                       'okta.users.lifecycle.clearSessions',\n                                       'okta.users.groupMembership.manage',\n                                       'okta.users.appAssignment.manage',\n                                       'okta.groups.manage',\n                                       'okta.groups.create',\n                                       'okta.groups.members.manage',\n                                       'okta.groups.read',\n                                       'okta.groups.appAssignment.manage',\n                                       'okta.apps.read',\n                                       'okta.apps.manage',\n                                       'okta.apps.assignment.manage',\n                                       'okta.profilesources.import.run',\n                                       'okta.authzServers.read',\n                                       'okta.authzServers.manage',\n                                       'okta.customizations.read',\n                                       'okta.customizations.manage',\n                                       'okta.workflows.invoke'],\n                              'type': 'string'},\n                    'lastUpdated': {'format': 'date-time',\n                                    'type': 'string'}},\n     'type': 'object'}\n\nOn instance:\n    {'_links': {'role': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7'},\n                'self': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7/permissions/okta.users.lifecycle.suspend'}},\n     'conditions': None,\n     'created': '2022-07-13T07:54:31.000Z',\n     'label': 'okta.users.lifecycle.suspend',\n     'lastUpdated': '2022-07-13T07:54:31.000Z'}"}}
{"type": "LOG", "log": {"level": "ERROR", "message": "\nThe resource_sets stream has the following schema errors:\nAdditional properties are not allowed ('lastUpdated', 'created' were unexpected)\n\nFailed validating 'additionalProperties' in schema:\n    {'additionalProperties': False,\n     'properties': {'_links': {'properties': {'assignee': {'properties': {'bindings': {'additionalProperties': True,\n                                                                                       'description': 'gets '\n                                                                                                      'a '\n                                                                                                      'paginable '\n                                                                                                      'list '\n                                                                                                      'of '\n                                                                                                      'admin '\n                                                                                                      'Role '\n                                                                                                      'Bindings '\n                                                                                                      'assigned '\n                                                                                                      'to '\n                                                                                                      'this '\n                                                                                                      'set',\n                                                                                       'properties': {'href': {'type': ['null',\n                                                                                                                        'string']}},\n                                                                                       'type': ['null',\n                                                                                                'object']},\n                                                                          'next': {'additionalProperties': True,\n                                                                                   'description': 'the '\n                                                                                                  'link '\n                                                                                                  'for '\n                                                                                                  'the '\n                                                                                                  'next '\n                                                                                                  'page, '\n                                                                                                  \"'after' \"\n                                                                                                  'is '\n                                                                                                  'the '\n                                                                                                  'query '\n                                                                                                  'string, '\n                                                                                                  'the '\n                                                                                                  'cursor '\n                                                                                                  'field '\n                                                                                                  'is '\n                                                                                                  'id',\n                                                                                   'properties': {'href': {'type': ['null',\n                                                                                                                    'string']}},\n                                                                                   'type': ['null',\n                                                                                            'object']},\n                                                                          'resources': {'additionalProperties': True,\n                                                                                        'description': 'gets '\n                                                                                                       'a '\n                                                                                                       'paginable '\n                                                                                                       'list '\n                                                                                                       'of '\n                                                                                                       'resources '\n                                                                                                       'included '\n                                                                                                       'in '\n                                                                                                       'this '\n                                                                                                       'set',\n                                                                                        'properties': {'href': {'type': ['null',\n                                                                                                                         'string']}},\n                                                                                        'type': ['null',\n                                                                                                 'object']},\n                                                                          'self': {'additionalProperties': True,\n                                                                                   'description': 'gets '\n                                                                                                  'this '\n                                                                                                  'Resource '\n                                                                                                  'Set',\n                                                                                   'properties': {'href': {'type': ['null',\n                                                                                                                    'string']}},\n                                                                                   'type': ['null',\n                                                                                            'object']}}}},\n                               'type': ['object', 'null']},\n                    'description': {'type': 'string'},\n                    'id': {'type': 'string'},\n                    'label': {'type': 'string'}},\n     'type': 'object'}\n\nOn instance:\n    {'_links': {'bindings': {'href': 'https://dev-01177082.okta.com/api/v1/iam/resource-sets/iam64yqn54IMhp6ng5d7/bindings'},\n                'resources': {'href': 'https://dev-01177082.okta.com/api/v1/iam/resource-sets/iam64yqn54IMhp6ng5d7/resources'},\n                'self': {'href': 'https://dev-01177082.okta.com/api/v1/iam/resource-sets/iam64yqn54IMhp6ng5d7'}},\n     'created': '2022-08-11T16:08:47.000Z',\n     'description': 'test resource set',\n     'id': 'iam64yqn54IMhp6ng5d7',\n     'label': 'test resource set',\n     'lastUpdated': '2022-08-11T16:08:47.000Z'}"}}
------------------------------ Captured log call -------------------------------
ERROR    root:test_core.py:662 
The logs stream has the following schema errors:
Additional properties are not allowed ('device' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'actor': {'properties': {'alternateId': {'type': ['string',
                                                                      'null']},
                                             'detailEntry': {'type': ['object',
                                                                      'null']},
                                             'displayName': {'type': ['string',
                                                                      'null']},
                                             'id': {'type': ['string',
                                                             'null']},
                                             'type': {'type': ['string',
                                                               'null']}},
                              'type': ['object', 'null']},
                    'authenticationContext': {'properties': {'authenticationProvider': {'type': ['string',
                                                                                                 'null']},
                                                             'authenticationStep': {'type': ['integer']},
                                                             'credentialProvider': {'type': ['string',
                                                                                             'null']},
                                                             'credentialType': {'type': ['string',
                                                                                         'null']},
                                                             'externalSessionId': {'type': ['string',
                                                                                            'null']},
                                                             'interface': {'type': ['string',
                                                                                    'null']},
                                                             'issuer': {'properties': {'id': {'type': ['string',
                                                                                                       'null']},
                                                                                       'type': {'type': ['string',
                                                                                                         'null']}},
                                                                        'type': ['object',
                                                                                 'null']}},
                                              'type': ['object', 'null']},
                    'client': {'properties': {'device': {'type': ['string',
                                                                  'null']},
                                              'geographicalContext': {'properties': {'city': {'type': ['string',
                                                                                                       'null']},
                                                                                     'country': {'type': ['string',
                                                                                                          'null']},
                                                                                     'geolocation': {'properties': {'lat': {'type': ['number',
                                                                                                                                     'null']},
                                                                                                                    'lon': {'type': ['number',
                                                                                                                                     'null']}},
                                                                                                     'type': ['object',
                                                                                                              'null']},
                                                                                     'postalCode': {'type': ['string',
                                                                                                             'null']},
                                                                                     'state': {'type': ['string',
                                                                                                        'null']}},
                                                                      'type': ['object',
                                                                               'null']},
                                              'id': {'type': ['string',
                                                              'null']},
                                              'ipAddress': {'type': ['string',
                                                                     'null']},
                                              'userAgent': {'properties': {'browser': {'type': ['string',
                                                                                                'null']},
                                                                           'os': {'type': ['string',
                                                                                           'null']},
                                                                           'rawUserAgent': {'type': ['string',
                                                                                                     'null']}},
                                                            'type': ['object',
                                                                     'null']},
                                              'zone': {'type': ['string',
                                                                'null']}},
                               'type': ['object', 'null']},
                    'debugContext': {'properties': {'debugData': {'type': ['object',
                                                                           'null']}},
                                     'type': ['object', 'null']},
                    'displayMessage': {'type': ['string', 'null']},
                    'eventType': {'type': ['string', 'null']},
                    'legacyEventType': {'type': ['string', 'null']},
                    'outcome': {'properties': {'reason': {'type': ['string',
                                                                   'null']},
                                               'result': {'type': ['string',
                                                                   'null']}},
                                'type': ['object', 'null']},
                    'published': {'format': 'date-time',
                                  'type': ['string', 'null']},
                    'request': {'properties': {'ipChain': {'items': {'properties': {'geographicalContext': {'properties': {'city': {'type': ['string',
                                                                                                                                             'null']},
                                                                                                                           'country': {'type': ['string',
                                                                                                                                                'null']},
                                                                                                                           'geolocation': {'properties': {'lat': {'type': ['number',
                                                                                                                                                                           'null']},
                                                                                                                                                          'lon': {'type': ['number',
                                                                                                                                                                           'null']}},
                                                                                                                                           'type': ['object',
                                                                                                                                                    'null']},
                                                                                                                           'postalCode': {'type': ['string',
                                                                                                                                                   'null']},
                                                                                                                           'state': {'type': ['string',
                                                                                                                                              'null']}},
                                                                                                            'type': ['object',
                                                                                                                     'null']},
                                                                                    'ip': {'type': ['string',
                                                                                                    'null']},
                                                                                    'source': {'type': ['string',
                                                                                                        'null']},
                                                                                    'version': {'type': ['string',
                                                                                                         'null']}},
                                                                     'type': ['object',
                                                                              'null']},
                                                           'type': ['array',
                                                                    'null']}},
                                'type': ['object', 'null']},
                    'securityContext': {'properties': {'asNumber': {'type': ['integer',
                                                                             'null']},
                                                       'asOrg': {'type': ['string',
                                                                          'null']},
                                                       'domain': {'type': ['string',
                                                                           'null']},
                                                       'isProxy': {'type': ['boolean',
                                                                            'null']},
                                                       'isp': {'type': ['string',
                                                                        'null']}},
                                        'type': ['object', 'null']},
                    'severity': {'type': ['string', 'null']},
                    'target': {'items': {'properties': {'alternateId': {'type': ['string',
                                                                                 'null']},
                                                        'detailEntry': {'type': ['object',
                                                                                 'null']},
                                                        'displayName': {'type': ['string',
                                                                                 'null']},
                                                        'id': {'type': ['string',
                                                                        'null']},
                                                        'type': {'type': ['string',
                                                                          'null']}},
                                         'type': ['object', 'null']},
                               'type': ['array', 'null']},
                    'transaction': {'properties': {'detail': {'type': ['object',
                                                                       'null']},
                                                   'id': {'type': ['string',
                                                                   'null']},
                                                   'type': {'type': ['string',
                                                                     'null']}},
                                    'type': ['object', 'null']},
                    'uuid': {'type': ['string', 'null']},
                    'version': {'type': ['string', 'null']}},
     'type': ['object', 'null']}

On instance:
    {'actor': {'alternateId': 'integration-test+2@airbyte.io',
               'detailEntry': None,
               'displayName': 'Shrif Nada',
               'id': '00umj7d1bEH95JjIE5d6',
               'type': 'User'},
     'authenticationContext': {'authenticationProvider': None,
                               'authenticationStep': 0,
                               'credentialProvider': None,
                               'credentialType': None,
                               'externalSessionId': 'trsciUxuHuKSLSSDd44VIfE8w',
                               'interface': None,
                               'issuer': None},
     'client': {'device': 'Unknown',
                'geographicalContext': None,
                'id': None,
                'ipAddress': '68.112.186.247',
                'userAgent': {'browser': 'UNKNOWN',
                              'os': 'Unknown',
                              'rawUserAgent': 'python-requests/2.28.2'},
                'zone': 'null'},
     'debugContext': {'debugData': {'dtHash': '0f0e2e69854cc46c5a8789cd9e7379bf4e20cbb629a52401a82c33c3d2ca17da',
                                    'operationRateLimitScopeType': 'token',
                                    'operationRateLimitSecondsToReset': '45',
                                    'operationRateLimitSubtype': 'ssws_token',
                                    'operationRateLimitThreshold': '10',
                                    'operationRateLimitTimeSpan': '1',
                                    'operationRateLimitTimeUnit': 'MINUTES',
                                    'operationRateLimitType': 'web_request',
                                    'requestId': 'ZBjFrTtFUOUuCEhEIL_GcwAAALM',
                                    'requestUri': '/api/v1/logs',
                                    'url': '/api/v1/logs?limit=200&since=2021-03-21T20%3A49%3A13%2B00%3A00'}},
     'device': None,
     'displayMessage': 'This API token has made too many requests',
     'eventType': 'system.operation.rate_limit.violation',
     'legacyEventType': None,
     'outcome': None,
     'published': '2023-03-20T20:44:29Z',
     'request': {'ipChain': [{'geographicalContext': None,
                              'ip': '68.112.186.247',
                              'source': None,
                              'version': 'V4'}]},
     'securityContext': {'asNumber': None,
                         'asOrg': None,
                         'domain': None,
                         'isProxy': None,
                         'isp': None},
     'severity': 'WARN',
     'target': [{'alternateId': None,
                 'detailEntry': None,
                 'displayName': None,
                 'id': 'b192d91c-b242-36da-9332-d97a5579f865',
                 'type': 'Bucket UUID'},
                {'alternateId': 'unknown',
                 'detailEntry': None,
                 'displayName': 'integration_tests',
                 'id': '00Ttxw230cHHhID0S5d6',
                 'type': 'Token'}],
     'transaction': {'detail': {'requestApiTokenId': '00Ttxw230cHHhID0S5d6'},
                     'id': 'ZBjFrTtFUOUuCEhEIL_GcwAAALM',
                     'type': 'WEB'},
     'uuid': '02a7c332-c760-11ed-b73a-ff1e791459ee',
     'version': '0'}
ERROR    root:test_core.py:662 
The custom_roles stream has the following schema errors:
Additional properties are not allowed ('description' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'description': 'Gets a paginated list of Custom Roles',
     'properties': {'_links': {'properties': {'assignee': {'additionalProperties': True,
                                                           'properties': {'permissions': {'additionalProperties': True,
                                                                                          'properties': {'href': {'type': ['null',
                                                                                                                           'string']}},
                                                                                          'type': ['null',
                                                                                                   'object']},
                                                                          'self': {'additionalProperties': True,
                                                                                   'properties': {'href': {'type': ['null',
                                                                                                                    'string']}},
                                                                                   'type': ['null',
                                                                                            'object']}},
                                                           'type': ['null',
                                                                    'object']}},
                               'type': ['null', 'object']},
                    'created': {'format': 'date-time',
                                'type': ['null', 'string']},
                    'id': {'type': ['null', 'string']},
                    'label': {'type': ['null', 'string']},
                    'lastUpdated': {'format': 'date-time',
                                    'type': ['null', 'string']}},
     'type': ['null', 'object']}

On instance:
    {'_links': {'permissions': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7/permissions'},
                'self': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7'}},
     'created': '2022-07-13T07:54:31.000Z',
     'description': 'custom role for test',
     'id': 'cr05rkz69f72I0GyP5d7',
     'label': 'custom role for test',
     'lastUpdated': '2022-07-13T07:54:31.000Z'}
ERROR    root:test_core.py:662 
The permissions stream has the following schema errors:
Additional properties are not allowed ('conditions' was unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'description': 'Gets the list of permissions included in a Custom '
                    'Role identified by its id',
     'properties': {'_links': {'properties': {'assignee': {'properties': {'role': {'additionalProperties': True,
                                                                                   'properties': {'href': {'type': ['null',
                                                                                                                    'string']}},
                                                                                   'type': ['null',
                                                                                            'object']},
                                                                          'self': {'additionalProperties': True,
                                                                                   'properties': {'href': {'type': ['null',
                                                                                                                    'string']}},
                                                                                   'type': ['null',
                                                                                            'object']}}}},
                               'type': ['object', 'null']},
                    'created': {'format': 'date-time', 'type': 'string'},
                    'label': {'description': 'Type of permissions',
                              'enum': ['okta.users.manage',
                                       'okta.users.create',
                                       'okta.users.read',
                                       'okta.users.credentials.manage',
                                       'okta.users.credentials.resetFactors',
                                       'okta.users.credentials.resetPassword',
                                       'okta.users.credentials.expirePassword',
                                       'okta.users.userprofile.manage',
                                       'okta.users.lifecycle.manage',
                                       'okta.users.lifecycle.activate',
                                       'okta.users.lifecycle.deactivate',
                                       'okta.users.lifecycle.suspend',
                                       'okta.users.lifecycle.unsuspend',
                                       'okta.users.lifecycle.delete',
                                       'okta.users.lifecycle.unlock',
                                       'okta.users.lifecycle.clearSessions',
                                       'okta.users.groupMembership.manage',
                                       'okta.users.appAssignment.manage',
                                       'okta.groups.manage',
                                       'okta.groups.create',
                                       'okta.groups.members.manage',
                                       'okta.groups.read',
                                       'okta.groups.appAssignment.manage',
                                       'okta.apps.read',
                                       'okta.apps.manage',
                                       'okta.apps.assignment.manage',
                                       'okta.profilesources.import.run',
                                       'okta.authzServers.read',
                                       'okta.authzServers.manage',
                                       'okta.customizations.read',
                                       'okta.customizations.manage',
                                       'okta.workflows.invoke'],
                              'type': 'string'},
                    'lastUpdated': {'format': 'date-time',
                                    'type': 'string'}},
     'type': 'object'}

On instance:
    {'_links': {'role': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7'},
                'self': {'href': 'https://dev-01177082-admin.okta.com/api/v1/iam/roles/cr05rkz69f72I0GyP5d7/permissions/okta.users.lifecycle.suspend'}},
     'conditions': None,
     'created': '2022-07-13T07:54:31.000Z',
     'label': 'okta.users.lifecycle.suspend',
     'lastUpdated': '2022-07-13T07:54:31.000Z'}
ERROR    root:test_core.py:662 
The resource_sets stream has the following schema errors:
Additional properties are not allowed ('lastUpdated', 'created' were unexpected)

Failed validating 'additionalProperties' in schema:
    {'additionalProperties': False,
     'properties': {'_links': {'properties': {'assignee': {'properties': {'bindings': {'additionalProperties': True,
                                                                                       'description': 'gets '
                                                                                                      'a '
                                                                                                      'paginable '
                                                                                                      'list '
                                                                                                      'of '
                                                                                                      'admin '
                                                                                                      'Role '
                                                                                                      'Bindings '
                                                                                                      'assigned '
                                                                                                      'to '
                                                                                                      'this '
                                                                                                      'set',
                                                                                       'properties': {'href': {'type': ['null',
                                                                                                                        'string']}},
                                                                                       'type': ['null',
                                                                                                'object']},
                                                                          'next': {'additionalProperties': True,
                                                                                   'description': 'the '
                                                                                                  'link '
                                                                                                  'for '
                                                                                                  'the '
                                                                                                  'next '
                                                                                                  'page, '
                                                                                                  "'after' "
                                                                                                  'is '
                                                                                                  'the '
                                                                                                  'query '
                                                                                                  'string, '
                                                                                                  'the '
                                                                                                  'cursor '
                                                                                                  'field '
                                                                                                  'is '
                                                                                                  'id',
                                                                                   'properties': {'href': {'type': ['null',
                                                                                                                    'string']}},
                                                                                   'type': ['null',
                                                                                            'object']},
                                                                          'resources': {'additionalProperties': True,
                                                                                        'description': 'gets '
                                                                                                       'a '
                                                                                                       'paginable '
                                                                                                       'list '
                                                                                                       'of '
                                                                                                       'resources '
                                                                                                       'included '
                                                                                                       'in '
                                                                                                       'this '
                                                                                                       'set',
                                                                                        'properties': {'href': {'type': ['null',
                                                                                                                         'string']}},
                                                                                        'type': ['null',
                                                                                                 'object']},
                                                                          'self': {'additionalProperties': True,
                                                                                   'description': 'gets '
                                                                                                  'this '
                                                                                                  'Resource '
                                                                                                  'Set',
                                                                                   'properties': {'href': {'type': ['null',
                                                                                                                    'string']}},
                                                                                   'type': ['null',
                                                                                            'object']}}}},
                               'type': ['object', 'null']},
                    'description': {'type': 'string'},
                    'id': {'type': 'string'},
                    'label': {'type': 'string'}},
     'type': 'object'}

On instance:
    {'_links': {'bindings': {'href': 'https://dev-01177082.okta.com/api/v1/iam/resource-sets/iam64yqn54IMhp6ng5d7/bindings'},
                'resources': {'href': 'https://dev-01177082.okta.com/api/v1/iam/resource-sets/iam64yqn54IMhp6ng5d7/resources'},
                'self': {'href': 'https://dev-01177082.okta.com/api/v1/iam/resource-sets/iam64yqn54IMhp6ng5d7'}},
     'created': '2022-08-11T16:08:47.000Z',
     'description': 'test resource set',
     'id': 'iam64yqn54IMhp6ng5d7',
     'label': 'test resource set',
     'lastUpdated': '2022-08-11T16:08:47.000Z'}
=========================== short test summary info ============================
FAILED ../../test_input/test_core.py::TestBasicRead::test_read[inputs0] - Fai...
============ 1 failed, 1 passed, 37 deselected in 197.70s (0:03:17) ============
